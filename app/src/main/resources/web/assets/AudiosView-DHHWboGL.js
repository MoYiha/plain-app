import{_ as st}from"./VPagination.vuevuetypescriptsetuptruelang-C9URNuao.js";import{o as n,c as l,a,j as ge,aP as ot,g as ye,a0 as y,C as K,h as B,aQ as nt,d as at,u as lt,s as ue,I as it,i as ct,J as dt,aC as ut,aD as rt,aF as _t,ag as pt,K as re,L as mt,M as ht,m as e,t as g,O as F,x as v,w as p,p as c,e as G,q as _e,N as pe,P as me,v as he,Q as vt,f as gt,aE as yt,aG as kt,aR as ft,al as bt,S as Tt,ay as $t,E as Ct,a9 as wt,aJ as qt,U as It,V as At,W as Et,X as St,F as Bt,G as Dt,ao as Lt,an as Mt,av as zt,aK as Pt,Y as Vt,Z as Rt,$ as Ft,ad as Nt,ap as Qt,a1 as Ut,a2 as xt,a3 as Gt,H as Kt}from"./index-BxNI00MG.js";import{u as Ht,_ as Ot,a as jt,b as Jt}from"./key-events-B5RXeznw.js";import{_ as Wt}from"./sort-rounded-BbQ1dmh_.js";import{_ as Xt}from"./upload-rounded-DLL-9Gf2.js";import{u as Yt}from"./search-D1_YTViL.js";import{a as Zt}from"./tags-BUfgTqH4.js";import"./rss-feed-rounded-Dj4EQ17i.js";import"./vee-validate.esm-9czZ1sUw.js";const es={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ts=a("path",{fill:"currentColor",d:"M10 16q.425 0 .713-.288T11 15V9q0-.425-.288-.712T10 8t-.712.288T9 9v6q0 .425.288.713T10 16m4 0q.425 0 .713-.288T15 15V9q0-.425-.288-.712T14 8t-.712.288T13 9v6q0 .425.288.713T14 16m-2 6q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12t-2.325-5.675T12 4T6.325 6.325T4 12t2.325 5.675T12 20m0-8"},null,-1),ss=[ts];function os(r,m){return n(),l("svg",es,[...ss])}const ns={name:"material-symbols-pause-circle-outline-rounded",render:os},as={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ls=a("path",{fill:"currentColor",d:"M12.5 15q1.05 0 1.775-.725T15 12.5V7h2q.425 0 .713-.288T18 6t-.288-.712T17 5h-2q-.425 0-.712.288T14 6v4.5q-.325-.25-.7-.375T12.5 10q-1.05 0-1.775.725T10 12.5t.725 1.775T12.5 15M8 18q-.825 0-1.412-.587T6 16V4q0-.825.588-1.412T8 2h12q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm0-2h12V4H8zm-4 6q-.825 0-1.412-.587T2 20V7q0-.425.288-.712T3 6t.713.288T4 7v13h13q.425 0 .713.288T18 21t-.288.713T17 22zM8 4v12z"},null,-1),is=[ls];function cs(r,m){return n(),l("svg",as,[...is])}const ds={name:"material-symbols-library-music-outline-rounded",render:cs},us={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},rs=a("path",{fill:"currentColor",d:"M3 16v-2h7v2zm0-4v-2h11v2zm0-4V6h11v2zm13 12v-4h-4v-2h4v-4h2v4h4v2h-4v4z"},null,-1),_s=[rs];function ps(r,m){return n(),l("svg",us,[..._s])}const ms={name:"material-symbols-playlist-add",render:ps};function ve(r,m,f=500){const i=r.cloneNode(!0),d=r.getBoundingClientRect(),D=m.getBoundingClientRect();i.style.position="absolute",i.style.top=d.top+"px",i.style.left=d.left+"px",i.style.opacity=1,document.body.appendChild(i);let b=0;function T(C){b||(b=C);const E=C-b,q=Math.min(E/f,1);i.style.top=d.top+(D.top-d.top)*q+"px",i.style.left=d.left+(D.left-d.left)*q+"px",q<1?requestAnimationFrame(T):document.body.removeChild(i)}requestAnimationFrame(T)}const hs=(r,m)=>{const{mutate:f,loading:i,onDone:d}=ge({document:ot,appApi:!0}),{t:D}=ye();return d(()=>{y.emit("refetch_app"),m()}),{loading:i,addItemsToPlaylist:(b,T,C,E)=>{let q=E;if(!C){if(T.length===0){K(D("select_first"),"error");return}q=`ids:${T.join(",")}`}const _=b.target,V=document.getElementById("quick-audio");ve(_,V),f({query:q})},addToPlaylist:(b,T)=>{const C=b.target,E=document.getElementById("quick-audio");ve(C,E),f({query:`ids:${T.id}`})}}},vs=()=>{const r=B(""),{mutate:m,loading:f,onDone:i}=ge({document:nt,appApi:!0});return i(()=>{y.emit("play_audio")}),{loading:f,playPath:r,play:d=>{r.value=d.path,m({path:d.path})},pause:()=>{y.emit("pause_audio")}}},k=r=>(Bt("data-v-8c30045d"),r=r(),Dt(),r),gs={class:"top-app-bar"},ys=["checked","indeterminate"],ks={class:"title"},fs={key:0},bs={key:1},Ts=k(()=>a("md-ripple",null,null,-1)),$s=k(()=>a("md-ripple",null,null,-1)),Cs=k(()=>a("md-ripple",null,null,-1)),ws=k(()=>a("md-ripple",null,null,-1)),qs={class:"actions"},Is=k(()=>a("md-ripple",null,null,-1)),As={class:"btn-icon btn-sort"},Es=k(()=>a("md-ripple",null,null,-1)),Ss={class:"menu-items"},Bs=["onClick","selected"],Ds={slot:"headline"},Ls={class:"scroll-content"},Ms=["onClick","onMouseover"],zs={class:"start"},Ps=["onClick","checked"],Vs=["onClick","checked"],Rs={class:"number"},Fs=["src","onError"],Ns={class:"title"},Qs={class:"subtitle"},Us={class:"duration"},xs=["onClick"],Gs={class:"actions"},Ks=["onClick"],Hs=k(()=>a("md-ripple",null,null,-1)),Os=["onClick"],js=k(()=>a("md-ripple",null,null,-1)),Js=["onClick"],Ws=k(()=>a("md-ripple",null,null,-1)),Xs=["onClick"],Ys=k(()=>a("md-ripple",null,null,-1)),Zs={key:0,indeterminate:"",class:"spinner-sm"},eo=k(()=>a("md-ripple",null,null,-1)),to={class:"artist"},so={class:"time"},oo={key:1,class:"no-data-placeholder"},z=50,no=at({__name:"AudiosView",setup(r){var le;const m=lt(),{audioSortBy:f}=ue(m),i=B([]),{t:d}=ye(),{parseQ:D}=Yt(),b=it({tagIds:[]}),{app:T,urlTokenKey:C,audioPlaying:E}=ue(ct()),q=t=>{var o;return E.value&&((o=T.value)==null?void 0:o.audioCurrent)===t.path},_=dt.AUDIO,V=vt(),H=V.query,N=B(parseInt(((le=H.page)==null?void 0:le.toString())??"1")),P=B([]),Q=B([]),ke=ut(()=>{const t={};return Q.value.forEach(o=>{t[o.id]=o}),t}),I=B(""),{addToTags:fe}=Zt(_,P),{deleteItems:O,deleteItem:be}=rt(),{view:Te}=_t(_),{selectedIds:w,allChecked:j,realAllChecked:S,selectRealAll:$e,allCheckedAlertVisible:Ce,clearSelection:L,toggleAllChecked:J,toggleSelect:W,total:A,checked:U,shiftEffectingIds:X,handleItemClick:we,handleMouseOver:qe,selectAll:Ie,shouldSelect:Ae}=Ht(i),{downloadItems:Ee}=pt(C,_,L,"audios.zip"),{downloadFile:Se}=Lt(C),Y=t=>{const o=V.query.q;gt(m,o?`/audios?page=${t}&q=${o}`:`/audios?page=${t}`)},{keyDown:Z,keyUp:ee}=Jt(A,z,N,Ie,L,Y,()=>{O(_,w.value,S.value,I.value)}),{addItemsToPlaylist:Be,addToPlaylist:De}=hs(i,L),Le=Mt(),te=B([]),Me=yt(),{play:ze,playPath:Pe,loading:Ve,pause:Re}=vs(),{fetch:Fe}=re({handle:async(t,o)=>{o?K(d(o),"error"):t&&(P.value=t.tags,Q.value=t.mediaBuckets)},document:kt,variables:{type:_},appApi:!0}),Ne=t=>{te.value.push(t)},{loading:Qe,fetch:R}=re({handle:(t,o)=>{o?K(d(o),"error"):t&&(i.value=t.items,A.value=t.total)},document:ft,variables:()=>({offset:(N.value-1)*z,limit:z,query:I.value,sortBy:f.value}),appApi:!0});function Ue(t){return t?`/audios?q=${t}`:"/audios"}function xe(){Me.push("/files"),zt(Pt,{message:d("upload_audios")})}function Ge(t,o){f.value=o,t.close()}const se=t=>{t.type===_&&(L(),R())},oe=t=>{t.type===_&&R()},ne=t=>{t.type===_&&(L(),R())},ae=()=>{A.value--};function Ke(t){const o=t.tags.map(M=>M.id);Vt(Rt,{type:_,tags:P.value,item:{key:t.id,title:t.title,size:t.size},selected:P.value.filter(M=>o.includes(M.id))})}return mt(()=>{var t;I.value=Ft(((t=H.q)==null?void 0:t.toString())??""),D(b,I.value),Fe(),R(),y.on("item_tags_updated",oe),y.on("items_tags_updated",se),y.on("media_item_deleted",ae),y.on("media_items_deleted",ne),window.addEventListener("keydown",Z),window.addEventListener("keyup",ee)}),ht(()=>{y.off("item_tags_updated",oe),y.off("items_tags_updated",se),y.off("media_item_deleted",ae),y.off("media_items_deleted",ne),window.removeEventListener("keydown",Z),window.removeEventListener("keyup",ee)}),(t,o)=>{const M=Nt,ie=Qt,ce=ms,de=Ut,He=Ot,Oe=Xt,je=Wt,Je=bt,We=jt,Xe=xt,Ye=ds,Ze=Gt,et=ns,tt=st,h=Tt("tooltip");return n(),l(F,null,[a("div",gs,[a("md-checkbox",{"touch-target":"wrapper",onChange:o[0]||(o[0]=(...s)=>e(J)&&e(J)(...s)),checked:e(j),indeterminate:!e(j)&&e(U)},null,40,ys),a("div",ks,[e(w).length?(n(),l("span",fs,g(t.$t("x_selected",{count:e(S)?e(A).toLocaleString():e(w).length.toLocaleString()})),1)):(n(),l("span",bs,g(t.$t("page_title.audios"))+" ("+g(e(A).toLocaleString())+")",1)),e(U)?(n(),l(F,{key:2},[v((n(),l("button",{class:"btn-icon",onClick:o[1]||(o[1]=p(s=>e(O)(e(_),e(w),e(S),I.value),["stop"]))},[Ts,c(M)])),[[h,t.$t("delete")]]),v((n(),l("button",{class:"btn-icon",onClick:o[2]||(o[2]=p(s=>e(Ee)(e(S),e(w),I.value),["stop"]))},[$s,c(ie)])),[[h,t.$t("download")]]),v((n(),l("button",{class:"btn-icon",onClick:o[3]||(o[3]=p(s=>e(Be)(s,e(w),e(S),I.value),["stop"]))},[Cs,c(ce)])),[[h,t.$t("add_to_playlist")]]),v((n(),l("button",{class:"btn-icon",onClick:o[4]||(o[4]=p(s=>e(fe)(e(w),e(S),I.value),["stop"]))},[ws,c(de)])),[[h,t.$t("add_to_tags")]])],64)):G("",!0)]),a("div",qs,[c(He,{filter:b,tags:P.value,buckets:Q.value,"get-url":Ue},null,8,["filter","tags","buckets"]),v((n(),l("button",{class:"btn-icon",onClick:p(xe,["stop"])},[Is,c(Oe)])),[[h,t.$t("upload")]]),c(Je,null,{content:_e(s=>[a("div",Ss,[(n(!0),l(F,null,me(e(Le),$=>(n(),l("md-menu-item",{key:$.value,onClick:x=>Ge(s,$.value),selected:$.value===e(f)},[a("div",Ds,g(t.$t($.label)),1)],8,Bs))),128))])]),default:_e(()=>[v((n(),l("button",As,[Es,c(je)])),[[h,t.$t("sort")]])]),_:1})])]),c(We,{limit:z,total:e(A),"all-checked-alert-visible":e(Ce),"real-all-checked":e(S),"select-real-all":e($e),"clear-selection":e(L)},null,8,["total","all-checked-alert-visible","real-all-checked","select-real-all","clear-selection"]),a("div",Ls,[i.value.length>0?(n(),l("div",{key:0,class:pe(["audio-list",{"select-mode":e(U)}])},[(n(!0),l(F,null,me(i.value,(s,$)=>{var x;return n(),l("section",{class:pe(["media-item selectable-card",{selected:e(w).includes(s.id),selecting:e(X).includes(s.id)}]),key:s.id,onClick:p(u=>e(we)(u,s,$,()=>{e(ze)(s)}),["stop"]),onMouseover:u=>e(qe)(u,$)},[a("div",zs,[e(X).includes(s.id)?(n(),l("md-checkbox",{key:0,class:"checkbox","touch-target":"wrapper",onClick:p(u=>e(W)(u,s,$),["stop"]),checked:e(Ae)},null,8,Ps)):(n(),l("md-checkbox",{key:1,class:"checkbox","touch-target":"wrapper",onClick:p(u=>e(W)(u,s,$),["stop"]),checked:e(w).includes(s.id)},null,8,Vs)),a("span",Rs,[c(Xe,{id:$+1,raw:s},null,8,["id","raw"])])]),te.value.includes(s.id)?(n(),he(Ye,{key:0,class:"image"})):(n(),l("img",{key:1,class:"image",src:e($t)(s.albumFileId,"&w=200&h=200"),onError:u=>Ne(s.id)},null,40,Fs)),a("div",Ns,g(s.title),1),a("div",Qs,[a("span",null,g(e(Ct)(s.size)),1),a("span",Us,g(e(wt)(s.duration)),1),a("a",{onClick:p(u=>e(Te)(e(m),s.bucketId),["stop","prevent"])},g((x=ke.value[s.bucketId])==null?void 0:x.name),9,xs),c(Ze,{tags:s.tags,type:e(_),"only-links":!0},null,8,["tags","type"])]),a("div",Gs,[v((n(),l("button",{class:"btn-icon sm",onClick:p(u=>e(be)(e(_),s),["stop"])},[Hs,c(M)],8,Ks)),[[h,t.$t("delete")]]),v((n(),l("button",{class:"btn-icon sm",onClick:p(u=>e(Se)(s.path,e(qt)(s.path).replace(" ","-")),["stop"])},[js,c(ie)],8,Os)),[[h,t.$t("download")]]),v((n(),l("button",{class:"btn-icon sm",onClick:p(u=>e(De)(u,s),["stop"])},[Ws,c(ce)],8,Js)),[[h,t.$t("add_to_playlist")]]),v((n(),l("button",{class:"btn-icon sm",onClick:p(u=>Ke(s),["stop"])},[Ys,c(de)],8,Xs)),[[h,t.$t("add_to_tags")]]),e(Ve)&&s.path===e(Pe)?(n(),l("md-circular-progress",Zs)):q(s)?v((n(),l("button",{key:1,class:"btn-icon sm",onClick:o[5]||(o[5]=p(u=>e(Re)(),["stop"]))},[eo,c(et)])),[[h,t.$t("pause")]]):G("",!0)]),a("div",to,g(s.artist),1),a("div",so,[v((n(),l("span",null,[At(g(e(Et)(s.createdAt)),1)])),[[h,e(It)(s.createdAt)]])])],42,Ms)}),128))],2)):(n(),l("div",oo,g(t.$t(e(St)(e(Qe),e(T).permissions,"WRITE_EXTERNAL_STORAGE"))),1)),e(A)>z?(n(),he(tt,{key:2,page:N.value,go:Y,total:e(A),limit:z},null,8,["page","total"])):G("",!0)])],64)}}}),ho=Kt(no,[["__scopeId","data-v-8c30045d"]]);export{ho as default};
