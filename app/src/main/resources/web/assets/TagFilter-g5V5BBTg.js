import{e as H,w as B,ad as P,ae as N,c as h,o as p,y as b,S as R,cc as A,aA as M,H as U,m as j,a as d,u as J,f as K,r as C,h as W,bf as Z,E as ee,a4 as T,k as V,Q as te,t as v,O as x,P as ne,R as I,p as $,T as Q,U as oe,a1 as E,bP as D,ab as ae,B as se,A as le,cd as ie,C as de,i as G,ce,cf as re,cg as ue}from"./index-CextXMl7.js";import{_ as me}from"./more-vert-PFQlu6Bi.js";import{_ as pe}from"./VIconButton.vuevuetypescriptsetuptruelang-BlGK_fBO.js";const _e=H({__name:"VDropdownMenu",props:{modelValue:{type:Boolean,default:!1},anchor:{type:String,required:!0}},emits:["update:modelValue"],setup(_,{emit:i}){const s=_,g=i;let a=null;const c=n=>{if(!a||!n)return;const t=a.getBoundingClientRect();if(t.width===0&&t.height===0){setTimeout(()=>c(n),10);return}const r=window.scrollY||document.documentElement.scrollTop,f=window.scrollX||document.documentElement.scrollLeft,w=t.bottom+r+8,k=t.left+f;n.style.top=`${Math.max(0,w)}px`,n.style.left=`${Math.max(0,k)}px`},u=n=>{if(a&&!a.contains(n.target)){const t=document.querySelector(".dropdown-menu.is-open");t&&!t.contains(n.target)&&g("update:modelValue",!1)}},m=n=>{if(s.modelValue&&a&&!a.contains(n.target)){const t=document.querySelector(".dropdown-menu.is-open");t&&!t.contains(n.target)&&g("update:modelValue",!1)}},y=n=>{var r,f;const t=n;(((r=t.detail)==null?void 0:r.exclude)===null||((f=t.detail)==null?void 0:f.exclude)!==a)&&s.modelValue&&g("update:modelValue",!1)};return B(()=>s.modelValue,async n=>{if(n&&(a=document.getElementById(s.anchor),a)){await M();const t=document.querySelector(".dropdown-menu.is-open");t&&c(t)}}),B(()=>s.anchor,async(n,t)=>{if(s.modelValue&&n&&n!==t&&(a=document.getElementById(n),a)){await M();const r=document.querySelector(".dropdown-menu.is-open");r&&c(r)}}),P(()=>{document.addEventListener("click",u),document.addEventListener("click",m,{capture:!0}),document.addEventListener("dropdown-toggle",y)}),N(()=>{document.removeEventListener("click",u),document.removeEventListener("click",m,{capture:!0}),document.removeEventListener("dropdown-toggle",y)}),(n,t)=>(p(),h("div",{class:R(["v-dropdown-menu",{"is-open":_.modelValue}]),onClick:t[0]||(t[0]=b(()=>{},["stop"]))},[A(n.$slots,"default",{},void 0,!0)],2))}}),fe=U(_e,[["__scopeId","data-v-3ffb0673"]]),ge={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ve(_,i){return p(),h("svg",ge,i[0]||(i[0]=[d("path",{fill:"currentColor",d:"M11 13H6q-.425 0-.712-.288T5 12t.288-.712T6 11h5V6q0-.425.288-.712T12 5t.713.288T13 6v5h5q.425 0 .713.288T19 12t-.288.713T18 13h-5v5q0 .425-.288.713T12 19t-.712-.288T11 18z"},null,-1)]))}const he=j({name:"material-symbols-add-rounded",render:ve}),ye={class:"top-app-bar"},we={class:"leading-icon"},ke={class:"title"},Te={class:"actions"},Ve={class:"nav"},be=["onClick"],Ce={class:"title"},$e={class:"count"},Ee=H({__name:"TagFilter",props:{type:{type:String,required:!0},selected:{type:String,required:!0}},setup(_){const i=_,{t:s}=J(),g=K(),a=C([]),c=C(!1),u=C(),{refetch:m}=W({handle:(e,o)=>{o?ee(s(o),"error"):e&&(a.value=e.tags)},document:Z,variables:{type:i.type}});function y(e){u.value=e;const o=document.getElementById("tag-"+e.id);document.dispatchEvent(new CustomEvent("dropdown-toggle",{detail:{exclude:o}})),c.value=!0}function n(e){E(D,{title:s("rename"),placeholder:s("name"),value:e.name,mutation:()=>G({document:ce}),getVariables:o=>({id:e.id,name:o}),done:()=>{m()}})}function t(e){E(ae,{id:e.id,name:e.name,gql:re,typeName:"Tag"})}function r(){E(D,{title:s("add_tag"),placeholder:s("name"),mutation:()=>G({document:ue,options:{update:()=>{m()}}}),getVariables:e=>({type:i.type,name:e})})}function f(e){const o=se([{name:"tag_id",op:"",value:e.id}]);le(g,`/${ie[i.type]}?q=${de(o)}`)}const w=e=>{e===i.type&&m()},k=e=>{e.type===i.type&&m()};return P(()=>{T.on("refetch_tags",w),T.on("media_items_actioned",k)}),N(()=>{T.off("refetch_tags",w),T.off("media_items_actioned",k)}),(e,o)=>{var S;const z=te,F=he,q=pe,O=me,X=fe,L=ne("tooltip");return p(),h(Q,null,[d("div",ye,[d("div",we,[V(z)]),d("div",ke,v(e.$t("tags")),1),d("div",Te,[x((p(),I(q,{onClick:b(r,["prevent"])},{icon:$(()=>[V(F)]),_:1})),[[L,e.$t("add_tag")]])])]),d("ul",Ve,[(p(!0),h(Q,null,oe(a.value,l=>(p(),h("li",{key:l.id,class:R({active:l.id===_.selected}),onClick:b(Y=>f(l),["prevent"])},[d("span",Ce,v(l.name),1),x((p(),I(q,{id:"tag-"+l.id,class:"sm",onClick:b(Y=>y(l),["prevent","stop"])},{icon:$(()=>[V(O)]),_:2},1032,["id","onClick"])),[[L,e.$t("actions")]]),d("span",$e,v(l.count.toLocaleString()),1)],10,be))),128))]),V(X,{modelValue:c.value,"onUpdate:modelValue":o[2]||(o[2]=l=>c.value=l),anchor:"tag-"+((S=u.value)==null?void 0:S.id)},{default:$(()=>[d("div",{class:"dropdown-item",onClick:o[0]||(o[0]=l=>{n(u.value),c.value=!1})},v(e.$t("rename")),1),d("div",{class:"dropdown-item",onClick:o[1]||(o[1]=l=>{t(u.value),c.value=!1})},v(e.$t("delete")),1)]),_:1},8,["modelValue","anchor"])],64)}}}),Be=U(Ee,[["__scopeId","data-v-96d6a7ff"]]);export{Be as _,fe as a,he as b};
