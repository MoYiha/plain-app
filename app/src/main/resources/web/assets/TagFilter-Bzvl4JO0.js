import{e as P,w as D,ad as R,ae as U,c as w,o as m,y as S,S as A,cf as F,aB as X,H as Y,m as j,a as c,u as J,f as K,r as B,h as Z,bi as ee,E as te,a4 as V,k as $,Q as oe,t as y,O as N,P as ne,R as Q,aT as se,p as H,T as G,U as ae,a1 as I,bS as O,ab as ie,B as le,A as ce,cg as de,C as re,i as W,ch as ue,ci as pe,cj as me}from"./index-Dd8UjYtJ.js";import{_ as _e}from"./more-vert-CD_DV9h0.js";const L=8,fe=120,ve=80,ge=".v-dropdown-menu.is-open",he=P({__name:"VDropdownMenu",props:{modelValue:{type:Boolean,default:!1},anchor:{type:String,required:!0}},emits:["update:modelValue"],setup(_,{emit:l}){const s=_,x=l;let a=null;const d=()=>document.querySelector(ge),r=()=>x("update:modelValue",!1),f=e=>{if(!(a!=null&&a.contains(e.target))){const o=d();return!(o!=null&&o.contains(e.target))}return!1},T=e=>{if(!a||!e)return;const o=a.getBoundingClientRect();if(o.width===0&&o.height===0){setTimeout(()=>T(e),10);return}const{innerWidth:C,innerHeight:t}=window,n=window.scrollY||document.documentElement.scrollTop,g=window.scrollX||document.documentElement.scrollLeft,M=e.offsetWidth||fe,h=e.offsetHeight||ve;let u=o.bottom+n+L,p=o.left+g;p+M>C&&(p=o.right+g-M),p=Math.max(g+L,p),u+h>t+n&&(u=o.top+n-h-L,u<n&&(u=n+L,e.style.maxHeight=`${t-16}px`,e.style.overflowY="auto")),e.style.top=`${Math.max(0,u)}px`,e.style.left=`${Math.max(0,p)}px`,e.style.opacity="1",e.style.visibility="visible"},v=e=>{f(e)&&r()},b=e=>{const{detail:o}=e;s.modelValue&&(!(o!=null&&o.exclude)||o.exclude!==a)&&r()},k=async()=>{a=document.getElementById(s.anchor),a&&(await X(),setTimeout(()=>{const e=d();e&&T(e)},10))};return D(()=>s.modelValue,e=>{if(e)k();else{const o=d();o&&(o.style.opacity="0",o.style.visibility="hidden")}}),D(()=>s.anchor,(e,o)=>{s.modelValue&&e!==o&&k()}),R(()=>{document.addEventListener("click",v),document.addEventListener("click",v,{capture:!0}),document.addEventListener("dropdown-toggle",b)}),U(()=>{document.removeEventListener("click",v),document.removeEventListener("click",v,{capture:!0}),document.removeEventListener("dropdown-toggle",b)}),(e,o)=>(m(),w("div",{class:A(["v-dropdown-menu",{"is-open":_.modelValue}]),onClick:o[0]||(o[0]=S(()=>{},["stop"]))},[F(e.$slots,"default",{},void 0,!0)],2))}}),ye=Y(he,[["__scopeId","data-v-7a0835bb"]]),we={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Te(_,l){return m(),w("svg",we,l[0]||(l[0]=[c("path",{fill:"currentColor",d:"M11 13H6q-.425 0-.712-.288T5 12t.288-.712T6 11h5V6q0-.425.288-.712T12 5t.713.288T13 6v5h5q.425 0 .713.288T19 12t-.288.713T18 13h-5v5q0 .425-.288.713T12 19t-.712-.288T11 18z"},null,-1)]))}const be=j({name:"material-symbols-add-rounded",render:Te}),ke={class:"top-app-bar"},Ce={class:"leading-icon"},Me={class:"title"},Ve={class:"actions"},$e={class:"nav"},Le=["onClick"],Se={class:"title"},xe={class:"count"},Be=P({__name:"TagFilter",props:{type:{type:String,required:!0},selected:{type:String,required:!0}},setup(_){const l=_,{t:s}=J(),x=K(),a=B([]),d=B(!1),r=B(),{refetch:f}=Z({handle:(t,n)=>{n?te(s(n),"error"):t&&(a.value=t.tags)},document:ee,variables:{type:l.type}});function T(t){r.value=t;const n=document.getElementById("tag-"+t.id);document.dispatchEvent(new CustomEvent("dropdown-toggle",{detail:{exclude:n}})),d.value=!0}function v(t){I(O,{title:s("rename"),placeholder:s("name"),value:t.name,mutation:()=>W({document:ue}),getVariables:n=>({id:t.id,name:n}),done:()=>{f()}})}function b(t){I(ie,{id:t.id,name:t.name,gql:pe,typeName:"Tag"})}function k(){I(O,{title:s("add_tag"),placeholder:s("name"),mutation:()=>W({document:me,options:{update:()=>{f()}}}),getVariables:t=>({type:l.type,name:t})})}function e(t){const n=le([{name:"tag_id",op:"",value:t.id}]);ce(x,`/${de[l.type]}?q=${re(n)}`)}const o=t=>{t===l.type&&f()},C=t=>{t.type===l.type&&f()};return R(()=>{V.on("refetch_tags",o),V.on("media_items_actioned",C)}),U(()=>{V.off("refetch_tags",o),V.off("media_items_actioned",C)}),(t,n)=>{var E;const g=oe,M=be,h=se,u=_e,p=ye,q=ne("tooltip");return m(),w(G,null,[c("div",ke,[c("div",Ce,[$(g)]),c("div",Me,y(t.$t("tags")),1),c("div",Ve,[N((m(),Q(h,{onClick:S(k,["prevent"])},{default:H(()=>[$(M)]),_:1})),[[q,t.$t("add_tag")]])])]),c("ul",$e,[(m(!0),w(G,null,ae(a.value,i=>(m(),w("li",{key:i.id,class:A({active:i.id===_.selected}),onClick:S(z=>e(i),["prevent"])},[c("span",Se,y(i.name),1),N((m(),Q(h,{id:"tag-"+i.id,class:"sm",onClick:S(z=>T(i),["prevent","stop"])},{default:H(()=>[$(u)]),_:2},1032,["id","onClick"])),[[q,t.$t("actions")]]),c("span",xe,y(i.count.toLocaleString()),1)],10,Le))),128))]),$(p,{modelValue:d.value,"onUpdate:modelValue":n[2]||(n[2]=i=>d.value=i),anchor:"tag-"+((E=r.value)==null?void 0:E.id)},{default:H(()=>[c("div",{class:"dropdown-item",onClick:n[0]||(n[0]=i=>{v(r.value),d.value=!1})},y(t.$t("rename")),1),c("div",{class:"dropdown-item",onClick:n[1]||(n[1]=i=>{b(r.value),d.value=!1})},y(t.$t("delete")),1)]),_:1},8,["modelValue","anchor"])],64)}}}),qe=Y(Be,[["__scopeId","data-v-82789b4e"]]);export{qe as _,ye as a,be as b};
