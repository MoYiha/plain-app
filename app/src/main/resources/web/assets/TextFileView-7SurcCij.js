import{m as R,c as a,o as t,a as e,e as J,u as W,g as z,s as q,r as i,aG as M,ac as A,w as G,k as T,cx as K,t as c,cy as Q,j as v,l as L,n as X,X as Y,Y as V,O as j,Q as P,I as Z,cw as ee,F as te}from"./index-H9YOjX-Y.js";import{u as oe}from"./markdown-9NTK5H0b.js";import{_ as ne}from"./json-viewer.vuevuetypestyleindex0lang-D-_zuu91.js";const se={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ae(x,o){return t(),a("svg",se,o[0]||(o[0]=[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m16 18l6-6l-6-6M8 6l-6 6l6 6"},null,-1)]))}const le=R({name:"lucide-code",render:ae}),re={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ie(x,o){return t(),a("svg",re,o[0]||(o[0]=[e("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[e("path",{d:"M2.062 12.348a1 1 0 0 1 0-.696a10.75 10.75 0 0 1 19.876 0a1 1 0 0 1 0 .696a10.75 10.75 0 0 1-19.876 0"}),e("circle",{cx:"12",cy:"12",r:"3"})],-1)]))}const ce=R({name:"lucide-eye",render:ie}),de={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ue(x,o){return t(),a("svg",de,o[0]||(o[0]=[e("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[e("path",{d:"M12 15V3m9 12v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e("path",{d:"m7 10l5 5l5-5"})],-1)]))}const _e=R({name:"lucide-download",render:ue}),me={class:"header"},ve={class:"main-content"},fe={key:0,class:"state-container"},pe={class:"state-text"},he={key:1,class:"state-container error"},ke={class:"state-text"},we={key:2,class:"text-content"},ge={class:"file-header"},ye={class:"file-info"},xe={class:"file-name"},Ce={key:0,class:"file-meta"},be={key:0},$e={key:1},Me={class:"file-actions"},Te={class:"content-display"},je={key:0,class:"text-view"},Re=["innerHTML"],Be=J({__name:"TextFileView",setup(x){const{t:o}=W(),F=Z(),E=z(),{app:I,urlTokenKey:N}=q(E),C=i(!0),u=i(""),f=i(""),r=i(""),p=i(0),h=i(""),b=i(null),$=i(""),_=i(!1),{render:S}=oe(I,N),k=M(()=>r.value.toLowerCase().endsWith(".json")),w=M(()=>{const n=r.value.toLowerCase();return n.endsWith(".md")||n.endsWith(".markdown")}),U=M(()=>k.value||w.value),B=async()=>{try{C.value=!0,u.value="";const n=F.query.id;if(!n){u.value=o("invalid_file_id");return}const s=await fetch(`${ee()}/fs?id=${encodeURIComponent(n)}`);if(!s.ok){u.value=s.status===404?o("file_not_found"):s.status===403?o("access_denied"):o("failed_to_load_file");return}const l=s.headers.get("content-disposition");if(l){const d=l.match(/filename="?([^"]+)"?/);if(d)try{r.value=decodeURIComponent(d[1]).replace(/[/\\:*?"<>|]+/g,"_")}catch{}}const g=s.headers.get("content-length");g&&(p.value=parseInt(g));const y=s.headers.get("last-modified");y&&(h.value=y);const m=await s.text();if(f.value=m,b.value=null,$.value="",_.value=!1,k.value)try{b.value=JSON.parse(m)}catch(d){console.error("Error parsing JSON:",d),u.value=o("invalid_json_format")}else if(w.value)try{$.value=await S(m)}catch(d){console.error("Error rendering markdown:",d)}}catch(n){console.error("Error loading text file:",n),u.value=o("network_error")}finally{C.value=!1}},O=()=>B(),D=()=>{if(!f.value||!r.value)return;const n=new Blob([f.value],{type:"text/plain;charset=utf-8"}),s=window.URL.createObjectURL(n),l=document.createElement("a");l.href=s,l.download=r.value,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(s)},H=()=>{_.value=!_.value};return A(B),G(r,()=>{r.value&&(document.title=r.value)}),(n,s)=>{const l=K,g=Q,y=_e,m=ce,d=le;return t(),a(P,null,[e("header",me,[T(l,{"logged-in":!1})]),e("main",ve,[C.value?(t(),a("section",fe,[s[0]||(s[0]=e("md-circular-progress",{indeterminate:""},null,-1)),e("span",pe,c(n.$t("loading")),1)])):u.value?(t(),a("section",he,[T(g,{class:"state-icon"}),e("span",ke,c(u.value),1),e("md-outlined-button",{onClick:O},c(n.$t("retry")),1)])):(t(),a("article",we,[e("header",ge,[e("div",ye,[e("h1",xe,c(r.value),1),p.value||h.value?(t(),a("div",Ce,[p.value?(t(),a("span",be,c(L(X)(p.value)),1)):v("",!0),h.value?(t(),a("span",$e,c(L(Y)(h.value)),1)):v("",!0)])):v("",!0)]),e("div",Me,[e("md-outlined-button",{onClick:D,class:"action-btn"},[T(y,{slot:"icon"}),V(" "+c(n.$t("download")),1)]),U.value?(t(),a("md-outlined-button",{key:0,onClick:H,class:"action-btn"},[_.value?(t(),j(m,{key:0,slot:"icon"})):(t(),j(d,{key:1,slot:"icon"})),V(" "+c(_.value?n.$t("formatted_view"):n.$t("raw_text")),1)])):v("",!0)])]),e("section",Te,[_.value||!k.value&&!w.value?(t(),a("pre",je,c(f.value),1)):k.value?(t(),j(ne,{key:1,value:b.value,"expand-depth":2},null,8,["value"])):w.value?(t(),a("div",{key:2,class:"md-container",innerHTML:$.value},null,8,Re)):v("",!0)])]))])],64)}}}),Ie=te(Be,[["__scopeId","data-v-ff82d63b"]]);export{Ie as default};
