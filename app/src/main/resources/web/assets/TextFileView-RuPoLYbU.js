import{m as j,c as s,o,a as e,e as Y,u as G,g as Q,s as X,r,aL as F,ad as Z,w as ee,k as m,cE as te,Y as oe,t as i,cF as ne,p as b,as as se,j as p,O as ae,l as V,n as le,P as re,$ as ie,F as k,a0 as ce,R as g,S as ue,T as de,K as _e,cD as ve,H as me}from"./index-CextXMl7.js";import{u as pe}from"./markdown-BZwsfwd6.js";import{_ as he}from"./json-viewer.vuevuetypestyleindex0lang-R4fQiQiC.js";const fe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function we(y,t){return o(),s("svg",fe,t[0]||(t[0]=[e("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[e("path",{d:"m16 16l-2 2l2 2"}),e("path",{d:"M3 12h15a3 3 0 1 1 0 6h-4M3 18h7M3 6h18"})],-1)]))}const ke=j({name:"lucide-wrap-text",render:we}),ge={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ye(y,t){return o(),s("svg",ge,t[0]||(t[0]=[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m16 18l6-6l-6-6M8 6l-6 6l6 6"},null,-1)]))}const xe=j({name:"lucide-code",render:ye}),Ce={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function $e(y,t){return o(),s("svg",Ce,t[0]||(t[0]=[e("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[e("path",{d:"M2.062 12.348a1 1 0 0 1 0-.696a10.75 10.75 0 0 1 19.876 0a1 1 0 0 1 0 .696a10.75 10.75 0 0 1-19.876 0"}),e("circle",{cx:"12",cy:"12",r:"3"})],-1)]))}const Me=j({name:"lucide-eye",render:$e}),Te={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function be(y,t){return o(),s("svg",Te,t[0]||(t[0]=[e("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[e("path",{d:"M12 15V3m9 12v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e("path",{d:"m7 10l5 5l5-5"})],-1)]))}const je=j({name:"lucide-download",render:be}),Re={class:"header"},Be={class:"main-content"},Le={key:0,class:"state-container"},Fe={class:"state-text"},Ve={key:1,class:"state-container error"},Ee={class:"state-text"},Se={key:2,class:"text-content"},De={class:"file-header"},Ne={class:"file-info"},Ue={class:"file-name"},Ie={key:0,class:"file-meta"},He={key:0},Oe={key:1},We={class:"file-actions"},ze={class:"content-display"},Je=["innerHTML"],Ae=Y({__name:"TextFileView",setup(y){const{t}=G(),D=_e(),N=Q(),{app:U,urlTokenKey:I}=X(N),R=r(!0),_=r(""),x=r(""),c=r(""),C=r(0),h=r(""),B=r(null),L=r(""),v=r(!1),$=r(!0),{render:H}=pe(U,I),f=F(()=>c.value.toLowerCase().endsWith(".json")),w=F(()=>{const n=c.value.toLowerCase();return n.endsWith(".md")||n.endsWith(".markdown")}),O=F(()=>f.value||w.value),E=async()=>{try{R.value=!0,_.value="";const n=D.query.id;if(!n){_.value=t("invalid_file_id");return}const a=await fetch(`${ve()}/fs?id=${encodeURIComponent(n)}`);if(!a.ok){_.value=a.status===404?t("file_not_found"):a.status===403?t("access_denied"):t("failed_to_load_file");return}const l=a.headers.get("content-disposition");if(l){const d=l.match(/filename="?([^"]+)"?/);if(d)try{c.value=decodeURIComponent(d[1]).replace(/[/\\:*?"<>|]+/g,"_")}catch{}}const M=a.headers.get("content-length");M&&(C.value=parseInt(M));const T=a.headers.get("last-modified");T&&(h.value=T);const u=await a.text();if(x.value=u,B.value=null,L.value="",v.value=!1,f.value)try{B.value=JSON.parse(u)}catch(d){console.error("Error parsing JSON:",d),_.value=t("invalid_json_format")}else if(w.value)try{L.value=await H(u)}catch(d){console.error("Error rendering markdown:",d)}}catch(n){console.error("Error loading text file:",n),_.value=t("network_error")}finally{R.value=!1}},W=()=>E(),z=()=>{if(!x.value||!c.value)return;const n=new Blob([x.value],{type:"text/plain;charset=utf-8"}),a=window.URL.createObjectURL(n),l=document.createElement("a");l.href=a,l.download=c.value,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(a)},J=()=>{v.value=!v.value},A=()=>{$.value=!$.value};return Z(E),ee(c,()=>{c.value&&(document.title=c.value)}),(n,a)=>{const l=te,M=oe,T=ne,u=se,d=je,S=Me,K=xe,q=ke,P=re("tooltip");return o(),s(de,null,[e("header",Re,[m(l,{"logged-in":!1})]),e("main",Be,[R.value?(o(),s("section",Le,[m(M,{indeterminate:""}),e("span",Fe,i(n.$t("loading")),1)])):_.value?(o(),s("section",Ve,[m(T,{class:"state-icon"}),e("span",Ee,i(_.value),1),m(u,{onClick:W},{default:b(()=>[k(i(n.$t("retry")),1)]),_:1})])):(o(),s("article",Se,[e("header",De,[e("div",Ne,[e("h1",Ue,i(c.value),1),C.value||h.value?(o(),s("div",Ie,[C.value?(o(),s("span",He,i(V(le)(C.value)),1)):p("",!0),h.value?ae((o(),s("span",Oe,[k(i(V(ce)(h.value)),1)])),[[P,V(ie)(h.value)]]):p("",!0)])):p("",!0)]),e("div",We,[m(u,{class:"action-btn",onClick:z},{default:b(()=>[m(d,{slot:"icon"}),k(" "+i(n.$t("download")),1)]),_:1}),O.value?(o(),g(u,{key:0,class:"action-btn",onClick:J},{default:b(()=>[v.value?(o(),g(S,{key:0,slot:"icon"})):(o(),g(K,{key:1,slot:"icon"})),k(" "+i(v.value?n.$t("formatted_view"):n.$t("raw_text")),1)]),_:1})):p("",!0),v.value||!f.value&&!w.value?(o(),g(u,{key:1,class:"action-btn",onClick:A},{default:b(()=>[m(q,{slot:"icon"}),k(" "+i($.value?n.$t("unwrap"):n.$t("wrap")),1)]),_:1})):p("",!0)])]),e("section",ze,[v.value||!f.value&&!w.value?(o(),s("pre",{key:0,class:ue(["text-view",{"text-wrap":$.value}])},i(x.value),3)):f.value?(o(),g(he,{key:1,value:B.value,"expand-depth":2},null,8,["value"])):w.value?(o(),s("div",{key:2,class:"md-container",innerHTML:L.value},null,8,Je)):p("",!0)])]))])],64)}}}),Ye=me(Ae,[["__scopeId","data-v-535b49ca"]]);export{Ye as default};
