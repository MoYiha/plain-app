import{_ as V}from"./LeftSidebar.vuevuetypescriptsetuptruelang-Bwcxwg_R.js";import{_ as I}from"./TagFilter.vuevuetypescriptsetuptruelang-nDSyeZ_O.js";import{e as M,f as Q,s as z,g as A,K as D,r as p,N as R,w as G,ae as U,a5 as h,af as j,J as x,o as u,q as C,a6 as k,a4 as E,ag as F,a as s,k as H,c as _,z as S,T as B,j as $,t as a,l as L,V as J,U as K,G as P,C as O,B as T,D as W}from"./index-DRp6xo3j.js";import{u as X}from"./search-VN1T4MU3.js";const Y={class:"nav"},Z={class:"title"},ee={key:0,class:"count"},te=["onClick"],se={class:"title"},ae={key:0,class:"count"},ue=M({__name:"CallsSidebar",setup(oe){const m=Q(),{counter:d}=z(A()),{parseQ:q}=X(),o=D({tagIds:[]}),n=p(""),l=p(""),c=p(new Map),{fetch:f}=R({handle:e=>{e&&(d.value.calls=e.total,c.value.set("1",e.incoming),c.value.set("2",e.outgoing),c.value.set("3",e.missed))},document:F,variables:()=>({})});function v(e){return c.value.get(e)??-1}function g(){var i;const e=k.currentRoute.value,r=E(((i=e.query.q)==null?void 0:i.toString())??"");q(o,r),n.value=o.type??"",l.value=o.tagIds.length===1?o.tagIds[0]:"",n.value&&(l.value=""),f()}g(),G(()=>k.currentRoute.value,()=>{g()});function w(e){const r=O([{name:"type",op:"",value:e}]);T(m,`/calls?q=${W(r)}`)}function b(){T(m,"/calls")}const y=()=>{f()};return U(()=>{h.on("calls_deleted",y)}),j(()=>{h.off("calls_deleted",y)}),(e,r)=>{const i=I,N=V;return u(),x(N,null,{title:C(()=>[P(a(e.$t("page_title.calls")),1)]),body:C(()=>[s("ul",Y,[s("li",{class:B({active:!l.value&&!n.value}),onClick:S(b,["prevent"])},[s("span",Z,a(e.$t("all")),1),L(d).calls>=0?(u(),_("span",ee,a(L(d).calls.toLocaleString()),1)):$("",!0)],2),(u(),_(K,null,J(["1","2","3"],t=>s("li",{key:t,class:B({active:t===n.value}),onClick:S(ne=>w(t),["prevent"])},[s("span",se,a(e.$t(`call_type.${t}`)),1),v(t)>=0?(u(),_("span",ae,a(v(t).toLocaleString()),1)):$("",!0)],10,te)),64))]),H(i,{type:"CALL",selected:l.value},null,8,["selected"])]),_:1})}}});export{ue as default};
