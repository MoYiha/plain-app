import{_ as T}from"./LeftSidebar.vuevuetypescriptsetuptruelang-CF3KQ8wQ.js";import{_ as w}from"./TagFilter.vuevuetypescriptsetuptruelang-DA-dvEFf.js";import{d as b,g as E,u as D,h as g,aF as L,l as N,C as Q,aT as U,aU as x,a0 as y,aV as F,o as h,c as I,P as G,w as V,m as $,N as A,a as _,t as f,O as P,s as R,i as z,I as H,aC as j,K as J,J as u,k as K,v as W,q as B,V as X,e as Y,p as q,a5 as C,$ as Z,f as ee}from"./index-BxNI00MG.js";import{u as te}from"./search-D1_YTViL.js";const ae=["onClick"],se={class:"title"},oe={class:"count"},ne=b({__name:"BucketFilter",props:{type:{type:String,required:!0},selected:{type:String,required:!0}},setup(d){const e=d,{t:k}=E(),s=D(),v=g([]),{view:i}=L(e.type),{refetch:r}=N({handle:(a,p)=>{p?Q(k(p),"error"):a&&(v.value=a.mediaBuckets)},document:U,variables:{type:e.type},appApi:!0}),o=a=>{a.type===e.type&&r()},l=a=>{a.item.bucketId&&a.type===e.type&&r()};return x(()=>{y.on("media_items_deleted",o),y.on("media_item_deleted",l)}),F(()=>{y.off("media_items_deleted",o),y.off("media_item_deleted",l)}),(a,p)=>(h(!0),I(P,null,G(v.value,n=>(h(),I("li",{key:n.id,onClick:V(S=>$(i)($(s),n.id),["prevent"]),class:A({active:d.selected&&n.id===d.selected})},[_("span",se,f(n.name),1),_("span",oe,f(n.itemCount.toLocaleString()),1)],10,ae))),128))}}),le={class:"nav"},ce={class:"title"},ie={key:0,class:"count"},me=b({__name:"MediaSidebar",props:{type:{type:String,required:!0},gql:{type:Object,required:!0}},setup(d){const e=d,k=D(),{counter:s}=R(z()),{parseQ:v}=te(),i=H({tagIds:[]}),r=g(""),o=g(""),l=g(""),a=j(()=>{var t,m,c;return e.type===u.IMAGE?((t=s.value)==null?void 0:t.images)??-1:e.type===u.VIDEO?((m=s.value)==null?void 0:m.videos)??-1:e.type===u.AUDIO?((c=s.value)==null?void 0:c.audios)??-1:-1}),{fetch:p}=J({handle:t=>{t&&(e.type===u.IMAGE?s.value.images=t.total:e.type===u.VIDEO?s.value.videos=t.total:e.type===u.AUDIO&&(s.value.audios=t.total))},document:e.gql,variables:()=>({}),appApi:!0});function n(){var c;const t=C.currentRoute.value;r.value=t.meta.group||"",p();const m=Z(((c=t.query.q)==null?void 0:c.toString())??"");v(i,m),o.value=i.tagIds.length===1?i.tagIds[0]:"",l.value=i.bucketId??"",o.value&&l.value&&(o.value="")}n(),K(()=>C.currentRoute.value.fullPath,()=>{n()});function S(){ee(k,`/${r.value}`)}return(t,m)=>{const c=ne,M=w,O=T;return h(),W(O,null,{title:B(()=>[X(f(t.$t(`page_title.${r.value}`)),1)]),body:B(()=>[_("ul",le,[_("li",{onClick:V(S,["prevent"]),class:A({active:!o.value&&!l.value})},[_("span",ce,f(t.$t("all")),1),a.value>=0?(h(),I("span",ie,f(a.value.toLocaleString()),1)):Y("",!0)],2),q(c,{type:e.type,selected:l.value},null,8,["type","selected"])]),q(M,{type:e.type,selected:o.value},null,8,["type","selected"])]),_:1})}}});export{me as _};
