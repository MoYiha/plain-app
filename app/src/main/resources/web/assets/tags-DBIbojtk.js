import{e as j,aA as z,r as h,aB as E,cw as J,i as C,cx as R,cy as U,J as v,o as p,q as c,k as f,G as y,t as i,l as a,aD as T,ak as W,j as Z,Z as x,A as H,a as m,Q as K,T as q,c as O,V as P,bE as X,U as Y,bB as ee,ar as te,aF as ae,a5 as $,bW as se,I as oe,u as A,N as ne,bk as le,F,a2 as de}from"./index-DRp6xo3j.js";const re={class:"button-group"},ue=j({__name:"AddToTagsModal",props:{type:{type:String,required:!0},tags:{type:Array,default:()=>[]},query:{type:String,required:!0}},setup(d){const{handleSubmit:_}=z(),s=h("add_to_tags"),t=d,{value:o,errorMessage:n}=E("selectedTags",J().test("required","valid.required",e=>e.length),{initialValue:[]}),{mutate:l,loading:g,onDone:B}=C({document:R}),{mutate:D,loading:k,onDone:M}=C({document:U}),b=()=>{$.emit("items_tags_updated",{type:t.type}),$.emit("refetch_tags",t.type),T()};M(b),B(b);function S(e){o.value.includes(e)?se(o.value,r=>r.id===e.id):o.value.push(e)}const V=_(()=>{s.value==="add_to_tags"?D({type:t.type,tagIds:o.value.map(e=>e.id),query:t.query}):l({type:t.type,tagIds:o.value.map(e=>e.id),query:t.query})});return(e,r)=>{const I=X,L=ee,N=W,Q=x,w=H,G=ae;return p(),v(G,{onClose:a(T)},{headline:c(()=>[y(i(e.$t("tags")),1)]),content:c(()=>[m("div",re,[m("button",{class:q({selected:s.value==="add_to_tags"}),onClick:r[0]||(r[0]=u=>s.value="add_to_tags")},i(e.$t("add_to_tags")),3),m("button",{class:q({selected:s.value==="remove_from_tags"}),onClick:r[1]||(r[1]=u=>s.value="remove_from_tags")},i(e.$t("remove_from_tags")),3)]),f(L,null,{default:c(()=>[(p(!0),O(Y,null,P(d.tags,u=>(p(),v(I,{key:u.id,label:u.name,selected:a(o).includes(u),onClick:ie=>S(u)},null,8,["label","selected","onClick"]))),128))]),_:1}),K(m("div",{class:"invalid-feedback"},i(a(n)?e.$t(a(n)):""),513),[[te,a(n)]])]),actions:c(()=>[f(N,{value:"cancel",onClick:a(T)},{default:c(()=>[y(i(e.$t("cancel")),1)]),_:1},8,["onClick"]),f(w,{value:"save",disabled:a(k)||a(g),onClick:a(V)},{default:c(()=>[a(k)||a(g)?(p(),v(Q,{key:0,indeterminate:""})):Z("",!0),y(" "+i(e.$t("save")),1)]),_:1},8,["disabled","onClick"])]),_:1},8,["onClose"])}}}),ce=oe(ue,[["__scopeId","data-v-311a7874"]]),ge=(d,_)=>{const{t:s}=A();return{addToTags:(t,o,n)=>{let l=n;if(!o){if(t.length===0){F(s("select_first"),"error");return}l=`ids:${t.join(",")}`}de(ce,{type:d,tags:_.value,query:l})}}},pe=(d,_=()=>{})=>{const s=h([]),{t}=A(),{loading:o,fetch:n}=ne({handle:async(l,g)=>{g?F(t(g),"error"):l&&(s.value=l.tags,_())},document:le,variables:{type:d}});return{tags:s,loading:o,fetch:n}};export{ge as a,pe as u};
