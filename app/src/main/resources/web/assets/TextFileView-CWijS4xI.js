import{m as b,c as s,o,a as e,e as q,u as A,g as G,s as K,r,aG as B,ac as P,w as Q,k as $,cx as X,t as i,cy as Y,j as m,l as E,n as Z,X as ee,Y as R,O as L,P as te,Q as oe,I as ne,cw as se,F as ae}from"./index-BaB8vEEK.js";import{u as le}from"./markdown-D0m8_M5p.js";import{_ as re}from"./json-viewer.vuevuetypestyleindex0lang-WsJa1CP5.js";const ie={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ce(f,t){return o(),s("svg",ie,t[0]||(t[0]=[e("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[e("path",{d:"m16 16l-2 2l2 2"}),e("path",{d:"M3 12h15a3 3 0 1 1 0 6h-4M3 18h7M3 6h18"})],-1)]))}const de=b({name:"lucide-wrap-text",render:ce}),ue={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function _e(f,t){return o(),s("svg",ue,t[0]||(t[0]=[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m16 18l6-6l-6-6M8 6l-6 6l6 6"},null,-1)]))}const me=b({name:"lucide-code",render:_e}),ve={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function pe(f,t){return o(),s("svg",ve,t[0]||(t[0]=[e("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[e("path",{d:"M2.062 12.348a1 1 0 0 1 0-.696a10.75 10.75 0 0 1 19.876 0a1 1 0 0 1 0 .696a10.75 10.75 0 0 1-19.876 0"}),e("circle",{cx:"12",cy:"12",r:"3"})],-1)]))}const he=b({name:"lucide-eye",render:pe}),fe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function we(f,t){return o(),s("svg",fe,t[0]||(t[0]=[e("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[e("path",{d:"M12 15V3m9 12v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e("path",{d:"m7 10l5 5l5-5"})],-1)]))}const ke=b({name:"lucide-download",render:we}),ge={class:"header"},ye={class:"main-content"},xe={key:0,class:"state-container"},Ce={class:"state-text"},$e={key:1,class:"state-container error"},be={class:"state-text"},Me={key:2,class:"text-content"},Te={class:"file-header"},je={class:"file-info"},Be={class:"file-name"},Re={key:0,class:"file-meta"},Le={key:0},Ve={key:1},Fe={class:"file-actions"},Ee={class:"content-display"},Ie=["innerHTML"],Ne=q({__name:"TextFileView",setup(f){const{t}=A(),I=ne(),N=G(),{app:S,urlTokenKey:U}=K(N),M=r(!0),u=r(""),w=r(""),c=r(""),k=r(0),g=r(""),T=r(null),j=r(""),_=r(!1),y=r(!0),{render:O}=le(S,U),v=B(()=>c.value.toLowerCase().endsWith(".json")),p=B(()=>{const n=c.value.toLowerCase();return n.endsWith(".md")||n.endsWith(".markdown")}),W=B(()=>v.value||p.value),V=async()=>{try{M.value=!0,u.value="";const n=I.query.id;if(!n){u.value=t("invalid_file_id");return}const a=await fetch(`${se()}/fs?id=${encodeURIComponent(n)}`);if(!a.ok){u.value=a.status===404?t("file_not_found"):a.status===403?t("access_denied"):t("failed_to_load_file");return}const l=a.headers.get("content-disposition");if(l){const d=l.match(/filename="?([^"]+)"?/);if(d)try{c.value=decodeURIComponent(d[1]).replace(/[/\\:*?"<>|]+/g,"_")}catch{}}const x=a.headers.get("content-length");x&&(k.value=parseInt(x));const C=a.headers.get("last-modified");C&&(g.value=C);const h=await a.text();if(w.value=h,T.value=null,j.value="",_.value=!1,v.value)try{T.value=JSON.parse(h)}catch(d){console.error("Error parsing JSON:",d),u.value=t("invalid_json_format")}else if(p.value)try{j.value=await O(h)}catch(d){console.error("Error rendering markdown:",d)}}catch(n){console.error("Error loading text file:",n),u.value=t("network_error")}finally{M.value=!1}},D=()=>V(),H=()=>{if(!w.value||!c.value)return;const n=new Blob([w.value],{type:"text/plain;charset=utf-8"}),a=window.URL.createObjectURL(n),l=document.createElement("a");l.href=a,l.download=c.value,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(a)},z=()=>{_.value=!_.value},J=()=>{y.value=!y.value};return P(V),Q(c,()=>{c.value&&(document.title=c.value)}),(n,a)=>{const l=X,x=Y,C=ke,h=he,d=me,F=de;return o(),s(oe,null,[e("header",ge,[$(l,{"logged-in":!1})]),e("main",ye,[M.value?(o(),s("section",xe,[a[0]||(a[0]=e("md-circular-progress",{indeterminate:""},null,-1)),e("span",Ce,i(n.$t("loading")),1)])):u.value?(o(),s("section",$e,[$(x,{class:"state-icon"}),e("span",be,i(u.value),1),e("md-outlined-button",{onClick:D},i(n.$t("retry")),1)])):(o(),s("article",Me,[e("header",Te,[e("div",je,[e("h1",Be,i(c.value),1),k.value||g.value?(o(),s("div",Re,[k.value?(o(),s("span",Le,i(E(Z)(k.value)),1)):m("",!0),g.value?(o(),s("span",Ve,i(E(ee)(g.value)),1)):m("",!0)])):m("",!0)]),e("div",Fe,[e("md-outlined-button",{class:"action-btn",onClick:H},[$(C,{slot:"icon"}),R(" "+i(n.$t("download")),1)]),W.value?(o(),s("md-outlined-button",{key:0,class:"action-btn",onClick:z},[_.value?(o(),L(h,{key:0,slot:"icon"})):(o(),L(d,{key:1,slot:"icon"})),R(" "+i(_.value?n.$t("formatted_view"):n.$t("raw_text")),1)])):m("",!0),_.value||!v.value&&!p.value?(o(),s("md-outlined-button",{key:1,class:"action-btn",onClick:J},[$(F,{slot:"icon"}),R(" "+i(y.value?n.$t("unwrap"):n.$t("wrap")),1)])):m("",!0)])]),e("section",Ee,[_.value||!v.value&&!p.value?(o(),s("pre",{key:0,class:te(["text-view",{"text-wrap":y.value}])},i(w.value),3)):v.value?(o(),L(re,{key:1,value:T.value,"expand-depth":2},null,8,["value"])):p.value?(o(),s("div",{key:2,class:"md-container",innerHTML:j.value},null,8,Ie)):m("",!0)])]))])],64)}}}),We=ae(Ne,[["__scopeId","data-v-a782be5c"]]);export{We as default};
