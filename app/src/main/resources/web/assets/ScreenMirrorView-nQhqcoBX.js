import{m as x,c as o,o as a,a as e,d as P,u as j,r as b,g as Y,bN as le,A as D,i as H,bO as ie,as as O,t as r,N as C,O as U,n as p,v as G,k as u,h as A,V as w,C as J,H as re,I as ue,J as de,j as S,bz as ce,bP as ve,aL as me,Y as _e,bQ as pe,bR as fe,bS as he,bT as ge,bU as be,a0 as z}from"./index-Dohfv8Fq.js";const qe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ye(L,i){return a(),o("svg",qe,i[0]||(i[0]=[e("path",{fill:"currentColor",d:"M6 18H4q-.425 0-.712-.288T3 17t.288-.712T4 16h3q.425 0 .713.288T8 17v3q0 .425-.288.713T7 21t-.712-.288T6 20zm12 0v2q0 .425-.288.713T17 21t-.712-.288T16 20v-3q0-.425.288-.712T17 16h3q.425 0 .713.288T21 17t-.288.713T20 18zM6 6V4q0-.425.288-.712T7 3t.713.288T8 4v3q0 .425-.288.713T7 8H4q-.425 0-.712-.288T3 7t.288-.712T4 6zm12 0h2q.425 0 .713.288T21 7t-.288.713T20 8h-3q-.425 0-.712-.288T16 7V4q0-.425.288-.712T17 3t.713.288T18 4z"},null,-1)]))}const Te=x({name:"material-symbols-fullscreen-exit-rounded",render:ye}),$e={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Me(L,i){return a(),o("svg",$e,i[0]||(i[0]=[e("path",{fill:"currentColor",d:"M5 19h2q.425 0 .713.288T8 20t-.288.713T7 21H4q-.425 0-.712-.288T3 20v-3q0-.425.288-.712T4 16t.713.288T5 17zm14 0v-2q0-.425.288-.712T20 16t.713.288T21 17v3q0 .425-.288.713T20 21h-3q-.425 0-.712-.288T16 20t.288-.712T17 19zM5 5v2q0 .425-.288.713T4 8t-.712-.288T3 7V4q0-.425.288-.712T4 3h3q.425 0 .713.288T8 4t-.288.713T7 5zm14 0h-2q-.425 0-.712-.288T16 4t.288-.712T17 3h3q.425 0 .713.288T21 4v3q0 .425-.288.713T20 8t-.712-.288T19 7z"},null,-1)]))}const ke=x({name:"material-symbols-fullscreen-rounded",render:Me}),Se={xmlns:"http://www.w3.org/2000/svg",viewBox:"176.31 -11.19 346.88 581.88"};function we(L,i){return a(),o("svg",Se,i[0]||(i[0]=[e("path",{d:"M470.49 0H229.51a41.9 41.9 0 0 0-29.547 12.277 41.9 41.9 0 0 0-12.277 29.547v476.35a41.9 41.9 0 0 0 12.277 29.547 41.9 41.9 0 0 0 29.547 12.277h240.98a41.9 41.9 0 0 0 29.547-12.277 41.9 41.9 0 0 0 12.277-29.547V41.824a41.9 41.9 0 0 0-12.277-29.547A41.9 41.9 0 0 0 470.49 0m33.25 518.18a33.33 33.33 0 0 1-9.766 23.484 33.34 33.34 0 0 1-23.484 9.766H229.51a33.33 33.33 0 0 1-23.484-9.766 33.34 33.34 0 0 1-9.765-23.484V41.83a33.33 33.33 0 0 1 9.828-23.371 33.32 33.32 0 0 1 23.422-9.703h240.98a33.33 33.33 0 0 1 23.484 9.765 33.34 33.34 0 0 1 9.765 23.484z"},null,-1),e("path",{d:"M317.62 46.812h64.75c2.418 0 4.375-1.957 4.375-4.375s-1.957-4.375-4.375-4.375h-64.75c-2.418 0-4.375 1.957-4.375 4.375s1.957 4.375 4.375 4.375M364.7 192.5a16.8 16.8 0 0 0-14.7-8.75 16.8 16.8 0 0 0-14.698 8.75l-91 157.5a16.45 16.45 0 0 0 0 16.977 16.6 16.6 0 0 0 6.101 6.386 16.65 16.65 0 0 0 8.512 2.364h182.09a16.626 16.626 0 0 0 14.7-8.75 16.8 16.8 0 0 0 0-16.977zm83.562 170.36a8.22 8.22 0 0 1-7.262 4.2H258.91a8.23 8.23 0 0 1-7.176-4.2 8.75 8.75 0 0 1 0-8.75l91-157.5a8.75 8.75 0 0 1 7.262-4.113 8.76 8.76 0 0 1 7.262 4.199l91 157.5a8.75 8.75 0 0 1 0 8.84z"},null,-1),e("path",{d:"M350 221.55a4.29 4.29 0 0 0-4.29 4.285v66.238a4.375 4.375 0 0 0 8.75 0v-66.238a4.286 4.286 0 0 0-4.46-4.285m0 91.26a4.29 4.29 0 0 0-4.29 4.29v17.061a4.375 4.375 0 0 0 8.75 0V317.1a4.286 4.286 0 0 0-4.46-4.29"},null,-1)]))}const Ce={render:we},Le={slot:"headline"},Qe={slot:"content"},Ie={class:"form-row"},Ve=["data-value","label","selected"],ze={class:"form-row"},De={class:"form-label"},He=["disabled"],Ae=["value"],Be={slot:"headline"},Ne={class:"form-row"},Re={class:"form-label"},Oe=["disabled"],Ue=["value"],Ee={slot:"headline"},Fe={class:"form-row"},Ge={slot:"actions"},xe=["disabled"],Pe={key:0,slot:"icon",indeterminate:""},je=P({__name:"ChangeScreenMirrorQualityModal",setup(L){const{t:i}=j(),m=b(720),d=b(60),v=b("quality_sd"),_=[{id:"quality_ld",data:{resolution:480,quality:50}},{id:"quality_sd",data:{resolution:720,quality:50}},{id:"quality_hd",data:{resolution:1080,quality:50}},{id:"custom"}],f=[10,20,30,40,50,60,70,80,90,100],T=[480,720,1080];Y({handle:(l,c)=>{var s;c?D(i(c),"error"):l&&(m.value=l.screenMirrorQuality.resolution,d.value=l.screenMirrorQuality.quality,v.value=((s=_.find(g=>{var $,V;return(($=g.data)==null?void 0:$.resolution)===m.value&&((V=g.data)==null?void 0:V.quality)===d.value}))==null?void 0:s.id)||"custom")},document:le});function k(l){return l===10?`10 (${i("low_quality")})`:l===60?`60 (${i("high_quality")})`:l===100?`100 (${i("best_quality")})`:l.toString()}function Q(l){const{button:c}=l.detail,s=c.dataset.value;v.value=s;const g=_.find($=>$.id===s);g&&g.data&&(m.value=g.data.resolution,d.value=g.data.quality)}const{mutate:h,loading:I,onDone:B}=H({document:ie});B(()=>{O()});const N=()=>{h({resolution:m.value,quality:d.value})};return(l,c)=>(a(),o("md-dialog",null,[e("div",Le,r(l.$t("change_quality")),1),e("div",Qe,[e("div",Ie,[e("md-outlined-segmented-button-set",{onSegmentedButtonSetSelection:Q},[(a(),o(C,null,U(_,s=>e("md-outlined-segmented-button",{key:s.id,"data-value":s.id,label:l.$t(s.id),selected:v.value===s.id},null,8,Ve)),64))],32)]),e("div",ze,[e("label",De,r(l.$t("compress_quality")),1),p(e("md-outlined-select",{"onUpdate:modelValue":c[0]||(c[0]=s=>d.value=s),class:"flex-2","menu-positioning":"fixed",disabled:v.value!=="custom"},[(a(),o(C,null,U(f,s=>e("md-select-option",{key:s,value:s},[e("div",Be,r(k(s)),1)],8,Ae)),64))],8,He),[[G,d.value,void 0,{number:!0}]])]),e("div",Ne,[e("label",Re,r(l.$t("resolution")),1),p(e("md-outlined-select",{"onUpdate:modelValue":c[1]||(c[1]=s=>m.value=s),class:"flex-2","menu-positioning":"fixed",disabled:v.value!=="custom"},[(a(),o(C,null,U(T,s=>e("md-select-option",{key:s,value:s},[e("div",Ee,r(s)+"p",1)],8,Ue)),64))],8,Oe),[[G,m.value,void 0,{number:!0}]])]),e("div",Fe,r(l.$t("screen_mirror_quality_tips")),1)]),e("div",Ge,[e("md-outlined-button",{value:"cancel",onClick:c[2]||(c[2]=(...s)=>u(O)&&u(O)(...s))},r(l.$t("cancel")),1),e("md-filled-button",{value:"save",disabled:u(I),autofocus:"",onClick:N},[u(I)?(a(),o("md-circular-progress",Pe)):A("",!0),w(" "+r(l.$t("save")),1)],8,xe)])]))}}),Ye=J(je,[["__scopeId","data-v-dbf32d7d"]]),Je={class:"screen-mirror"},We={class:"top-app-bar"},Ke={class:"title"},Xe={class:"actions"},Ze=["disabled"],et={class:"content"},tt={key:0},nt={key:0,class:"request-permission"},st={class:"tap-phone"},ot={class:"text"},at={key:1,class:"request-permission-failed"},lt=P({__name:"ScreenMirrorView",setup(L){let i;const{t:m}=j(),d=b(!1),v=b(0),_=b(!1),f=b(!1),T=b(!1),k=b(),Q=async t=>{d.value=!0,g(t),_.value=!1,v.value=0,clearInterval(i)};let h=!1;const{mutate:I}=H({document:fe}),B=()=>{f.value=!f.value,f.value||E()},N=()=>{_e(Ye)},l=()=>{I(),h=!0},c=t=>{t&&h&&(h=!1,clearInterval(i),R())},s=()=>{const t=k.value;if(!t)return;const n=new Date,M="screenshot-"+[n.getFullYear(),n.getMonth()+1,n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()].join("")+".png";pe(t.toDataURL(),M)};function g(t){const n=k.value;if(!n||f.value&&!T.value)return;T.value=!1;const M=n.getContext("2d"),q=new Image;q.src=URL.createObjectURL(t),q.onload=function(){M&&(n.width=q.width,n.height=q.height,M.drawImage(q,0,0))}}re(()=>{z.on("screen_mirroring",Q),z.on("app_socket_connection_changed",c)}),ue(()=>{z.off("screen_mirroring",Q),z.off("app_socket_connection_changed",c)});const{mutate:$,loading:V,onDone:W,onError:K}=H({document:he}),{loading:X,refetch:E}=Y({handle:(t,n)=>{n?D(m(n),"error"):t.screenMirrorState?(d.value=!0,T.value=!0):(d.value=!1,T.value=!1,R())},options:{fetchPolicy:"no-cache"},document:ge}),Z=()=>{document.getElementsByClassName("screen-mirror")[0].requestFullscreen({navigationUI:"show"})},R=()=>{_.value=!1,f.value=!1,$()},ee=()=>{document.exitFullscreen()};K(t=>{D(m(t.message)),_.value=!0}),W(()=>{v.value=30,i=setInterval(()=>{v.value--,v.value<=0&&(_.value=!0,clearInterval(i))},1e3)});const{mutate:F,loading:te,onDone:ne,onError:se}=H({document:be});return se(t=>{D(m(t.message))}),ne(()=>{_.value=!0,d.value=!1}),(t,n)=>{const M=ce,q=ke,oe=Te,y=de("tooltip");return a(),o("div",Je,[e("div",We,[e("div",Ke,r(t.$t("screen_mirror")),1),e("div",Xe,[d.value?(a(),o(C,{key:0},[p((a(),o("button",{class:"btn-icon",onClick:n[0]||(n[0]=()=>u(E)())},[n[2]||(n[2]=e("md-ripple",null,null,-1)),S(M)])),[[y,t.$t("refresh")]]),p((a(),o("md-outlined-button",{class:"btn-sm",onClick:N},[w(r(t.$t("mirror_quality")),1)])),[[y,t.$t("change_quality")]]),p((a(),o("md-outlined-button",{class:"btn-sm",onClick:s},[w(r(t.$t("screenshot")),1)])),[[y,t.$t("screenshot")]]),p((a(),o("md-outlined-button",{class:"btn-sm",onClick:B},[w(r(t.$t(f.value?"resume":"pause")),1)])),[[y,t.$t(f.value?"resume":"pause")]]),p((a(),o("md-outlined-button",{disabled:u(te),class:"btn-sm btn-stop",onClick:n[1]||(n[1]=(...ae)=>u(F)&&u(F)(...ae))},[w(r(t.$t("stop_mirror")),1)],8,Ze)),[[y,t.$t("stop_mirror")]]),p((a(),o("button",{class:"btn-icon btn-enter-fullscreen",onClick:Z},[n[3]||(n[3]=e("md-ripple",null,null,-1)),S(q)])),[[y,t.$t("fullscreen")]]),p((a(),o("button",{class:"btn-icon btn-exit-fullscreen",onClick:ee},[n[4]||(n[4]=e("md-ripple",null,null,-1)),S(oe)])),[[y,t.$t("exit_fullscreen")]])],64)):u(h)?A("",!0):(a(),o("md-outlined-button",{key:1,class:"btn-sm",onClick:l},r(t.$t("relaunch_app")),1))])]),e("div",et,[u(X)||u(V)||u(h)?(a(),o("div",tt,n[5]||(n[5]=[e("md-circular-progress",{indeterminate:""},null,-1)]))):(a(),o(C,{key:1},[v.value>0&&!u(h)?(a(),o("div",nt,[e("div",st,[S(u(ve))]),e("pre",ot,r(t.$t("screen_mirror_request_permission",{seconds:v.value})),1)])):A("",!0),_.value&&!d.value&&!u(h)?(a(),o("div",at,[S(u(Ce)),e("p",null,r(t.$t("screen_mirror_request_permission_failed")),1),e("md-filled-button",{onClick:R},r(t.$t("try_again")),1)])):A("",!0),p(e("canvas",{ref_key:"canvasRef",ref:k,class:"canvas"},null,512),[[me,d.value]])],64))])])}}}),rt=J(lt,[["__scopeId","data-v-e53f6dbd"]]);export{rt as default};
