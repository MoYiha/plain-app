import{_ as kn}from"./ListItemPhone.vuevuetypescriptsetuptruelang-BKiSOF3f.js";import{_ as bn}from"./more-vert-CsKzTfP1.js";import{e as j,r as L,c as a,o,L as F,k as d,Z as N,M as ie,K as b,G as Fe,z as I,q as c,ak as gt,ah as qe,a as _,t as g,a8 as ht,by as In,j as B,J as le,O as yt,bz as ue,l as s,aH as st,n as K,R as it,H as G,S as lt,d as wn,m as ce,bA as kt,bc as $n,bB as Dn,$ as Te,f as bt,T as It,w as $e,bC as Cn,v as at,y as Tn,bD as Fn,A as qn,B as de,bE as wt,bF as Vn,u as Sn,V as En,s as De,g as Bn,an as Pn,aT as rt,bG as Ln,bH as Un,bI as Mn,bJ as An,aO as Nn,W as Rn,bK as zn,am as dt,i as Hn,aw as On,X as Kn,Y as jn,p as Qn,ap as Gn,aq as Wn,br as Jn,a0 as Xn,a2 as re,bL as ut,bM as Yn,F as se,bN as Zn,bO as xn,bP as eo,bQ as ct,bR as mt,aY as pt,bS as ft,at as Ce,bT as _t,bU as to,a4 as no,a5 as ee,bV as oo}from"./index-C3OaPBr-.js";import{_ as $t,a as so}from"./upload-rounded-yRPCfCzU.js";import{_ as io}from"./FieldId.vuevuetypescriptsetuptruelang-NA_aoEC4.js";import{_ as Dt}from"./VCheckbox-DMcyzZQV.js";import{_ as lo,u as ao,c as ro}from"./key-events-lUV_PekZ.js";import{_ as uo,a as co}from"./search-rounded-DC7YJkOU.js";import{_ as mo}from"./content-paste-rounded-CKjpNVK3.js";const po={class:"actions"},fo={class:"card card-info"},_o={class:"key-value vertical"},vo={class:"key"},go={class:"value"},ho=j({__name:"FileActionButtons",props:{item:{},canPaste:{type:Boolean}},emits:["downloadDir","downloadFile","uploadFiles","uploadDir","deleteItem","duplicateItem","cutItem","copyItem","pasteItem","copyLink","renameItem"],setup(h,{emit:f}){const i=f,$=L(!1),k=L(!1),w=L(!1);function r(n){i("downloadDir",n)}function D(n){i("downloadFile",n)}function U(n){i("uploadFiles",n)}function M(n){i("uploadDir",n)}function C(n){i("deleteItem",n)}function y(n){i("duplicateItem",n)}function V(n){i("cutItem",n)}function z(n){i("copyItem",n)}function e(n){i("pasteItem",n)}function m(n){i("copyLink",n)}function p(n){i("renameItem",n)}return(n,u)=>{const R=gt,P=Fe,v=$t,S=qe,W=ht,J=In,Q=bn,E=ie("tooltip");return o(),a("div",po,[n.item.isDir?(o(),a(N,{key:0},[F((o(),b(P,{class:"sm",onClick:u[0]||(u[0]=I(q=>r(n.item.path),["stop"]))},{default:c(()=>[d(R)]),_:1})),[[E,n.$t("download")]]),d(S,{modelValue:$.value,"onUpdate:modelValue":u[3]||(u[3]=q=>$.value=q)},{trigger:c(()=>[F((o(),b(P,{class:"sm"},{default:c(()=>[d(v)]),_:1})),[[E,n.$t("upload")]])]),default:c(()=>[_("div",{class:"dropdown-item",onClick:u[1]||(u[1]=I(q=>{U(n.item.path),$.value=!1},["stop"]))},g(n.$t("upload_files")),1),_("div",{class:"dropdown-item",onClick:u[2]||(u[2]=I(q=>{M(n.item.path),$.value=!1},["stop"]))},g(n.$t("upload_folder")),1)]),_:1},8,["modelValue"])],64)):F((o(),b(P,{key:1,class:"sm",onClick:u[4]||(u[4]=I(q=>D(n.item.path),["stop"]))},{default:c(()=>[d(R)]),_:1})),[[E,n.$t("download")]]),F((o(),b(P,{class:"sm",onClick:u[5]||(u[5]=I(q=>C(n.item),["stop"]))},{default:c(()=>[d(W)]),_:1})),[[E,n.$t("delete")]]),d(S,{modelValue:k.value,"onUpdate:modelValue":u[6]||(u[6]=q=>k.value=q)},{trigger:c(()=>[F((o(),b(P,{class:"sm"},{default:c(()=>[d(J)]),_:1})),[[E,n.$t("info")]])]),default:c(()=>[_("section",fo,[_("div",_o,[_("div",vo,g(n.$t("path")),1),_("div",go,g(n.item.path),1)])])]),_:1},8,["modelValue"]),d(S,{modelValue:w.value,"onUpdate:modelValue":u[13]||(u[13]=q=>w.value=q)},{trigger:c(()=>[F((o(),b(P,{class:"sm"},{default:c(()=>[d(Q)]),_:1})),[[E,n.$t("actions")]])]),default:c(()=>[_("div",{class:"dropdown-item",onClick:u[7]||(u[7]=I(q=>{y(n.item),w.value=!1},["stop"]))},g(n.$t("duplicate")),1),_("div",{class:"dropdown-item",onClick:u[8]||(u[8]=I(q=>{V(n.item),w.value=!1},["stop"]))},g(n.$t("cut")),1),_("div",{class:"dropdown-item",onClick:u[9]||(u[9]=I(q=>{z(n.item),w.value=!1},["stop"]))},g(n.$t("copy")),1),n.item.isDir&&n.canPaste?(o(),a("div",{key:0,class:"dropdown-item",onClick:u[10]||(u[10]=I(q=>{e(n.item),w.value=!1},["stop"]))},g(n.$t("paste")),1)):B("",!0),n.item.isDir?B("",!0):(o(),a("div",{key:1,class:"dropdown-item",onClick:u[11]||(u[11]=I(q=>{m(n.item),w.value=!1},["stop"]))},g(n.$t("copy_link")),1)),_("div",{class:"dropdown-item",onClick:u[12]||(u[12]=I(q=>{p(n.item),w.value=!1},["stop"]))},g(n.$t("rename")),1)]),_:1},8,["modelValue"])])}}}),yo=le(ho,[["__scopeId","data-v-d607a5ac"]]),ko={class:"start"},bo={class:"number"},Io={key:0,src:"/ficons/folder.svg",class:"svg"},wo={key:0,class:"svg",src:ue},$o=["src"],Do=["src"],Co={key:3,class:"svg",src:ue},To={class:"title"},Fo={class:"subtitle"},qo={key:0},Vo={key:1},So={key:0,src:"/ficons/folder.svg",class:"svg"},Eo={key:0,class:"svg",src:ue},Bo=["src"],Po=["src"],Lo={key:3,class:"svg",src:ue},Uo={key:0},Mo={key:1},Ao=j({__name:"FileListItem",props:{item:{},index:{},selectedIds:{},shiftEffectingIds:{},shouldSelect:{type:Boolean},isPhone:{type:Boolean},imageErrorIds:{},extensionImageErrorIds:{},canPaste:{type:Boolean},handleItemClick:{type:Function},handleMouseOver:{type:Function},toggleSelect:{type:Function},onImageError:{type:Function},onExtensionImageError:{type:Function},viewItem:{type:Function},clickItem:{type:Function}},emits:["downloadDir","downloadFile","uploadFiles","uploadDir","deleteItem","duplicateItem","cutItem","copyItem","pasteItem","copyLink","renameItem"],setup(h,{emit:f}){const i=f;function $(e){i("downloadDir",e)}function k(e){i("downloadFile",e)}function w(e){i("uploadFiles",e)}function r(e){i("uploadDir",e)}function D(e){i("deleteItem",e)}function U(e){i("duplicateItem",e)}function M(e){i("cutItem",e)}function C(e){i("copyItem",e)}function y(e){i("pasteItem",e)}function V(e){i("copyLink",e)}function z(e){i("renameItem",e)}return(e,m)=>{const p=Dt,n=io,u=yo,R=kn,P=ie("tooltip");return e.isPhone?(o(),b(R,{key:1,"is-selected":e.selectedIds.includes(e.item.id),"is-selecting":e.shiftEffectingIds.includes(e.item.id),"checkbox-checked":e.shiftEffectingIds.includes(e.item.id)?e.shouldSelect:e.selectedIds.includes(e.item.id),onClick:m[10]||(m[10]=v=>e.handleItemClick(v,e.item,e.index,()=>e.clickItem(e.item))),onMouseover:m[11]||(m[11]=v=>e.handleMouseOver(v,e.index)),onCheckboxClick:m[12]||(m[12]=v=>e.toggleSelect(v,e.item,e.index))},{image:c(()=>[_("div",{class:"image",onClick:m[9]||(m[9]=v=>e.viewItem(v,e.item))},[e.item.isDir?(o(),a("img",So)):(o(),a(N,{key:1},[e.extensionImageErrorIds.includes(e.item.id)?(o(),a("img",Eo)):!e.imageErrorIds.includes(e.item.id)&&e.item.fileId?(o(),a("img",{key:1,class:"image-thumb",src:s(st)(e.item.fileId,"&w=50&h=50"),onError:m[7]||(m[7]=v=>e.onImageError(e.item.id))},null,40,Bo)):e.item.extension?(o(),a("img",{key:2,src:`/ficons/${e.item.extension}.svg`,class:"svg",onError:m[8]||(m[8]=v=>e.onExtensionImageError(e.item.id))},null,40,Po)):(o(),a("img",Lo))],64))])]),title:c(()=>[G(g(e.item.name),1)]),subtitle:c(()=>[e.item.isDir?(o(),a("span",Uo,g(e.$t("x_items",e.item.children||0)),1)):(o(),a("span",Mo,g(s(K)(e.item.size)),1)),F((o(),a("span",null,[G(g(s(lt)(e.item.updatedAt)),1)])),[[P,s(it)(e.item.updatedAt)]])]),actions:c(()=>[d(u,{item:e.item,"can-paste":e.canPaste,onDownloadDir:$,onDownloadFile:k,onUploadFiles:w,onUploadDir:r,onDeleteItem:D,onDuplicateItem:U,onCutItem:M,onCopyItem:C,onPasteItem:y,onCopyLink:V,onRenameItem:z},null,8,["item","can-paste"])]),_:1},8,["is-selected","is-selecting","checkbox-checked"])):(o(),a("section",{key:0,class:yt(["file-item selectable-card",{selected:e.selectedIds.includes(e.item.id),selecting:e.shiftEffectingIds.includes(e.item.id)}]),onClick:m[5]||(m[5]=I(v=>e.handleItemClick(v,e.item,e.index,()=>e.clickItem(e.item)),["stop"])),onMouseover:m[6]||(m[6]=v=>e.handleMouseOver(v,e.index))},[_("div",ko,[e.shiftEffectingIds.includes(e.item.id)?(o(),b(p,{key:0,class:"checkbox","touch-target":"wrapper",checked:e.shouldSelect,onClick:m[0]||(m[0]=I(v=>e.toggleSelect(v,e.item,e.index),["stop"]))},null,8,["checked"])):(o(),b(p,{key:1,class:"checkbox","touch-target":"wrapper",checked:e.selectedIds.includes(e.item.id),onClick:m[1]||(m[1]=I(v=>e.toggleSelect(v,e.item,e.index),["stop"]))},null,8,["checked"])),_("span",bo,[d(n,{id:e.index+1,raw:e.item},null,8,["id","raw"])])]),_("div",{class:"image",onClick:m[4]||(m[4]=v=>e.viewItem(v,e.item))},[e.item.isDir?(o(),a("img",Io)):(o(),a(N,{key:1},[e.extensionImageErrorIds.includes(e.item.id)?(o(),a("img",wo)):!e.imageErrorIds.includes(e.item.id)&&e.item.fileId?(o(),a("img",{key:1,class:"image-thumb",src:s(st)(e.item.fileId,"&w=50&h=50"),onError:m[2]||(m[2]=v=>e.onImageError(e.item.id))},null,40,$o)):e.item.extension?(o(),a("img",{key:2,src:`/ficons/${e.item.extension}.svg`,class:"svg",onError:m[3]||(m[3]=v=>e.onExtensionImageError(e.item.id))},null,40,Do)):(o(),a("img",Co))],64))]),_("div",To,g(e.item.name),1),_("div",Fo,[e.item.isDir?(o(),a("span",qo,g(e.$t("x_items",e.item.children||0)),1)):(o(),a("span",Vo,g(s(K)(e.item.size)),1)),F((o(),a("span",null,[G(g(s(lt)(e.item.updatedAt)),1)])),[[P,s(it)(e.item.updatedAt)]])]),d(u,{item:e.item,"can-paste":e.canPaste,onDownloadDir:$,onDownloadFile:k,onUploadFiles:w,onUploadDir:r,onDeleteItem:D,onDuplicateItem:U,onCutItem:M,onCopyItem:C,onPasteItem:y,onCopyLink:V,onRenameItem:z},null,8,["item","can-paste"])],34))}}}),No=le(Ao,[["__scopeId","data-v-9b354140"]]),Ro={key:0,class:"file-item selectable-card-skeleton"},zo={class:"start"},Ho={class:"number"},Oo=j({__name:"FileSkeletonItem",props:{index:{},isPhone:{type:Boolean}},setup(h){return(f,i)=>{const $=lo;return f.isPhone?(o(),b($,{key:1,"title-width":"60%",subtitles:[{width:"45%"},{width:"40%"}],"action-count":5})):(o(),a("section",Ro,[_("div",zo,[i[0]||(i[0]=_("div",{class:"skeleton-checkbox"},null,-1)),_("span",Ho,g(f.index),1)]),i[1]||(i[1]=wn('<div class="image" data-v-037471a7><div class="skeleton-image lg" data-v-037471a7></div></div><div class="title" data-v-037471a7><div class="skeleton-text lg" style="width:40%;" data-v-037471a7></div></div><div class="subtitle" data-v-037471a7><div class="skeleton-text" style="width:30%;" data-v-037471a7></div></div><div class="actions" data-v-037471a7><div class="skeleton-text lg" style="width:240px;" data-v-037471a7></div></div>',4))]))}}}),Ko=le(Oo,[["__scopeId","data-v-037471a7"]]),jo={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Qo(h,f){return o(),a("svg",jo,f[0]||(f[0]=[_("path",{fill:"currentColor",d:"M19.075 21.9L17.5 20.35q-1.225.8-2.613 1.225T12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12q0-1.5.425-2.887T3.65 6.5L2.075 4.925q-.3-.3-.3-.712t.3-.713t.713-.3t.712.3l17 17q.3.3.3.7t-.3.7t-.712.3t-.713-.3M12 20q1.075 0 2.088-.275t1.962-.825L5.1 7.95q-.55.95-.825 1.962T4 12q0 3.325 2.338 5.663T12 20m0-16q-.825 0-1.612.163T8.85 4.65q-.4.175-.8.05t-.6-.475t-.088-.75t.488-.575q.975-.45 2.012-.675T12 2q2.075 0 3.9.788t3.175 2.137T21.213 8.1T22 12q0 1.1-.225 2.138T21.1 16.15q-.175.375-.575.488t-.75-.088t-.475-.6t.05-.8q.325-.75.488-1.537T20 12q0-3.325-2.337-5.663T12 4m-1.425 9.425"},null,-1)]))}const Go=ce({name:"material-symbols-hide-source-outline-rounded",render:Qo}),Ct=j({__name:"FileSearchFilters",props:{filter:{type:Object,required:!0}},emits:["filterChange"],setup(h,{emit:f}){const i=h,$=f;function k(){const r={...i.filter};r.text="",$("filterChange",r)}function w(){const r={...i.filter};r.showHidden=!1,$("filterChange",r)}return(r,D)=>{const U=uo,M=Go,C=kt;return h.filter.text||h.filter.showHidden?(o(),b(C,{key:0},{default:c(()=>[h.filter.text?(o(),b(U,{key:"filter-text",label:h.filter.text,"remove-only":"",onRemove:k},null,8,["label"])):B("",!0),h.filter.showHidden?(o(),b(U,{key:"filter-show-hidden",label:r.$t("show_hidden"),"remove-only":"",onRemove:w},{default:c(()=>[d(M)]),_:1},8,["label"])):B("",!0)]),_:1})):B("",!0)}}}),Wo={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Jo(h,f){return o(),a("svg",Wo,f[0]||(f[0]=[_("path",{fill:"currentColor",d:"M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h5.175q.4 0 .763.15t.637.425L12 6h8q.825 0 1.413.588T22 8v10q0 .825-.587 1.413T20 20zm0-2h16V8h-8.825l-2-2H4zm0 0V6zm10-4v1q0 .425.288.713T15 16t.713-.288T16 15v-1h1q.425 0 .713-.288T18 13t-.288-.712T17 12h-1v-1q0-.425-.288-.712T15 10t-.712.288T14 11v1h-1q-.425 0-.712.288T12 13t.288.713T13 14z"},null,-1)]))}const Xo=ce({name:"material-symbols-create-new-folder-outline-rounded",render:Jo}),Yo=j({__name:"FilesKeyboardShortcuts",setup(h){const f=[{keys:["Delete"],description:"delete_selected"},{keys:["modifier","+","Backspace"],description:"delete_selected"},{keys:["modifier","+","A"],description:"select_all"},{keys:["Esc"],description:"clear_selection"},{keys:["Shift","+","Click"],description:"range_select"}];return(i,$)=>{const k=$n;return o(),b(k,{shortcuts:f})}}}),Zo=["onClick"],xo=j({__name:"FilesActionButtons",props:{currentDir:{type:String,required:!0},canPaste:{type:Boolean,required:!0},pasting:{type:Boolean,required:!0},refreshing:{type:Boolean,required:!0},sorting:{type:Boolean,required:!0},sortItems:{type:Array,required:!0},fileSortBy:{type:String,required:!0}},emits:["createDir","uploadFiles","uploadDir","pasteDir","refreshCurrentDir","sort"],setup(h,{emit:f}){const i=f,$=L(!1),k=L(!1);function w(){i("createDir")}function r(y){i("uploadFiles",y)}function D(y){i("uploadDir",y)}function U(){i("pasteDir")}function M(){i("refreshCurrentDir")}function C(y){i("sort",y)}return(y,V)=>{const z=Yo,e=Xo,m=Fe,p=$t,n=qe,u=mo,R=Dn,P=so,v=ie("tooltip");return o(),a(N,null,[d(z),F((o(),b(m,{onClick:w},{default:c(()=>[d(e)]),_:1})),[[v,y.$t("create_folder")]]),d(n,{modelValue:$.value,"onUpdate:modelValue":V[2]||(V[2]=S=>$.value=S)},{trigger:c(()=>[F((o(),b(m,null,{default:c(()=>[d(p)]),_:1})),[[v,y.$t("upload")]])]),default:c(()=>[_("div",{class:"dropdown-item",onClick:V[0]||(V[0]=I(S=>{r(h.currentDir),$.value=!1},["stop"]))},g(y.$t("upload_files")),1),_("div",{class:"dropdown-item",onClick:V[1]||(V[1]=I(S=>{D(h.currentDir),$.value=!1},["stop"]))},g(y.$t("upload_folder")),1)]),_:1},8,["modelValue"]),h.canPaste?F((o(),b(m,{key:0,loading:h.pasting,onClick:U},{default:c(()=>[d(u)]),_:1},8,["loading"])),[[v,y.$t("paste")]]):B("",!0),F((o(),b(m,{loading:h.refreshing,onClick:M},{default:c(()=>[d(R)]),_:1},8,["loading"])),[[v,y.$t("refresh")]]),d(n,{modelValue:k.value,"onUpdate:modelValue":V[3]||(V[3]=S=>k.value=S)},{trigger:c(()=>[F((o(),b(m,{loading:h.sorting},{default:c(()=>[d(P)]),_:1},8,["loading"])),[[v,y.$t("sort")]])]),default:c(()=>[(o(!0),a(N,null,Te(h.sortItems,S=>(o(),a("div",{key:S.value,class:yt(["dropdown-item",{selected:S.value===h.fileSortBy}]),onClick:W=>{C(S.value),k.value=!1}},g(y.$t(S.label)),11,Zo))),128))]),_:1},8,["modelValue"])],64)}}}),es={class:"btn-icon"},ts={class:"filters"},ns={class:"form-row"},os={class:"buttons"},ss={class:"form-label"},is=j({__name:"FileSearchInput",props:{parent:{type:String,required:!0},filter:{type:Object,required:!0},getUrl:{type:Function,required:!0},navigateToDir:{type:Function,required:!1},showChips:{type:Boolean,default:!0},isPhone:{type:Boolean,default:!1}},setup(h,{expose:f}){const{buildQ:i}=wt(),$=bt(),k=h,w=L(!1),r=L(!1),D=It({showHidden:!1,linkName:"",text:"",parent:""});$e(k.filter,p=>{Object.assign(D,p)},{immediate:!0,deep:!0}),$e(w,p=>{p&&Object.assign(D,k.filter)}),$e(r,p=>{p&&Object.assign(D,k.filter)});function U(p){return p.startsWith("/")}function M(){var n;const p=(n=D.text)==null?void 0:n.trim();if(p&&U(p)&&k.navigateToDir){k.navigateToDir(p),w.value=!1;return}V(),w.value=!1}function C(){r.value=!0}function y(){var n;const p=(n=D.text)==null?void 0:n.trim();if(p&&U(p)&&k.navigateToDir){k.navigateToDir(p),r.value=!1;return}V(),r.value=!1}function V(){Object.assign(k.filter,D),z(k.filter)}function z(p){de($,k.getUrl(i(p)))}function e(){D.showHidden=!D.showHidden}function m(p){Object.assign(k.filter,p),de($,k.getUrl(i(k.filter)))}return f({dismiss:()=>{w.value=!1,r.value=!1}}),(p,n)=>{const u=co,R=Tn,P=Fn,v=kt,S=qn,W=qe,J=Cn,Q=ie("tooltip");return o(),a(N,null,[h.showChips?(o(),b(Ct,{key:0,filter:h.filter,onFilterChange:m},null,8,["filter"])):B("",!0),h.isPhone?B("",!0):(o(),b(W,{key:1,modelValue:w.value,"onUpdate:modelValue":n[1]||(n[1]=E=>w.value=E),"max-height":400},{trigger:c(()=>[F((o(),a("button",es,[d(u)])),[[Q,p.$t("search")]])]),default:c(()=>[_("div",ts,[_("div",ns,[d(R,{modelValue:D.text,"onUpdate:modelValue":n[0]||(n[0]=E=>D.text=E),label:p.$t("keywords"),onKeyup:at(M,["enter"])},null,8,["modelValue","label"])]),d(v,null,{default:c(()=>[d(P,{key:"chip-show-hidden",label:p.$t("show_hidden"),selected:D.showHidden,onClick:e},null,8,["label","selected"])]),_:1}),_("div",os,[d(S,{onClick:I(M,["stop"])},{default:c(()=>[G(g(p.$t("search")),1)]),_:1})])])]),_:1},8,["modelValue"])),h.isPhone?F((o(),a("button",{key:2,class:"btn-icon mobile-search-btn",onClick:C},[d(u)])),[[Q,p.$t("search")]]):B("",!0),h.isPhone?(o(),b(J,{key:3,modelValue:r.value,"onUpdate:modelValue":n[3]||(n[3]=E=>r.value=E),title:p.$t("search"),"show-footer":""},{footer:c(()=>[d(S,{class:"search-apply-btn",onClick:y},{default:c(()=>[G(g(p.$t("search")),1)]),_:1})]),default:c(()=>[_("label",ss,g(p.$t("keywords")),1),d(R,{modelValue:D.text,"onUpdate:modelValue":n[2]||(n[2]=E=>D.text=E),onKeyup:at(y,["enter"])},null,8,["modelValue"]),d(v,{style:{"margin-block-start":"16px"}},{default:c(()=>[d(P,{label:p.$t("show_hidden"),selected:D.showHidden,onClick:e},null,8,["label","selected"])]),_:1})]),_:1},8,["modelValue","title"])):B("",!0)],64)}}}),ls=le(is,[["__scopeId","data-v-dbf3b297"]]),as={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function rs(h,f){return o(),a("svg",as,f[0]||(f[0]=[_("path",{fill:"currentColor",d:"m12 14l-2.35 2.35q.2.375.275.8T10 18q0 1.65-1.175 2.825T6 22t-2.825-1.175T2 18t1.175-2.825T6 14q.425 0 .85.075t.8.275L10 12L7.65 9.65q-.375.2-.8.275T6 10q-1.65 0-2.825-1.175T2 6t1.175-2.825T6 2t2.825 1.175T10 6q0 .425-.075.85t-.275.8L20.6 18.6q.675.675.3 1.538T19.575 21q-.275 0-.537-.112t-.463-.313zm3-3l-2-2l5.575-5.575q.2-.2.463-.312T19.574 3q.95 0 1.313.875t-.313 1.55zM6 8q.825 0 1.413-.587T8 6t-.587-1.412T6 4t-1.412.588T4 6t.588 1.413T6 8m6 4.5q.2 0 .35-.15t.15-.35t-.15-.35t-.35-.15t-.35.15t-.15.35t.15.35t.35.15M6 20q.825 0 1.413-.587T8 18t-.587-1.412T6 16t-1.412.588T4 18t.588 1.413T6 20"},null,-1)]))}const ds=ce({name:"material-symbols-content-cut-rounded",render:rs}),us={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function cs(h,f){return o(),a("svg",us,f[0]||(f[0]=[_("path",{fill:"currentColor",d:"M9 18q-.825 0-1.412-.587T7 16V4q0-.825.588-1.412T9 2h9q.825 0 1.413.588T20 4v12q0 .825-.587 1.413T18 18zm0-2h9V4H9zm-4 6q-.825 0-1.412-.587T3 20V7q0-.425.288-.712T4 6t.713.288T5 7v13h10q.425 0 .713.288T16 21t-.288.713T15 22zm4-6V4z"},null,-1)]))}const ms=ce({name:"material-symbols-content-copy-outline-rounded",render:cs}),ps=Vn("files",{state:()=>({selectedFiles:[],isCut:!1})}),fs={class:"top-app-bar"},_s={class:"title"},vs={key:0},gs={key:1,class:"breadcrumb"},hs={key:0},ys=["onClick"],ks={key:0},bs=["onClick"],Is={key:0,class:"actions"},ws={key:0,class:"secondary-actions"},$s={key:2,class:"scroller-wrapper"},Ds={class:"scroller main-list"},Cs={key:1,class:"no-data-placeholder"},vt=1e4,Ts=j({__name:"FilesView",setup(h){var tt;const f=Qn("isPhone"),{t:i}=Sn(),$=L([]),{parseQ:k,buildQ:w}=wt(),r=It({linkName:"",showHidden:!1,text:"",parent:""}),U=En().query,M=L(""),C=L([]),{selectedIds:y,allChecked:V,realAllChecked:z,clearSelection:e,toggleAllChecked:m,toggleSelect:p,total:n,checked:u,shiftEffectingIds:R,handleItemClick:P,handleMouseOver:v,selectAll:S,shouldSelect:W}=ao(C),{keyDown:J,keyUp:Q}=ro(S,e,()=>{je()}),E=L(!1),q=L(!1),Ve=L([]),Se=L([]),Tt=t=>{Ve.value.push(t)},Ft=t=>{Se.value.push(t)},Ee=Gn(),me=bt(),{fileSortBy:te}=De(me),Be=Bn(),{app:Pe,urlTokenKey:H,uploads:pe}=De(Be),{selectedFiles:qt,isCut:Vt}=De(ps()),{dropping:St,fileDragEnter:Le,fileDragLeave:Ue,dropFiles:Et}=Pn(pe),ne=rt(()=>Ln(r.linkName,Pe.value)),{createPath:Bt,createVariables:Pt,createMutation:Lt}=Un(H,C),{renameItem:Ut,renameDone:Mt,renameMutation:At,renameVariables:Nt}=Mn(()=>{X()}),{internal:Me,sdcard:Ae,usb:Rt,refetch:fe}=An(),{downloadFile:_e,downloadDir:zt,downloadFiles:Ht}=On(H),{view:Ne}=to($,(t,l)=>{Be.lightbox={sources:t,index:l,visible:!0}}),Ot=L(parseInt(((tt=U.page)==null?void 0:tt.toString())??"1")),Kt=rt(()=>{const t=[];let l=r.parent;for(;l&&l!==ne.value;)t.unshift({path:l,name:Nn(l)}),l=l.substring(0,l.lastIndexOf("/"));return t.unshift({path:ne.value,name:xt()}),t}),Re=L(!0),{loading:ve,fetch:X}=Rn({handle:async(t,l)=>{if(Re.value=!1,E.value=!1,q.value=!1,l)se(i(l),"error");else{const A=[];for(const Y of t.files)A.push(Zn(Y,H.value));C.value=A,n.value=A.length}},document:Yn,variables:()=>({root:ne.value,offset:(Ot.value-1)*vt,limit:vt,query:M.value,sortBy:te.value}),options:{fetchPolicy:"cache-and-network"}}),{loading:ze,canPaste:ge,copy:he,cut:He,paste:ye}=zn(C,Vt,qt,X,fe),{input:jt,upload:Qt,uploadChanged:Oe}=dt(pe),{input:Gt,upload:Wt,uploadChanged:Ke}=dt(pe),{loading:Jt,mutate:Xt,onDone:Yt}=Hn({document:xn});Yt(t=>{Ht(t.data.setTempValue.key),e()});const Zt=()=>{Xt({key:eo(),value:JSON.stringify(y.value.map(t=>({path:t})))})},ke=t=>{t.forEach(l=>{oo(C.value,A=>A.id===l.id)}),n.value=C.value.length,e(),fe()},je=()=>{re(ct,{files:C.value.filter(t=>y.value.includes(t.id)),onDone:t=>{ke(t)}})};function xt(){if(r.linkName==="sdcard")return i("sdcard");if(r.linkName==="app")return i("app_data");if(r.linkName.startsWith("usb")){const t=parseInt(r.linkName.substring(3));return`${i("usb_storage")} ${t}`}return i("internal_storage")}function Qe(){var t,l,A,Y;if(r.linkName==="sdcard")return`${i("storage_free_total",{free:K(((t=Ae.value)==null?void 0:t.freeBytes)??0),total:K(((l=Ae.value)==null?void 0:l.totalBytes)??0)})}`;if(r.linkName==="app")return i("app_data");if(r.linkName.startsWith("usb")){const Z=parseInt(r.linkName.substring(3)),O=Rt.value[Z-1];return`${i("storage_free_total",{free:K((O==null?void 0:O.freeBytes)??0),total:K((O==null?void 0:O.totalBytes)??0)})}`}return`${K(((A=Me.value)==null?void 0:A.freeBytes)??0)} / ${K(((Y=Me.value)==null?void 0:Y.totalBytes)??0,!0,0)}`}function oe(t){e(),r.parent=t,r.text="";const l=w(r);de(me,ae(l))}function ae(t){return t?`/files?q=${t}`:"/files"}function en(t){if(t.isDir){oe(t.path);return}if(mt(t.name)){const l=pt(H.value,t.path);window.open(`/text-file?id=${encodeURIComponent(l)}`,"_blank")}else ft(t.name)?window.open(Ce(H.value,t.path),"_blank"):_t(t.name)?Ne(C.value,t):_e(t.path)}function tn(t,l){if(!l.isDir)if(t.stopPropagation(),mt(l.name)){const A=pt(H.value,l.path);window.open(`/text-file?id=${encodeURIComponent(A)}`,"_blank")}else ft(l.name)?window.open(Ce(H.value,l.path),"_blank"):_t(l.name)?Ne(C.value,l):_e(l.path)}function Ge(t){te.value!==t&&(q.value=!0,te.value=t)}function We(){E.value=!0,X()}const Je=()=>{Bt.value=r.parent,re(ut,{title:i("create_folder"),placeholder:i("name"),mutation:Lt,getVariables:Pt})};function be(t){Qt(t)}function Ie(t){Wt(t)}function nn(){he(y.value),e()}function on(){He(y.value),e()}function Xe(){ye(r.parent)}function sn(t){he([t.id]),ye(r.parent)}function ln(t){He([t.id])}function an(t){he([t.id])}function rn(t){const l=Ce(H.value,t.path);navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(l).then(()=>{se(i("link_copied"),"success")}).catch(()=>{Ye(l)}):Ye(l)}function Ye(t){try{const l=document.createElement("textarea");l.value=t,l.style.position="fixed",l.style.left="-999999px",l.style.top="-999999px",document.body.appendChild(l),l.focus(),l.select();const A=document.execCommand("copy");document.body.removeChild(l),A?se(i("link_copied"),"success"):se(i("copy_failed"),"error")}catch(l){console.error("Failed to copy text: ",l),se(i("copy_failed"),"error")}}function dn(t){ye(t.path)}function un(t){Ut.value=t,re(ut,{title:i("rename"),placeholder:i("name"),value:t.name,mutation:At,getVariables:Nt,done:Mt})}function cn(t){re(ct,{files:[t],onDone:ke})}function mn(t){Object.assign(r,t);const l=w(r);de(me,ae(l))}const Ze=t=>{t.status==="done"&&setTimeout(()=>{X(),fe()},1e3)},xe=t=>{ke([t.item])},et=t=>{X()};function pn(t){Et(t,r.parent,()=>!0)}return Kn(()=>{var t;M.value=no(((t=U.q)==null?void 0:t.toString())??""),k(r,M.value),X(),ee.on("upload_task_done",Ze),ee.on("file_deleted",xe),ee.on("file_renamed",et),window.addEventListener("keydown",J),window.addEventListener("keyup",Q)}),jn(()=>{ee.off("upload_task_done",Ze),ee.off("file_deleted",xe),ee.off("file_renamed",et),window.removeEventListener("keydown",J),window.removeEventListener("keyup",Q)}),(t,l)=>{const A=Dt,Y=ms,Z=Fe,O=ds,fn=ht,_n=gt,nt=ls,ot=xo,vn=Ct,gn=Ko,hn=No,x=ie("tooltip");return o(),a(N,null,[_("div",fs,[d(A,{"touch-target":"wrapper",checked:s(V),indeterminate:!s(V)&&s(u),onChange:s(m)},null,8,["checked","indeterminate","onChange"]),_("div",_s,[s(y).length?(o(),a("span",vs,g(t.$t("x_selected",{count:s(z)?s(n).toLocaleString():s(y).length.toLocaleString()})),1)):(o(),a("div",gs,[(o(!0),a(N,null,Te(Kt.value,(T,we)=>(o(),a(N,{key:T.path},[we===0?(o(),a(N,{key:0},[T.path===r.parent?F((o(),a("span",hs,[G(g(T.name)+" ("+g(s(n))+")",1)])),[[x,Qe()]]):F((o(),a("a",{key:1,href:"#",onClick:I(yn=>oe(T.path),["stop","prevent"])},[G(g(T.name),1)],8,ys)),[[x,Qe()]])],64)):(o(),a(N,{key:1},[T.path===r.parent?(o(),a("span",ks,g(T.name)+" ("+g(s(n))+")",1)):(o(),a("a",{key:1,href:"#",onClick:I(yn=>oe(T.path),["stop","prevent"])},g(T.name),9,bs))],64))],64))),128))])),s(u)?(o(),a(N,{key:2},[F((o(),b(Z,{onClick:I(nn,["stop"])},{default:c(()=>[d(Y)]),_:1})),[[x,t.$t("copy")]]),F((o(),b(Z,{onClick:I(on,["stop"])},{default:c(()=>[d(O)]),_:1})),[[x,t.$t("cut")]]),F((o(),b(Z,{onClick:I(je,["stop"])},{default:c(()=>[d(fn)]),_:1})),[[x,t.$t("delete")]]),F((o(),b(Z,{loading:s(Jt),onClick:I(Zt,["stop"])},{default:c(()=>[d(_n)]),_:1},8,["loading"])),[[x,t.$t("download")]])],64)):B("",!0)]),!s(f)&&!s(u)?(o(),a("div",Is,[d(nt,{filter:r,parent:ne.value,"get-url":ae,"navigate-to-dir":oe,"show-chips":!s(f),"is-phone":s(f)},null,8,["filter","parent","show-chips","is-phone"]),d(ot,{"current-dir":r.parent,"can-paste":s(ge)(),pasting:s(ze),refreshing:E.value,sorting:q.value,"sort-items":s(Ee),"file-sort-by":s(te),onCreateDir:Je,onUploadFiles:be,onUploadDir:Ie,onPasteDir:Xe,onRefreshCurrentDir:We,onSort:Ge},null,8,["current-dir","can-paste","pasting","refreshing","sorting","sort-items","file-sort-by"])])):B("",!0)]),s(f)&&!s(u)?(o(),a("div",ws,[d(nt,{filter:r,parent:ne.value,"get-url":ae,"navigate-to-dir":oe,"show-chips":!s(f),"is-phone":s(f)},null,8,["filter","parent","show-chips","is-phone"]),d(ot,{"current-dir":r.parent,"can-paste":s(ge)(),pasting:s(ze),refreshing:E.value,sorting:q.value,"sort-items":s(Ee),"file-sort-by":s(te),onCreateDir:Je,onUploadFiles:be,onUploadDir:Ie,onPasteDir:Xe,onRefreshCurrentDir:We,onSort:Ge},null,8,["current-dir","can-paste","pasting","refreshing","sorting","sort-items","file-sort-by"])])):B("",!0),s(f)?(o(),b(vn,{key:1,class:"mobile-search-filters",filter:r,onFilterChange:mn},null,8,["filter"])):B("",!0),s(ve)&&Re.value?(o(),a("div",$s,[_("div",Ds,[(o(),a(N,null,Te(20,T=>d(gn,{key:T,index:T,"is-phone":s(f)},null,8,["index","is-phone"])),64))])])):B("",!0),_("div",{class:"scroller-wrapper",onDragover:l[3]||(l[3]=I((...T)=>s(Le)&&s(Le)(...T),["stop","prevent"]))},[F(_("div",{class:"drag-mask",onDrop:I(pn,["stop","prevent"]),onDragleave:l[0]||(l[0]=I((...T)=>s(Ue)&&s(Ue)(...T),["stop","prevent"]))},g(t.$t("release_to_send_files")),545),[[Wn,s(St)]]),C.value.length>0?(o(),b(s(Jn),{key:0,class:"scroller main-list","data-key":"id","data-sources":C.value,"estimate-size":80},{item:c(({index:T,item:we})=>[d(hn,{item:we,index:T,"selected-ids":s(y),"shift-effecting-ids":s(R),"should-select":s(W),"is-phone":s(f),"image-error-ids":Ve.value,"extension-image-error-ids":Se.value,"can-paste":s(ge)(),"handle-item-click":s(P),"handle-mouse-over":s(v),"toggle-select":s(p),"on-image-error":Tt,"on-extension-image-error":Ft,"view-item":tn,"click-item":en,onDownloadDir:s(zt),onDownloadFile:s(_e),onUploadFiles:be,onUploadDir:Ie,onDeleteItem:cn,onDuplicateItem:sn,onCutItem:ln,onCopyItem:an,onPasteItem:dn,onCopyLink:rn,onRenameItem:un},null,8,["item","index","selected-ids","shift-effecting-ids","should-select","is-phone","image-error-ids","extension-image-error-ids","can-paste","handle-item-click","handle-mouse-over","toggle-select","onDownloadDir","onDownloadFile"])]),_:1},8,["data-sources"])):B("",!0),!s(ve)&&C.value.length===0?(o(),a("div",Cs,g(t.$t(s(Xn)(s(ve),s(Pe).permissions,"WRITE_EXTERNAL_STORAGE"))),1)):B("",!0),_("input",{ref_key:"fileInput",ref:jt,style:{display:"none"},type:"file",multiple:"",onChange:l[1]||(l[1]=(...T)=>s(Oe)&&s(Oe)(...T))},null,544),_("input",{ref_key:"dirFileInput",ref:Gt,style:{display:"none"},type:"file",multiple:"",webkitdirectory:"",mozdirectory:"",directory:"",onChange:l[2]||(l[2]=(...T)=>s(Ke)&&s(Ke)(...T))},null,544)],32)],64)}}}),Ms=le(Ts,[["__scopeId","data-v-b68761db"]]);export{Ms as default};
