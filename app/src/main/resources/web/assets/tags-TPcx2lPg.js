import{m as D,c as m,o as _,a as o,d as F,r as S,cd as G,i as q,ce as N,cf as z,t as v,n as I,j as k,K as Q,N as j,O as H,k as t,aL as R,as as f,h as E,V as K,a0 as L,bG as O,C as Y,u as $,G as x,ba as J,A as M,Y as P}from"./index-Dohfv8Fq.js";import{u as U,a as W}from"./vee-validate-BgwL6Mce.js";const X={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Z(u,l){return _(),m("svg",X,l[0]||(l[0]=[o("path",{fill:"currentColor",d:"M18.925 16.075L17.5 14.65l2-2.65L15 6H8.85l-2-2H15q.475 0 .9.213t.7.587l4.5 6q.4.525.4 1.2t-.4 1.2zM4 18h11.2L4 6.8zm0 2q-.825 0-1.412-.587T2 18V6q0-.275.063-.513t.187-.437L1.4 4.2q-.275-.275-.275-.7t.275-.7t.7-.275t.7.275l18.4 18.4q.275.275.288.688t-.288.712q-.275.275-.7.275t-.7-.275l-3.275-3.275q-.25.325-.6.5T15.15 20zm10.175-9.675"},null,-1)]))}const ee=D({name:"material-symbols-label-off-outline-rounded",render:Z}),te={slot:"headline"},ae={slot:"content"},oe=["label","selected"],se=["label","selected"],ne=["label","selected","onClick"],de={slot:"actions"},le=["disabled"],ie={key:0,slot:"icon",indeterminate:""},re=F({__name:"AddToTagsModal",props:{type:{type:String,required:!0},tags:{type:Array,default:()=>[]},query:{type:String,required:!0}},setup(u){const{handleSubmit:l}=U(),n=S("add_to_tags"),a=u;function c(e){const{button:i}=e.detail,p=i.dataset.value;n.value=p}const{value:s,errorMessage:d}=W("selectedTags",G().test("required","valid.required",e=>e.length),{initialValue:[]}),{mutate:g,loading:y,onDone:C}=q({document:N}),{mutate:A,loading:b,onDone:V}=q({document:z}),h=()=>{L.emit("items_tags_updated",{type:a.type}),L.emit("refetch_tags",a.type),f()};V(h),C(h);function w(e){s.value.includes(e)?O(s.value,i=>i.id===e.id):s.value.push(e)}const T=l(()=>{n.value==="add_to_tags"?A({type:a.type,tagIds:s.value.map(e=>e.id),query:a.query}):g({type:a.type,tagIds:s.value.map(e=>e.id),query:a.query})});return(e,i)=>{const p=Q,B=ee;return _(),m("md-dialog",null,[o("div",te,v(e.$t("tags")),1),o("div",ae,[o("md-outlined-segmented-button-set",{onSegmentedButtonSetSelection:c},[o("md-outlined-segmented-button",{"data-value":"add_to_tags",label:e.$t("add_to_tags"),selected:n.value==="add_to_tags"},[k(p,{slot:"icon"})],8,oe),o("md-outlined-segmented-button",{"data-value":"remove_from_tags",label:e.$t("remove_from_tags"),selected:n.value==="remove_from_tags"},[k(B,{slot:"icon"})],8,se)],32),o("md-chip-set",null,[(_(!0),m(j,null,H(u.tags,r=>(_(),m("md-filter-chip",{key:r.id,label:r.name,selected:t(s).includes(r),onClick:ce=>w(r)},null,8,ne))),128))]),I(o("div",{class:"invalid-feedback"},v(t(d)?e.$t(t(d)):""),513),[[R,t(d)]])]),o("div",de,[o("md-outlined-button",{value:"cancel",onClick:i[0]||(i[0]=(...r)=>t(f)&&t(f)(...r))},v(e.$t("cancel")),1),o("md-filled-button",{value:"save",disabled:t(b)||t(y),autofocus:"",onClick:i[1]||(i[1]=(...r)=>t(T)&&t(T)(...r))},[t(b)||t(y)?(_(),m("md-circular-progress",ie)):E("",!0),K(" "+v(e.$t("save")),1)],8,le)])])}}}),ue=Y(re,[["__scopeId","data-v-e3ee6e76"]]),ge=(u,l)=>{const{t:n}=$();return{addToTags:(a,c,s)=>{let d=s;if(!c){if(a.length===0){M(n("select_first"),"error");return}d=`ids:${a.join(",")}`}P(ue,{type:u,tags:l.value,query:d})}}},ve=(u,l=()=>{})=>{const n=S([]),{t:a}=$(),{loading:c,fetch:s}=x({handle:async(d,g)=>{g?M(a(g),"error"):d&&(n.value=d.tags,l())},document:J,variables:{type:u}});return{tags:n,loading:c,fetch:s}};export{ge as a,ve as u};
