import{e as W,w as D,ae as z,af as F,c as w,o as m,z as L,O as P,bZ as U,aD as Y,J as A,m as X,a as d,u as Z,f as j,r as x,h as J,bj as K,F as ee,a5 as $,k as B,t as y,L as E,M as te,K as G,G as oe,q as H,Z as N,$ as ne,a2 as I,bL as Q,ac as se,C as ae,B as ie,cl as le,D as ce,i as O,cm as de,cn as re,co as ue}from"./index-C3OaPBr-.js";import{_ as pe}from"./more-vert-CsKzTfP1.js";const V=8,me=120,_e=80,fe=".v-dropdown-menu.is-open",ve=W({__name:"VDropdownMenu",props:{modelValue:{type:Boolean,default:!1},anchor:{type:String,required:!0}},emits:["update:modelValue"],setup(_,{emit:l}){const s=_,q=l;let a=null;const c=()=>document.querySelector(fe),u=()=>q("update:modelValue",!1),f=e=>{if(!(a!=null&&a.contains(e.target))){const o=c();return!(o!=null&&o.contains(e.target))}return!1},T=e=>{if(!a||!e)return;const o=a.getBoundingClientRect();if(o.width===0&&o.height===0){setTimeout(()=>T(e),10);return}const{innerWidth:b,innerHeight:t}=window,n=window.scrollY||document.documentElement.scrollTop,g=window.scrollX||document.documentElement.scrollLeft,h=e.offsetWidth||me,C=e.offsetHeight||_e;let p=o.bottom+n+V,r=o.left+g;r+h>b&&(r=o.right+g-h),r=Math.max(g+V,r),p+C>t+n&&(p=o.top+n-C-V,p<n&&(p=n+V,e.style.maxHeight=`${t-16}px`,e.style.overflowY="auto")),e.style.top=`${Math.max(0,p)}px`,e.style.left=`${Math.max(0,r)}px`,e.style.opacity="1",e.style.visibility="visible"},v=e=>{f(e)&&u()},k=e=>{const{detail:o}=e;s.modelValue&&(!(o!=null&&o.exclude)||o.exclude!==a)&&u()},M=async()=>{a=document.getElementById(s.anchor),a&&(await Y(),setTimeout(()=>{const e=c();e&&T(e)},10))};return D(()=>s.modelValue,e=>{if(e)M();else{const o=c();o&&(o.style.opacity="0",o.style.visibility="hidden")}}),D(()=>s.anchor,(e,o)=>{s.modelValue&&e!==o&&M()}),z(()=>{document.addEventListener("click",v),document.addEventListener("click",v,{capture:!0}),document.addEventListener("dropdown-toggle",k)}),F(()=>{document.removeEventListener("click",v),document.removeEventListener("click",v,{capture:!0}),document.removeEventListener("dropdown-toggle",k)}),(e,o)=>(m(),w("div",{class:P(["v-dropdown-menu",{"is-open":_.modelValue}]),onClick:o[0]||(o[0]=L(()=>{},["stop"]))},[U(e.$slots,"default",{},void 0,!0)],2))}}),ge=A(ve,[["__scopeId","data-v-7a0835bb"]]),he={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ye(_,l){return m(),w("svg",he,l[0]||(l[0]=[d("path",{fill:"currentColor",d:"M11 13H6q-.425 0-.712-.288T5 12t.288-.712T6 11h5V6q0-.425.288-.712T12 5t.713.288T13 6v5h5q.425 0 .713.288T19 12t-.288.713T18 13h-5v5q0 .425-.288.713T12 19t-.712-.288T11 18z"},null,-1)]))}const we=X({name:"material-symbols-add-rounded",render:ye}),Te={class:"top-app-bar"},ke={class:"title"},Me={class:"actions"},be={class:"nav"},Ce=["onClick"],$e={class:"title"},Ve={class:"count"},xe=W({__name:"TagFilter",props:{type:{type:String,required:!0},selected:{type:String,required:!0}},setup(_){const l=_,{t:s}=Z(),q=j(),a=x([]),c=x(!1),u=x(),{refetch:f}=J({handle:(t,n)=>{n?ee(s(n),"error"):t&&(a.value=t.tags)},document:K,variables:{type:l.type}});function T(t){u.value=t;const n=document.getElementById("tag-"+t.id);document.dispatchEvent(new CustomEvent("dropdown-toggle",{detail:{exclude:n}})),c.value=!0}function v(t){I(Q,{title:s("rename"),placeholder:s("name"),value:t.name,mutation:()=>O({document:de}),getVariables:n=>({id:t.id,name:n}),done:()=>{f()}})}function k(t){I(se,{id:t.id,name:t.name,gql:re,typeName:"Tag"})}function M(){I(Q,{title:s("add_tag"),placeholder:s("name"),mutation:()=>O({document:ue,options:{update:()=>{f()}}}),getVariables:t=>({type:l.type,name:t})})}function e(t){const n=ae([{name:"tag_id",op:"",value:t.id}]);ie(q,`/${le[l.type]}?q=${ce(n)}`)}const o=t=>{t===l.type&&f()},b=t=>{t.type===l.type&&f()};return z(()=>{$.on("refetch_tags",o),$.on("media_items_actioned",b)}),F(()=>{$.off("refetch_tags",o),$.off("media_items_actioned",b)}),(t,n)=>{var S;const g=we,h=oe,C=pe,p=ge,r=te("tooltip");return m(),w(N,null,[d("div",Te,[d("div",ke,y(t.$t("tags")),1),d("div",Me,[E((m(),G(h,{onClick:L(M,["prevent"])},{default:H(()=>[B(g)]),_:1})),[[r,t.$t("add_tag")]])])]),d("ul",be,[(m(!0),w(N,null,ne(a.value,i=>(m(),w("li",{key:i.id,class:P({active:i.id===_.selected}),onClick:L(R=>e(i),["prevent"])},[d("span",$e,y(i.name),1),E((m(),G(h,{id:"tag-"+i.id,class:"sm",onClick:L(R=>T(i),["prevent","stop"])},{default:H(()=>[B(C)]),_:2},1032,["id","onClick"])),[[r,t.$t("actions")]]),d("span",Ve,y(i.count.toLocaleString()),1)],10,Ce))),128))]),B(p,{modelValue:c.value,"onUpdate:modelValue":n[2]||(n[2]=i=>c.value=i),anchor:"tag-"+((S=u.value)==null?void 0:S.id)},{default:H(()=>[d("div",{class:"dropdown-item",onClick:n[0]||(n[0]=i=>{v(u.value),c.value=!1})},y(t.$t("rename")),1),d("div",{class:"dropdown-item",onClick:n[1]||(n[1]=i=>{k(u.value),c.value=!1})},y(t.$t("delete")),1)]),_:1},8,["modelValue","anchor"])],64)}}});export{xe as _,ge as a,we as b};
