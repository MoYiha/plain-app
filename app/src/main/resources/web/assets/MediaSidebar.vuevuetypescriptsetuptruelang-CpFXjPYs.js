import{_ as K}from"./LeftSidebar.vuevuetypescriptsetuptruelang-CbD4UtEo.js";import{_ as W}from"./TagFilter.vuevuetypescriptsetuptruelang-kcO_p9MB.js";import{e as G,u as Y,f as H,r as y,aT as Z,h as ee,b6 as te,D as se,ab as N,a1 as g,ac as U,c as f,o as d,R as ae,y as b,P as A,l as T,a as m,t as p,Q as oe,m as ne,g as E,s as O,G as ie,aH as V,H as i,J as re,w as le,O as R,a2 as I,a3 as L,a0 as ce,k as $,j as S,aM as ue,aN as de,p as pe,M as me,X as _e,A as ve,z as Q,B as fe}from"./index-BaWXnnLZ.js";import{_ as he}from"./IconButton.vuevuetypescriptsetuptruelang-CHMhruVe.js";import{u as ye}from"./search-brnXFXDL.js";const Te=["onClick"],ge={class:"title"},qe={class:"count"},ke=G({__name:"BucketFilter",props:{type:{type:String,required:!0},selected:{type:String,required:!0}},setup(_){const r=_,{t:q}=Y(),t=H(),h=y([]),{view:s}=Z(r.type),{refetch:k}=ee({handle:(o,c)=>{c?se(q(c),"error"):o&&(h.value=o.mediaBuckets)},document:te,variables:{type:r.type}}),l=o=>{o.type===r.type&&k()};return N(()=>{g.on("media_items_actioned",l)}),U(()=>{g.off("media_items_actioned",l)}),(o,c)=>(d(!0),f(oe,null,ae(h.value,a=>(d(),f("li",{key:a.id,class:A({active:_.selected&&a.id===_.selected}),onClick:b(v=>T(s)(T(t),a.id),["prevent"])},[m("span",ge,p(a.name),1),m("span",qe,p(a.itemCount.toLocaleString()),1)],10,Te))),128))}}),Ie={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function $e(_,r){return d(),f("svg",Ie,r[0]||(r[0]=[m("path",{fill:"currentColor",d:"M11.95 18q.525 0 .888-.363t.362-.887t-.362-.888t-.888-.362t-.887.363t-.363.887t.363.888t.887.362m.05 4q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12t-2.325-5.675T12 4T6.325 6.325T4 12t2.325 5.675T12 20m.1-12.3q.625 0 1.088.4t.462 1q0 .55-.337.975t-.763.8q-.575.5-1.012 1.1t-.438 1.35q0 .35.263.588t.612.237q.375 0 .638-.25t.337-.625q.1-.525.45-.937t.75-.788q.575-.55.988-1.2t.412-1.45q0-1.275-1.037-2.087T12.1 6q-.95 0-1.812.4T8.975 7.625q-.175.3-.112.638t.337.512q.35.2.725.125t.625-.425q.275-.375.688-.575t.862-.2"},null,-1)]))}const Se=ne({name:"material-symbols-help-outline-rounded",render:$e}),be={class:"nav"},Ae={class:"title"},Be={key:0,class:"count"},De={class:"title"},we={key:0,class:"count"},Re=G({__name:"MediaSidebar",props:{type:{type:String,required:!0},gql:{type:Object,required:!0}},setup(_){const r=E(),{app:q}=O(r),t=_,h=H(),{counter:s}=O(E()),{parseQ:k}=ye(),l=ie({tagIds:[]}),o=y(""),c=y(!1),a=y(""),v=y(""),B=V(()=>{var e,u,n;return t.type===i.IMAGE?((e=s.value)==null?void 0:e.images)??-1:t.type===i.VIDEO?((u=s.value)==null?void 0:u.videos)??-1:t.type===i.AUDIO?((n=s.value)==null?void 0:n.audios)??-1:-1}),D=V(()=>{var e,u,n;return t.type===i.IMAGE?((e=s.value)==null?void 0:e.imagesTrash)??-1:t.type===i.VIDEO?((u=s.value)==null?void 0:u.videosTrash)??-1:t.type===i.AUDIO?((n=s.value)==null?void 0:n.audiosTrash)??-1:-1}),{fetch:w}=re({handle:e=>{e&&(t.type===i.IMAGE?(s.value.images=e.total,s.value.imagesTrash=e.trash):t.type===i.VIDEO?(s.value.videos=e.total,s.value.videosTrash=e.trash):t.type===i.AUDIO&&(s.value.audios=e.total,s.value.audiosTrash=e.trash))},document:t.gql,variables:()=>({})});function M(){var n;const e=L.currentRoute.value;o.value=e.meta.group||"",w();const u=ce(((n=e.query.q)==null?void 0:n.toString())??"");k(l,u),a.value=l.tagIds.length===1?l.tagIds[0]:"",c.value=l.trash??!1,v.value=l.bucketId??"",a.value&&v.value&&(a.value=""),c.value&&(v.value="",a.value="")}M(),le(()=>L.currentRoute.value.fullPath,()=>{M()});function F(){const e=ve([{name:"trash",op:"",value:"true"}]);Q(h,`/${o.value}?q=${fe(e)}`)}function x(){Q(h,`/${o.value}`)}const C=e=>{e.type===t.type&&w()};return N(()=>{g.on("media_items_actioned",C)}),U(()=>{g.off("media_items_actioned",C)}),(e,u)=>{const n=Se,z=he,P=ke,j=W,J=K,X=me("tooltip");return d(),R(J,null,{title:I(()=>[_e(p(e.$t(`page_title.${o.value}`)),1)]),body:I(()=>[m("ul",be,[m("li",{class:A({active:!a.value&&!v.value&&!c.value}),onClick:b(x,["prevent"])},[m("span",Ae,p(e.$t("all")),1),B.value>=0?(d(),f("span",Be,p(B.value.toLocaleString()),1)):S("",!0)],2),T(ue)(T(de).MEDIA_TRASH,T(q).osVersion)?(d(),f("li",{key:0,class:A({active:c.value}),onClick:b(F,["prevent"])},[m("span",De,p(e.$t("trash")),1),pe((d(),R(z,{class:"btn-help sm"},{icon:I(()=>[$(n)]),_:1})),[[X,e.$t("trash_tips")]]),D.value>=0?(d(),f("span",we,p(D.value.toLocaleString()),1)):S("",!0)],2)):S("",!0),$(P,{type:t.type,selected:v.value},null,8,["type","selected"])]),$(j,{type:t.type,selected:a.value},null,8,["type","selected"])]),_:1})}}});export{Re as _};
