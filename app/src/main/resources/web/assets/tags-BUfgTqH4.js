import{o as g,c as p,a,d as F,h as $,bU as w,j as y,bV as z,bW as I,t as m,p as T,O as Q,P as G,m as s,x as j,a_ as H,as as f,a0 as q,bS as N,a1 as E,H as K,g as S,C as A,Y as O,K as P,b0 as R}from"./index-BxNI00MG.js";import{u as U,a as W}from"./vee-validate.esm-9czZ1sUw.js";const Y={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},x=a("path",{fill:"currentColor",d:"M19.125 14.625q-.275.425-.687.45t-.713-.2t-.413-.612t.188-.813L18.55 12L15 7h-4.725q-.5 0-.75-.312T9.275 6t.25-.687t.75-.313H15q.5 0 .925.213t.725.637l3.525 5q.2.275.288.563t.087.587t-.088.588t-.287.562zM5 19q-.825 0-1.412-.587T3 17V7q0-.275.063-.5t.187-.45L2.1 4.9q-.275-.275-.275-.7t.275-.7t.7-.275t.7.275l17 17q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-3.15-3.15q-.225.125-.45.188T15 19zm9.2-2L5 7.8V17z"},null,-1),J=[x];function X(u,r){return g(),p("svg",Y,[...J])}const Z={name:"material-symbols-label-off-outline-rounded",render:X},ee={slot:"headline"},te={slot:"content"},ae=["label","selected"],oe=["label","selected"],se=["label","selected","onClick"],ne={slot:"actions"},de=["disabled"],le=F({__name:"AddToTagsModal",props:{type:{type:String,required:!0},tags:{type:Array,default:()=>[]},query:{type:String,required:!0}},setup(u){const{handleSubmit:r}=U(),n=$("add_to_tags"),t=u;function c(e){const{button:l}=e.detail,v=l.dataset.value;n.value=v}const{value:o,errorMessage:d}=W("selectedTags",w().test("required","valid.required",e=>e.length),{initialValue:[]}),{mutate:_,loading:L,onDone:M}=y({document:z,appApi:!0}),{mutate:k,loading:C,onDone:V}=y({document:I,appApi:!0}),b=()=>{q.emit("items_tags_updated",{type:t.type}),q.emit("refetch_tags",t.type),f()};V(b),M(b);function B(e){o.value.includes(e)?N(o.value,l=>l.id===e.id):o.value.push(e)}const h=r(()=>{n.value==="add_to_tags"?k({type:t.type,tagIds:o.value.map(e=>e.id),query:t.query}):_({type:t.type,tagIds:o.value.map(e=>e.id),query:t.query})});return(e,l)=>{const v=E,D=Z;return g(),p("md-dialog",null,[a("div",ee,m(e.$t("tags")),1),a("div",te,[a("md-outlined-segmented-button-set",{onSegmentedButtonSetSelection:c},[a("md-outlined-segmented-button",{"data-value":"add_to_tags",label:e.$t("add_to_tags"),selected:n.value==="add_to_tags"},[T(v,{slot:"icon"})],8,ae),a("md-outlined-segmented-button",{"data-value":"remove_from_tags",label:e.$t("remove_from_tags"),selected:n.value==="remove_from_tags"},[T(D,{slot:"icon"})],8,oe)],32),a("md-chip-set",null,[(g(!0),p(Q,null,G(u.tags,i=>(g(),p("md-filter-chip",{key:i.id,label:i.name,selected:s(o).includes(i),onClick:ue=>B(i)},null,8,se))),128))]),j(a("div",{class:"invalid-feedback"},m(s(d)?e.$t(s(d)):""),513),[[H,s(d)]])]),a("div",ne,[a("md-outlined-button",{value:"cancel",onClick:l[0]||(l[0]=(...i)=>s(f)&&s(f)(...i))},m(e.$t("cancel")),1),a("md-filled-button",{value:"save",disabled:s(C)||s(L),onClick:l[1]||(l[1]=(...i)=>s(h)&&s(h)(...i)),autofocus:""},m(e.$t("save")),9,de)])])}}}),ie=K(le,[["__scopeId","data-v-1a504db3"]]),_e=(u,r)=>{const{t:n}=S();return{addToTags:(t,c,o)=>{let d=o;if(!c){if(t.length===0){A(n("select_first"),"error");return}d=`ids:${t.join(",")}`}O(ie,{type:u,tags:r.value,query:d})}}},me=(u,r=()=>{})=>{const n=$([]),{t}=S(),{loading:c,fetch:o}=P({handle:async(d,_)=>{_?A(t(_),"error"):d&&(n.value=d.tags,r())},document:R,variables:{type:u},appApi:!0});return{tags:n,loading:c,fetch:o}};export{_e as a,me as u};
