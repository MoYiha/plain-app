import{m as j,c as u,o as s,a as n,e as Y,u as J,r as y,h as W,b_ as ue,E as A,i as B,b$ as de,aA as G,R as M,p as v,k as m,as as K,l as i,F as b,t as r,z as X,j as R,Y as Z,T as O,U as _e,S as me,aC as ve,M as pe,N as fe,O as $,P as he,bJ as ge,c0 as qe,al as ye,c1 as be,c2 as $e,c3 as Te,c4 as ke,a1 as Me,c5 as Ce,a4 as H,H as we}from"./index-Dd8UjYtJ.js";import{_ as Se}from"./VSelect-CioYINgK.js";const Ve={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Le(z,o){return s(),u("svg",Ve,o[0]||(o[0]=[n("path",{fill:"currentColor",d:"M6 18H4q-.425 0-.712-.288T3 17t.288-.712T4 16h3q.425 0 .713.288T8 17v3q0 .425-.288.713T7 21t-.712-.288T6 20zm12 0v2q0 .425-.288.713T17 21t-.712-.288T16 20v-3q0-.425.288-.712T17 16h3q.425 0 .713.288T21 17t-.288.713T20 18zM6 6V4q0-.425.288-.712T7 3t.713.288T8 4v3q0 .425-.288.713T7 8H4q-.425 0-.712-.288T3 7t.288-.712T4 6zm12 0h2q.425 0 .713.288T21 7t-.288.713T20 8h-3q-.425 0-.712-.288T16 7V4q0-.425.288-.712T17 3t.713.288T18 4z"},null,-1)]))}const Qe=j({name:"material-symbols-fullscreen-exit-rounded",render:Le}),ze={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ie(z,o){return s(),u("svg",ze,o[0]||(o[0]=[n("path",{fill:"currentColor",d:"M5 19h2q.425 0 .713.288T8 20t-.288.713T7 21H4q-.425 0-.712-.288T3 20v-3q0-.425.288-.712T4 16t.713.288T5 17zm14 0v-2q0-.425.288-.712T20 16t.713.288T21 17v3q0 .425-.288.713T20 21h-3q-.425 0-.712-.288T16 20t.288-.712T17 19zM5 5v2q0 .425-.288.713T4 8t-.712-.288T3 7V4q0-.425.288-.712T4 3h3q.425 0 .713.288T8 4t-.288.713T7 5zm14 0h-2q-.425 0-.712-.288T16 4t.288-.712T17 3h3q.425 0 .713.288T21 4v3q0 .425-.288.713T20 8t-.712-.288T19 7z"},null,-1)]))}const De=j({name:"material-symbols-fullscreen-rounded",render:Ie}),He={xmlns:"http://www.w3.org/2000/svg",viewBox:"176.31 -11.19 346.88 581.88"};function Ae(z,o){return s(),u("svg",He,o[0]||(o[0]=[n("path",{d:"M470.49 0H229.51a41.9 41.9 0 0 0-29.547 12.277 41.9 41.9 0 0 0-12.277 29.547v476.35a41.9 41.9 0 0 0 12.277 29.547 41.9 41.9 0 0 0 29.547 12.277h240.98a41.9 41.9 0 0 0 29.547-12.277 41.9 41.9 0 0 0 12.277-29.547V41.824a41.9 41.9 0 0 0-12.277-29.547A41.9 41.9 0 0 0 470.49 0m33.25 518.18a33.33 33.33 0 0 1-9.766 23.484 33.34 33.34 0 0 1-23.484 9.766H229.51a33.33 33.33 0 0 1-23.484-9.766 33.34 33.34 0 0 1-9.765-23.484V41.83a33.33 33.33 0 0 1 9.828-23.371 33.32 33.32 0 0 1 23.422-9.703h240.98a33.33 33.33 0 0 1 23.484 9.765 33.34 33.34 0 0 1 9.765 23.484z"},null,-1),n("path",{d:"M317.62 46.812h64.75c2.418 0 4.375-1.957 4.375-4.375s-1.957-4.375-4.375-4.375h-64.75c-2.418 0-4.375 1.957-4.375 4.375s1.957 4.375 4.375 4.375M364.7 192.5a16.8 16.8 0 0 0-14.7-8.75 16.8 16.8 0 0 0-14.698 8.75l-91 157.5a16.45 16.45 0 0 0 0 16.977 16.6 16.6 0 0 0 6.101 6.386 16.65 16.65 0 0 0 8.512 2.364h182.09a16.626 16.626 0 0 0 14.7-8.75 16.8 16.8 0 0 0 0-16.977zm83.562 170.36a8.22 8.22 0 0 1-7.262 4.2H258.91a8.23 8.23 0 0 1-7.176-4.2 8.75 8.75 0 0 1 0-8.75l91-157.5a8.75 8.75 0 0 1 7.262-4.113 8.76 8.76 0 0 1 7.262 4.199l91 157.5a8.75 8.75 0 0 1 0 8.84z"},null,-1),n("path",{d:"M350 221.55a4.29 4.29 0 0 0-4.29 4.285v66.238a4.375 4.375 0 0 0 8.75 0v-66.238a4.286 4.286 0 0 0-4.46-4.285m0 91.26a4.29 4.29 0 0 0-4.29 4.29v17.061a4.375 4.375 0 0 0 8.75 0V317.1a4.286 4.286 0 0 0-4.46-4.29"},null,-1)]))}const Be={render:Ae},Re={class:"form-row"},Ee={class:"button-group"},Fe=["onClick"],Ne={class:"form-row"},Ue={class:"form-label"},Ge={class:"form-row"},Oe={class:"form-label"},xe={class:"form-row",style:{"max-width":"640px"}},Pe=Y({__name:"ChangeScreenMirrorQualityModal",setup(z){const{t:o}=J(),p=y(720),c=y(60),d=y("quality_sd"),h=[{id:"quality_ld",data:{resolution:480,quality:50}},{id:"quality_sd",data:{resolution:720,quality:50}},{id:"quality_hd",data:{resolution:1080,quality:50}},{id:"custom"}],g=[10,20,30,40,50,60,70,80,90,100],C=[480,720,1080];W({handle:(t,f)=>{var T;f?A(o(f),"error"):t&&(p.value=t.screenMirrorQuality.resolution,c.value=t.screenMirrorQuality.quality,d.value=((T=h.find(w=>{var S,V;return((S=w.data)==null?void 0:S.resolution)===p.value&&((V=w.data)==null?void 0:V.quality)===c.value}))==null?void 0:T.id)||"custom")},document:ue});function Q(t){return t===10?`10 (${o("low_quality")})`:t===60?`60 (${o("high_quality")})`:t===100?`100 (${o("best_quality")})`:t.toString()}function I(t){d.value=t.id,t.data&&(p.value=t.data.resolution,c.value=t.data.quality)}const{mutate:q,loading:D,onDone:E}=B({document:de});E(()=>{G()});const F=()=>{q({resolution:p.value,quality:c.value})};return(t,f)=>{const T=Se,w=K,S=Z,V=X,N=ve;return s(),M(N,{"modal-id":"screen-mirror-quality",onClose:i(G)},{headline:v(()=>[b(r(t.$t("change_quality")),1)]),content:v(()=>[n("div",Re,[n("div",Ee,[(s(),u(O,null,_e(h,l=>n("button",{key:l.id,class:me({selected:d.value===l.id}),onClick:x=>I(l)},r(t.$t(l.id)),11,Fe)),64))])]),n("div",Ne,[n("label",Ue,r(t.$t("compress_quality")),1),m(T,{modelValue:c.value,"onUpdate:modelValue":f[0]||(f[0]=l=>c.value=l),modelModifiers:{number:!0},class:"flex-2",disabled:d.value!=="custom",options:g.map(l=>({value:l,label:Q(l)}))},null,8,["modelValue","disabled","options"])]),n("div",Ge,[n("label",Oe,r(t.$t("resolution")),1),m(T,{modelValue:p.value,"onUpdate:modelValue":f[1]||(f[1]=l=>p.value=l),modelModifiers:{number:!0},class:"flex-2",disabled:d.value!=="custom",options:C.map(l=>({value:l,label:`${l}p`}))},null,8,["modelValue","disabled","options"])]),n("div",xe,r(t.$t("screen_mirror_quality_tips")),1)]),actions:v(()=>[m(w,{value:"cancel",onClick:i(G)},{default:v(()=>[b(r(t.$t("cancel")),1)]),_:1},8,["onClick"]),m(V,{value:"save",disabled:i(D),onClick:F},{default:v(()=>[i(D)?(s(),M(S,{key:0,indeterminate:""})):R("",!0),b(" "+r(t.$t("save")),1)]),_:1},8,["disabled"])]),_:1},8,["onClose"])}}}),je={class:"screen-mirror"},Ye={class:"top-app-bar"},Je={class:"title"},We={class:"actions"},Ke={class:"content"},Xe={key:0},Ze={key:0,class:"request-permission"},et={class:"tap-phone"},tt={class:"text"},nt={key:1,class:"request-permission-failed"},st=Y({__name:"ScreenMirrorView",setup(z){let o;const{t:p}=J(),c=y(!1),d=y(0),h=y(!1),g=y(!1),C=y(!1),Q=y(),I=async e=>{c.value=!0,w(e),h.value=!1,d.value=0,clearInterval(o)};let q=!1;const{mutate:D}=B({document:be}),E=()=>{g.value=!g.value,g.value||P()},F=()=>{Me(Pe)},t=()=>{D(),q=!0},f=e=>{e&&q&&(q=!1,clearInterval(o),U())},T=()=>{const e=Q.value;if(!e)return;const a=new Date,L="screenshot-"+[a.getFullYear(),a.getMonth()+1,a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()].join("")+".png";Ce(e.toDataURL(),L)};function w(e){const a=Q.value;if(!a||g.value&&!C.value)return;C.value=!1;const L=a.getContext("2d"),_=new Image;_.src=URL.createObjectURL(e),_.onload=function(){L&&(a.width=_.width,a.height=_.height,L.drawImage(_,0,0))}}pe(()=>{H.on("screen_mirroring",I),H.on("app_socket_connection_changed",f)}),fe(()=>{H.off("screen_mirroring",I),H.off("app_socket_connection_changed",f)});const{mutate:S,loading:V,onDone:N,onError:l}=B({document:$e}),{loading:x,refetch:P}=W({handle:(e,a)=>{a?A(p(a),"error"):e.screenMirrorState?(c.value=!0,C.value=!0):(c.value=!1,C.value=!1,U())},options:{fetchPolicy:"no-cache"},document:Te}),ee=()=>{document.getElementsByClassName("screen-mirror")[0].requestFullscreen({navigationUI:"show"})},U=()=>{h.value=!1,g.value=!1,S()},te=()=>{document.exitFullscreen()};l(e=>{A(p(e.message)),h.value=!0}),N(()=>{d.value=30,o=setInterval(()=>{d.value--,d.value<=0&&(h.value=!0,clearInterval(o))},1e3)});const{mutate:ne,loading:se,onDone:oe,onError:ae}=B({document:ke});return ae(e=>{A(p(e.message))}),oe(()=>{h.value=!0,c.value=!1}),(e,a)=>{const L=ge,_=K,le=De,re=Qe,ie=Z,ce=X,k=he("tooltip");return s(),u("div",je,[n("div",Ye,[n("div",Je,r(e.$t("screen_mirror")),1),n("div",We,[c.value?(s(),u(O,{key:0},[$((s(),u("button",{class:"btn-icon",onClick:a[0]||(a[0]=()=>i(P)())},[m(L)])),[[k,e.$t("refresh")]]),$((s(),M(_,{class:"btn-sm",onClick:F},{default:v(()=>[b(r(e.$t("mirror_quality")),1)]),_:1})),[[k,e.$t("change_quality")]]),$((s(),M(_,{class:"btn-sm",onClick:T},{default:v(()=>[b(r(e.$t("screenshot")),1)]),_:1})),[[k,e.$t("screenshot")]]),$((s(),M(_,{class:"btn-sm",onClick:E},{default:v(()=>[b(r(e.$t(g.value?"resume":"pause")),1)]),_:1})),[[k,e.$t(g.value?"resume":"pause")]]),$((s(),M(_,{disabled:i(se),class:"btn-sm btn-stop",onClick:i(ne)},{default:v(()=>[b(r(e.$t("stop_mirror")),1)]),_:1},8,["disabled","onClick"])),[[k,e.$t("stop_mirror")]]),$((s(),u("button",{class:"btn-icon btn-enter-fullscreen",onClick:ee},[m(le)])),[[k,e.$t("fullscreen")]]),$((s(),u("button",{class:"btn-icon btn-exit-fullscreen",onClick:te},[m(re)])),[[k,e.$t("exit_fullscreen")]])],64)):i(q)?R("",!0):(s(),M(_,{key:1,class:"btn-sm",onClick:t},{default:v(()=>[b(r(e.$t("relaunch_app")),1)]),_:1}))])]),n("div",Ke,[i(x)||i(V)||i(q)?(s(),u("div",Xe,[m(ie,{indeterminate:""})])):(s(),u(O,{key:1},[d.value>0&&!i(q)?(s(),u("div",Ze,[n("div",et,[m(i(qe))]),n("pre",tt,r(e.$t("screen_mirror_request_permission",{seconds:d.value})),1)])):R("",!0),h.value&&!c.value&&!i(q)?(s(),u("div",nt,[m(i(Be)),n("p",null,r(e.$t("screen_mirror_request_permission_failed")),1),m(ce,{onClick:U},{default:v(()=>[b(r(e.$t("try_again")),1)]),_:1})])):R("",!0),$(n("canvas",{ref_key:"canvasRef",ref:Q,class:"canvas"},null,512),[[ye,c.value]])],64))])])}}}),lt=we(st,[["__scopeId","data-v-82740530"]]);export{lt as default};
