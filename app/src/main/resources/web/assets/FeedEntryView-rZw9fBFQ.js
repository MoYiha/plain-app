import{o as n,c as s,a,d as te,g as ne,h as y,s as se,i as oe,K as ae,u as ie,j as V,C as q,l as le,L as ce,M as de,m as l,w as r,t as $,e as H,x as c,V as _e,p as d,Q as re,cE as ue,cA as pe,b0 as me,cF as ve,a3 as ye,S as fe,U as he,W as ge,F as be,G as Te,f as Q,Y as ke,Z as we,a0 as f,a1 as Ce,cG as qe,H as $e}from"./index-BxNI00MG.js";import{_ as Fe}from"./print-outline-rounded-Do3M-1Bq.js";import{a as Ee,_ as Le}from"./add-notes-outline-rounded-CGmqzbfx.js";import{u as De}from"./markdown-CMfotNJO.js";import{u as Me}from"./feeds-D_-bRH1Y.js";const Ae={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Se=a("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h6q.425 0 .713.288T12 4t-.288.713T11 5H5v14h14v-6q0-.425.288-.712T20 12t.713.288T21 13v6q0 .825-.587 1.413T19 21zM19 6.4L10.4 15q-.275.275-.7.275T9 15t-.275-.7t.275-.7L17.6 5H15q-.425 0-.712-.288T14 4t.288-.712T15 3h5q.425 0 .713.288T21 4v5q0 .425-.288.713T20 10t-.712-.288T19 9z"},null,-1),Ne=[Se];function Ve(u,m){return n(),s("svg",Ae,[...Ne])}const He={name:"material-symbols-open-in-new-rounded",render:Ve},_=u=>(be("data-v-d8d90b7e"),u=u(),Te(),u),Qe={class:"content"},Ge={key:0,class:"content-loading"},Ie=_(()=>a("md-circular-progress",{indeterminate:""},null,-1)),ze=[Ie],Be={key:1},Re={class:"top-app-bar"},Ue={key:0,class:"title"},xe=_(()=>a("md-ripple",null,null,-1)),Ke={key:1,indeterminate:"",class:"spinner-sm"},Ye=["disabled"],je=_(()=>a("md-ripple",null,null,-1)),Pe=["href"],We={class:"btn-icon sm"},Ze=_(()=>a("md-ripple",null,null,-1)),Je=_(()=>a("md-ripple",null,null,-1)),Oe=_(()=>a("md-ripple",null,null,-1)),Xe={class:"actions"},et=_(()=>a("md-ripple",null,null,-1)),tt={class:"article-title"},nt=["innerHTML"],p="FEED_ENTRY",st=te({__name:"FeedEntryView",setup(u){const{t:m}=ne(),F=re(),h=y(F.params.id),o=y(),g=y(""),b=y(),{app:G,urlTokenKey:I}=se(oe()),{render:E}=De(G,I),{loading:z,fetch:T}=ae({handle:async(e,t)=>{t?q(m(t),"error"):(o.value=e.feedEntry,g.value=await E(e.feedEntry.content||e.feedEntry.description))},document:ue,variables:()=>({id:h.value}),appApi:!0}),k=ie(),{viewFeed:B}=Me(k);function R(){const e=F.query.q;e?Q(k,`/feeds?q=${e}`):Q(k,"/feeds")}const{mutate:U,loading:ot,onDone:x}=V({document:pe,appApi:!0});x(()=>{q(m("saved"))}),le({handle:(e,t)=>{t?q(m(t),"error"):e&&(b.value=e.tags)},document:me,variables:{type:p},appApi:!0});const K=()=>{window.print()};function Y(){var e,t;ke(we,{type:p,tags:b.value,item:{key:(e=o.value)==null?void 0:e.id,title:"",size:0},selected:(t=b.value)==null?void 0:t.filter(w=>{var v;return(v=o.value)==null?void 0:v.tags.some(C=>C.id===w.id)})})}const{mutate:j,loading:L,onDone:P}=V({document:ve,appApi:!0});P(async e=>{const t=e.data;o.value=t.syncFeedContent,g.value=await E(t.syncFeedContent.content||t.syncFeedContent.description)});const W=()=>{j({id:h.value})},D=e=>{e.type===p&&T()},M=e=>{e.type===p&&T()};return ce(()=>{f.on("item_tags_updated",M),f.on("items_tags_updated",D),T()}),de(()=>{f.off("item_tags_updated",M),f.off("items_tags_updated",D)}),(e,t)=>{var A,S,N;const w=ye,v=Ce,C=Ee,Z=He,J=Le,O=Fe,X=qe,i=fe("tooltip");return n(),s("div",Qe,[l(z)?(n(),s("div",Ge,ze)):(n(),s("article",Be,[a("div",Re,[o.value?(n(),s("div",Ue,[o.value.feed?(n(),s("a",{key:0,onClick:t[0]||(t[0]=r(ee=>l(B)(o.value.feed),["stop","prevent"]))},$(o.value.feed.name),1)):H("",!0),c((n(),s("time",null,[_e($(l(ge)(o.value.publishedAt)),1)])),[[i,l(he)(o.value.publishedAt)]]),d(w,{tags:(A=o.value)==null?void 0:A.tags,type:p},null,8,["tags"]),c((n(),s("button",{class:"btn-icon sm",onClick:r(Y,["prevent"]),style:{"margin-inline-start":"16px"}},[xe,d(v)])),[[i,e.$t("add_to_tags")]]),l(L)?(n(),s("md-circular-progress",Ke)):c((n(),s("button",{key:2,class:"btn-icon sm",disabled:l(L),onClick:r(W,["prevent"])},[je,d(C)],8,Ye)),[[i,e.$t("sync_content")]]),c((n(),s("a",{href:(S=o.value)==null?void 0:S.url,class:"btn-icon",target:"_blank"},[a("button",We,[Ze,d(Z)])],8,Pe)),[[i,e.$t("view_original_article")]]),c((n(),s("button",{class:"btn-icon sm",onClick:t[1]||(t[1]=r(ee=>l(U)({query:`ids:${h.value}`}),["prevent"]))},[Je,d(J)])),[[i,e.$t("save_to_notes")]]),c((n(),s("button",{class:"btn-icon sm",onClick:r(K,["prevent"])},[Oe,d(O)])),[[i,e.$t("print")]])])):H("",!0),a("div",Xe,[c((n(),s("button",{class:"btn-icon",onClick:r(R,["prevent"])},[et,d(X)])),[[i,e.$t("close")]])])]),a("div",tt,$((N=o.value)==null?void 0:N.title),1),a("div",{class:"md-container",innerHTML:g.value},null,8,nt)]))])}}}),_t=$e(st,[["__scopeId","data-v-d8d90b7e"]]);export{_t as default};
