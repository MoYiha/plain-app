import{_ as N}from"./more-vert-rfLdxqnE.js";import{o as i,c as l,a as t,d as E,g as z,u as F,h as m,l as P,C as U,b0 as j,aU as O,a0 as s,aV as Y,S as x,p as v,t as r,x as C,w as g,O as q,P as J,N as K,Y as h,j as M,c3 as R,c4 as W,ac as X,c5 as Z,a6 as ee,f as te,c6 as ne,a7 as ae,a1 as oe}from"./index-BxNI00MG.js";import{E as V}from"./EditValueModal-DZMNikfg.js";const se={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ie=t("path",{fill:"currentColor",d:"M11 13H6q-.425 0-.712-.288T5 12t.288-.712T6 11h5V6q0-.425.288-.712T12 5t.713.288T13 6v5h5q.425 0 .713.288T19 12t-.288.713T18 13h-5v5q0 .425-.288.713T12 19t-.712-.288T11 18z"},null,-1),le=[ie];function de(p,o){return i(),l("svg",se,[...le])}const ce={name:"material-symbols-add-rounded",render:de},re={class:"top-app-bar"},ue={class:"btn-icon no-click"},pe={class:"title"},_e={class:"actions"},me=t("md-ripple",null,null,-1),ve={class:"nav"},ge=["onClick"],he={class:"title"},fe=["id","onClick"],ye=t("md-ripple",null,null,-1),be={class:"count"},Te=["anchor","open"],$e={slot:"headline"},ke={slot:"headline"},Ve=E({__name:"TagFilter",props:{type:{type:String,required:!0},selected:{type:String,required:!0}},setup(p){const o=p,{t:d}=z(),w=F(),f=m([]),_=m(!1),u=m(),{refetch:c}=P({handle:(e,n)=>{n?U(d(n),"error"):e&&(f.value=e.tags)},document:j,variables:{type:o.type},appApi:!0});function S(e){u.value=e,_.value=!0}function L(e){h(V,{title:d("rename"),placeholder:d("name"),value:e.name,mutation:()=>M({document:R,appApi:!0}),getVariables:n=>({id:e.id,name:n}),done:()=>{c()}})}function Q(e){h(X,{id:e.id,name:e.name,gql:W,appApi:!0,typeName:"Tag"})}function B(){h(V,{title:d("add_tag"),placeholder:d("name"),mutation:()=>M({document:Z,options:{update:()=>{c()}},appApi:!0}),getVariables:e=>({type:o.type,name:e})})}function D(e){const n=ee([{name:"tag_id",op:"",value:e.id}]);te(w,`/${ne[o.type]}?q=${ae(n)}`)}const y=e=>{e===o.type&&c()},b=e=>{e.type===o.type&&c()},T=e=>{e.item.tags.length&&e.type===o.type&&c()};return O(()=>{s.on("refetch_tags",y),s.on("media_items_deleted",b),s.on("media_item_deleted",T)}),Y(()=>{s.off("refetch_tags",y),s.off("media_items_deleted",b),s.off("media_item_deleted",T)}),(e,n)=>{var k;const A=oe,G=ce,H=N,$=x("tooltip");return i(),l(q,null,[t("div",re,[t("div",ue,[v(A)]),t("div",pe,r(e.$t("tags")),1),t("div",_e,[C((i(),l("button",{class:"btn-icon",onClick:g(B,["prevent"])},[me,v(G)])),[[$,e.$t("add_tag")]])])]),t("ul",ve,[(i(!0),l(q,null,J(f.value,a=>(i(),l("li",{onClick:g(I=>D(a),["prevent"]),key:a.id,class:K({active:a.id===p.selected})},[t("span",he,r(a.name),1),C((i(),l("button",{id:"tag-"+a.id,class:"btn-icon sm",onClick:g(I=>S(a),["prevent","stop"])},[ye,v(H)],8,fe)),[[$,e.$t("actions")]]),t("span",be,r(a.count.toLocaleString()),1)],10,ge))),128))]),t("md-menu",{positioning:"popover",anchor:"tag-"+((k=u.value)==null?void 0:k.id),"stay-open-on-focusout":"",quick:"",open:_.value,onClosed:n[2]||(n[2]=a=>_.value=!1)},[t("md-menu-item",{onClick:n[0]||(n[0]=a=>L(u.value))},[t("div",$e,r(e.$t("rename")),1)]),t("md-menu-item",{onClick:n[1]||(n[1]=a=>Q(u.value))},[t("div",ke,r(e.$t("delete")),1)])],40,Te)],64)}}});export{Ve as _,ce as a};
