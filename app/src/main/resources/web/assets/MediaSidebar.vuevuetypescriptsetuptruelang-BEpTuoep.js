import{_ as z}from"./LeftSidebar.vuevuetypescriptsetuptruelang-Bkp0VFG-.js";import{_ as j}from"./TagFilter.vuevuetypescriptsetuptruelang-DXYEFTYG.js";import{d as N,g as J,u as Q,h as y,aI as K,l as Z,C as W,aZ as X,a_ as R,a1 as I,a$ as U,o as d,c as h,P as Y,w as T,m as g,N as $,a as v,t as c,O as ee,i as D,s as V,I as te,aF as M,K as ae,J as r,k as se,v as oe,q as O,V as ne,e as A,aL as re,p as w,a6 as L,a0 as ie,a7 as le,f as F,a8 as ue}from"./index-B-S542RM.js";import{u as ce}from"./search-k8SzNgo1.js";import{h as pe}from"./feature-Cs4tKJbl.js";const de=["onClick"],ve={class:"title"},me={class:"count"},_e=N({__name:"BucketFilter",props:{type:{type:String,required:!0},selected:{type:String,required:!0}},setup(m){const _=m,{t:k}=J(),t=Q(),f=y([]),{view:a}=K(_.type),{refetch:S}=Z({handle:(o,l)=>{l?W(k(l),"error"):o&&(f.value=o.mediaBuckets)},document:X,variables:{type:_.type},appApi:!0}),i=o=>{o.type===_.type&&S()};return R(()=>{I.on("media_items_actioned",i)}),U(()=>{I.off("media_items_actioned",i)}),(o,l)=>(d(!0),h(ee,null,Y(f.value,s=>(d(),h("li",{key:s.id,onClick:T(p=>g(a)(g(t),s.id),["prevent"]),class:$({active:m.selected&&s.id===m.selected})},[v("span",ve,c(s.name),1),v("span",me,c(s.itemCount.toLocaleString()),1)],10,de))),128))}}),fe={class:"nav"},ye={class:"title"},he={key:0,class:"count"},ge={class:"title"},Ie={key:0,class:"count"},qe=N({__name:"MediaSidebar",props:{type:{type:String,required:!0},gql:{type:Object,required:!0}},setup(m){const _=D(),{app:k}=V(_),t=m,f=Q(),{counter:a}=V(D()),{parseQ:S}=ce(),i=te({tagIds:[]}),o=y(""),l=y(!1),s=y(""),p=y(""),q=M(()=>{var e,u,n;return t.type===r.IMAGE?((e=a.value)==null?void 0:e.images)??-1:t.type===r.VIDEO?((u=a.value)==null?void 0:u.videos)??-1:t.type===r.AUDIO?((n=a.value)==null?void 0:n.audios)??-1:-1}),B=M(()=>{var e,u,n;return t.type===r.IMAGE?((e=a.value)==null?void 0:e.imagesTrash)??-1:t.type===r.VIDEO?((u=a.value)==null?void 0:u.videosTrash)??-1:t.type===r.AUDIO?((n=a.value)==null?void 0:n.audiosTrash)??-1:-1}),{fetch:C}=ae({handle:e=>{e&&(t.type===r.IMAGE?(a.value.images=e.total,a.value.imagesTrash=e.trash):t.type===r.VIDEO?(a.value.videos=e.total,a.value.videosTrash=e.trash):t.type===r.AUDIO&&(a.value.audios=e.total,a.value.audiosTrash=e.trash))},document:t.gql,variables:()=>({}),appApi:!0});function E(){var n;const e=L.currentRoute.value;o.value=e.meta.group||"",C();const u=ie(((n=e.query.q)==null?void 0:n.toString())??"");S(i,u),s.value=i.tagIds.length===1?i.tagIds[0]:"",l.value=i.trash??!1,p.value=i.bucketId??"",s.value&&p.value&&(s.value=""),l.value&&(p.value="",s.value="")}E(),se(()=>L.currentRoute.value.fullPath,()=>{E()});function G(){const e=le([{name:"trash",op:"",value:"true"}]);F(f,`/${o.value}?q=${ue(e)}`)}function H(){F(f,`/${o.value}`)}const b=e=>{e.type===t.type&&C()};return R(()=>{I.on("media_items_actioned",b)}),U(()=>{I.off("media_items_actioned",b)}),(e,u)=>{const n=_e,P=j,x=z;return d(),oe(x,null,{title:O(()=>[ne(c(e.$t(`page_title.${o.value}`)),1)]),body:O(()=>[v("ul",fe,[v("li",{onClick:T(H,["prevent"]),class:$({active:!s.value&&!p.value&&!l.value})},[v("span",ye,c(e.$t("all")),1),q.value>=0?(d(),h("span",he,c(q.value.toLocaleString()),1)):A("",!0)],2),g(pe)(g(re).MEDIA_TRASH,g(k).osVersion)?(d(),h("li",{key:0,onClick:T(G,["prevent"]),class:$({active:l.value})},[v("span",ge,c(e.$t("trash")),1),B.value>=0?(d(),h("span",Ie,c(B.value.toLocaleString()),1)):A("",!0)],2)):A("",!0),w(n,{type:t.type,selected:p.value},null,8,["type","selected"])]),w(P,{type:t.type,selected:s.value},null,8,["type","selected"])]),_:1})}}});export{qe as _};
