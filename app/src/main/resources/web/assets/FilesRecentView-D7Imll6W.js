import{_ as Ie}from"./ListItemPhone.vuevuetypescriptsetuptruelang-CQmW3Kot.js";import{e as P,c as l,J as _,o,z as v,T as _e,a,k as c,bz as C,l as t,aK as W,t as d,Q as k,n as J,R as Y,a0 as X,G as A,a1 as j,al as Z,q as u,bX as be,bY as we,I as x,d as Ee,u as $e,r as $,g as Fe,s as Ce,i as Se,ax as Te,N as De,O as Ve,P as Le,j as F,U as q,V as Ae,bZ as Pe,br as Re,W as ze,bP as Be,b_ as Oe,F as Me,bO as Ne,bT as Ue,au as Ke,bU as Qe,bV as Ge,bQ as He,a5 as I,bW as We}from"./index-DRp6xo3j.js";import{_ as Je}from"./FieldId.vuevuetypescriptsetuptruelang-slfJ4h1L.js";import{_ as ee}from"./VCheckbox-COaKMA3E.js";import{_ as Xe,u as je,c as qe}from"./key-events-cECSsEaK.js";const Ye={class:"list-item-start"},Ze={class:"number"},xe={key:0,class:"svg",src:C},es=["src"],ss=["src"],ts={key:3,class:"svg",src:C},ns={class:"title"},os={class:"subtitle"},is={class:"list-item-actions"},ls={class:"btn-icon sm"},as={class:"card card-info"},ds={class:"key-value vertical"},rs={class:"key"},cs={class:"value"},ms={key:0,class:"svg",src:C},us=["src"],ps=["src"],vs={key:3,class:"svg",src:C},gs={class:"list-item-actions mobile"},hs={class:"btn-icon sm"},ks={class:"card card-info"},fs={class:"key-value vertical"},ys={class:"key"},Is={class:"value"},_s=P({__name:"FileRecentItem",props:{item:{},index:{},selectedIds:{},shiftEffectingIds:{},shouldSelect:{type:Boolean},isPhone:{type:Boolean},imageErrorIds:{},extensionImageErrorIds:{},handleItemClick:{type:Function},handleMouseOver:{type:Function},toggleSelect:{type:Function},onImageError:{type:Function},onExtensionImageError:{type:Function},downloadFile:{type:Function},clickItem:{type:Function}},setup(R){return(e,s)=>{const p=ee,b=Je,w=Z,f=be,r=we,y=Ie,m=Y("tooltip");return e.isPhone?(o(),_(y,{key:1,"is-selected":e.selectedIds.includes(e.item.id),"is-selecting":e.shiftEffectingIds.includes(e.item.id),"checkbox-checked":e.shiftEffectingIds.includes(e.item.id)?e.shouldSelect:e.selectedIds.includes(e.item.id),onClick:s[12]||(s[12]=i=>e.handleItemClick(i,e.item,e.index,()=>e.clickItem(e.item))),onMouseover:s[13]||(s[13]=i=>e.handleMouseOver(i,e.index)),onCheckboxClick:s[14]||(s[14]=i=>e.toggleSelect(i,e.item,e.index))},{image:u(()=>[a("div",{class:"image",onClick:s[10]||(s[10]=v(i=>e.clickItem(e.item),["stop"]))},[e.extensionImageErrorIds.includes(e.item.id)?(o(),l("img",ms)):!e.imageErrorIds.includes(e.item.id)&&e.item.fileId?(o(),l("img",{key:1,class:"image-thumb",src:t(W)(e.item.fileId,"&w=50&h=50"),onError:s[8]||(s[8]=i=>e.onImageError(e.item.id))},null,40,us)):e.item.extension?(o(),l("img",{key:2,src:`/ficons/${e.item.extension}.svg`,class:"svg",onError:s[9]||(s[9]=i=>e.onExtensionImageError(e.item.id))},null,40,ps)):(o(),l("img",vs))])]),title:u(()=>[A(d(e.item.name),1)]),subtitle:u(()=>[a("span",null,d(t(J)(e.item.size)),1),k((o(),l("span",null,[A(d(t(j)(e.item.updatedAt)),1)])),[[m,t(X)(e.item.updatedAt)]])]),actions:u(()=>[a("div",gs,[k((o(),l("button",{class:"btn-icon sm",onClick:s[11]||(s[11]=v(i=>e.downloadFile(e.item.path),["stop"]))},[c(w)])),[[m,e.$t("download")]]),c(r,null,{content:u(()=>[a("section",ks,[a("div",fs,[a("div",ys,d(e.$t("path")),1),a("div",Is,d(e.item.path),1)])])]),default:u(()=>[k((o(),l("button",hs,[c(f)])),[[m,e.$t("info")]])]),_:1})])]),_:1},8,["is-selected","is-selecting","checkbox-checked"])):(o(),l("section",{key:0,class:_e(["file-item selectable-card",{selected:e.selectedIds.includes(e.item.id),selecting:e.shiftEffectingIds.includes(e.item.id)}]),onClick:s[6]||(s[6]=v(i=>e.handleItemClick(i,e.item,e.index,()=>e.clickItem(e.item)),["stop"])),onMouseover:s[7]||(s[7]=i=>e.handleMouseOver(i,e.index))},[a("div",Ye,[e.shiftEffectingIds.includes(e.item.id)?(o(),_(p,{key:0,class:"checkbox","touch-target":"wrapper",checked:e.shouldSelect,onClick:s[0]||(s[0]=v(i=>e.toggleSelect(i,e.item,e.index),["stop"]))},null,8,["checked"])):(o(),_(p,{key:1,class:"checkbox","touch-target":"wrapper",checked:e.selectedIds.includes(e.item.id),onClick:s[1]||(s[1]=v(i=>e.toggleSelect(i,e.item,e.index),["stop"]))},null,8,["checked"])),a("span",Ze,[c(b,{id:e.index+1,raw:e.item},null,8,["id","raw"])])]),a("div",{class:"image",onClick:s[4]||(s[4]=v(i=>e.clickItem(e.item),["stop"]))},[e.extensionImageErrorIds.includes(e.item.id)?(o(),l("img",xe)):!e.imageErrorIds.includes(e.item.id)&&e.item.fileId?(o(),l("img",{key:1,class:"image-thumb",src:t(W)(e.item.fileId,"&w=50&h=50"),onError:s[2]||(s[2]=i=>e.onImageError(e.item.id))},null,40,es)):e.item.extension?(o(),l("img",{key:2,src:`/ficons/${e.item.extension}.svg`,class:"svg",onError:s[3]||(s[3]=i=>e.onExtensionImageError(e.item.id))},null,40,ss)):(o(),l("img",ts))]),a("div",ns,d(e.item.name),1),a("div",os,[a("span",null,d(t(J)(e.item.size)),1),k((o(),l("span",null,[A(d(t(j)(e.item.updatedAt)),1)])),[[m,t(X)(e.item.updatedAt)]])]),a("div",is,[k((o(),l("button",{class:"btn-icon sm",onClick:s[5]||(s[5]=v(i=>e.downloadFile(e.item.path),["stop"]))},[c(w)])),[[m,e.$t("download")]]),c(r,null,{content:u(()=>[a("section",as,[a("div",ds,[a("div",rs,d(e.$t("path")),1),a("div",cs,d(e.item.path),1)])])]),default:u(()=>[k((o(),l("button",ls,[c(f)])),[[m,e.$t("info")]])]),_:1})])],34))}}}),bs=x(_s,[["__scopeId","data-v-7d9ffcff"]]),ws={key:0,class:"file-item selectable-card-skeleton"},Es={class:"list-item-start"},$s={class:"number"},Fs=P({__name:"FileRecentSkeletonItem",props:{index:{},isPhone:{type:Boolean}},setup(R){return(e,s)=>{const p=Xe;return e.isPhone?(o(),_(p,{key:1,"title-width":"60%",subtitles:[{width:"45%"},{width:"40%"}],"action-count":2})):(o(),l("section",ws,[a("div",Es,[s[0]||(s[0]=a("div",{class:"skeleton-checkbox"},null,-1)),a("span",$s,d(e.index),1)]),s[1]||(s[1]=Ee('<div class="image" data-v-5162838d><div class="skeleton-image lg" data-v-5162838d></div></div><div class="title" data-v-5162838d><div class="skeleton-text lg" style="width:40%;" data-v-5162838d></div></div><div class="subtitle" data-v-5162838d><div class="skeleton-text" style="width:30%;" data-v-5162838d></div></div><div class="list-item-actions" data-v-5162838d><div class="skeleton-text lg" style="width:60px;" data-v-5162838d></div></div>',4))]))}}}),Cs=x(Fs,[["__scopeId","data-v-5162838d"]]),Ss={class:"top-app-bar"},Ts={key:0},Ds={key:1},Vs={key:0,class:"scroller"},Ls={key:2,class:"no-data-placeholder"},Os=P({__name:"FilesRecentView",setup(R){const{t:e}=$e(),s=$([]),p=Pe(),b=Fe(),{app:w,urlTokenKey:f}=Ce(b),r=$([]),{selectedIds:y,allChecked:m,realAllChecked:i,clearSelection:S,toggleAllChecked:se,toggleSelect:te,total:T,checked:z,shiftEffectingIds:ne,handleItemClick:oe,handleMouseOver:ie,selectAll:le,shouldSelect:ae}=je(r),{downloadFile:B,downloadFiles:de}=Te(f),{view:re}=Ge(s,(n,g)=>{b.lightbox={sources:n,index:g,visible:!0}}),{keyDown:O,keyUp:M}=qe(le,S,()=>{}),N=$([]),U=$([]),ce=n=>{N.value.push(n)},me=n=>{U.value.push(n)},{mutate:ue,onDone:pe}=Se({document:Be});pe(n=>{de(n.data.setTempValue.key),S()});const ve=n=>{Ue(n.name)?window.open(Ke(f.value,n.path),"_blank"):Qe(n.name)?re(r.value,n):B(n.path)},{loading:D,fetch:V}=De({handle:async(n,g)=>{if(g)Me(e(g),"error");else{const h=[];for(const L of n.recentFiles)h.push(Ne(L,f.value));r.value=h,T.value=h.length}},document:Oe}),ge=()=>{ue({key:He(),value:JSON.stringify(y.value.map(n=>({path:n})))})},K=n=>{n.status==="done"&&setTimeout(()=>{V()},1e3)},he=n=>{n.forEach(g=>{We(r.value,h=>h.id===g.id)}),S()},Q=n=>{he([n.item])},G=n=>{V()};return Ve(()=>{V(),I.on("upload_task_done",K),I.on("file_deleted",Q),I.on("file_renamed",G),window.addEventListener("keydown",O),window.addEventListener("keyup",M)}),Le(()=>{I.off("upload_task_done",K),I.off("file_deleted",Q),I.off("file_renamed",G),window.removeEventListener("keydown",O),window.removeEventListener("keyup",M)}),(n,g)=>{const h=ee,L=Z,ke=Cs,fe=bs,ye=Y("tooltip");return o(),l(q,null,[a("div",Ss,[c(h,{"touch-target":"wrapper",checked:t(m),indeterminate:!t(m)&&t(z),onChange:t(se)},null,8,["checked","indeterminate","onChange"]),t(y).length?(o(),l("span",Ts,d(n.$t("x_selected",{count:t(i)?t(T).toLocaleString():t(y).length.toLocaleString()})),1)):(o(),l("span",Ds,d(n.$t("recent_files"))+" ("+d(t(T).toLocaleString())+")",1)),t(z)?k((o(),l("button",{key:2,class:"btn-icon",onClick:v(ge,["stop"])},[c(L)])),[[ye,n.$t("download")]]):F("",!0)]),t(D)&&r.value.length===0?(o(),l("div",Vs,[(o(),l(q,null,Ae(20,E=>c(ke,{key:E,index:E,"is-phone":t(p)},null,8,["index","is-phone"])),64))])):F("",!0),r.value.length>0?(o(),_(t(Re),{key:1,class:"scroller","data-key":"id","data-sources":r.value,"estimate-size":t(p)?120:80},{item:u(({index:E,item:H})=>[(o(),_(fe,{key:H.id,item:H,index:E,"selected-ids":t(y),"shift-effecting-ids":t(ne),"should-select":t(ae),"is-phone":t(p),"image-error-ids":N.value,"extension-image-error-ids":U.value,"handle-item-click":t(oe),"handle-mouse-over":t(ie),"toggle-select":t(te),"on-image-error":ce,"on-extension-image-error":me,"download-file":t(B),"click-item":ve},null,8,["item","index","selected-ids","shift-effecting-ids","should-select","is-phone","image-error-ids","extension-image-error-ids","handle-item-click","handle-mouse-over","toggle-select","download-file"]))]),_:1},8,["data-sources","estimate-size"])):F("",!0),!t(D)&&r.value.length===0?(o(),l("div",Ls,d(n.$t(t(ze)(t(D),t(w).permissions,"WRITE_EXTERNAL_STORAGE"))),1)):F("",!0)],64)}}});export{Os as default};
