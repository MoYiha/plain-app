import{e as G,aw as j,r as q,ax as E,cn as R,i as C,co as H,cp as O,R as v,o as g,p as c,k as f,F as y,t as i,l as a,az as T,as as U,j as Y,Y as x,z as J,a as m,O as K,S as $,c as P,U as W,bv as X,T as Z,bu as ee,al as te,aB as ae,a4 as h,bQ as se,H as oe,u as S,L as ne,bf as le,E as A,a1 as de}from"./index-CextXMl7.js";const re={class:"button-group"},ue=G({__name:"AddToTagsModal",props:{type:{type:String,required:!0},tags:{type:Array,default:()=>[]},query:{type:String,required:!0}},setup(d){const{handleSubmit:_}=j(),s=q("add_to_tags"),t=d,{value:o,errorMessage:n}=E("selectedTags",R().test("required","valid.required",e=>e.length),{initialValue:[]}),{mutate:l,loading:p,onDone:F}=C({document:H}),{mutate:L,loading:b,onDone:M}=C({document:O}),k=()=>{h.emit("items_tags_updated",{type:t.type}),h.emit("refetch_tags",t.type),T()};M(k),F(k);function B(e){o.value.includes(e)?se(o.value,r=>r.id===e.id):o.value.push(e)}const D=_(()=>{s.value==="add_to_tags"?L({type:t.type,tagIds:o.value.map(e=>e.id),query:t.query}):l({type:t.type,tagIds:o.value.map(e=>e.id),query:t.query})});return(e,r)=>{const Q=X,V=ee,w=U,z=x,I=J,N=ae;return g(),v(N,{onClose:a(T)},{headline:c(()=>[y(i(e.$t("tags")),1)]),content:c(()=>[m("div",re,[m("button",{class:$({selected:s.value==="add_to_tags"}),onClick:r[0]||(r[0]=u=>s.value="add_to_tags")},i(e.$t("add_to_tags")),3),m("button",{class:$({selected:s.value==="remove_from_tags"}),onClick:r[1]||(r[1]=u=>s.value="remove_from_tags")},i(e.$t("remove_from_tags")),3)]),f(V,null,{default:c(()=>[(g(!0),P(Z,null,W(d.tags,u=>(g(),v(Q,{key:u.id,label:u.name,selected:a(o).includes(u),onClick:ie=>B(u)},null,8,["label","selected","onClick"]))),128))]),_:1}),K(m("div",{class:"invalid-feedback"},i(a(n)?e.$t(a(n)):""),513),[[te,a(n)]])]),actions:c(()=>[f(w,{value:"cancel",onClick:a(T)},{default:c(()=>[y(i(e.$t("cancel")),1)]),_:1},8,["onClick"]),f(I,{value:"save",disabled:a(b)||a(p),onClick:a(D)},{default:c(()=>[a(b)||a(p)?(g(),v(z,{key:0,slot:"icon",indeterminate:""})):Y("",!0),y(" "+i(e.$t("save")),1)]),_:1},8,["disabled","onClick"])]),_:1},8,["onClose"])}}}),ce=oe(ue,[["__scopeId","data-v-d455aaeb"]]),pe=(d,_)=>{const{t:s}=S();return{addToTags:(t,o,n)=>{let l=n;if(!o){if(t.length===0){A(s("select_first"),"error");return}l=`ids:${t.join(",")}`}de(ce,{type:d,tags:_.value,query:l})}}},ge=(d,_=()=>{})=>{const s=q([]),{t}=S(),{loading:o,fetch:n}=ne({handle:async(l,p)=>{p?A(t(p),"error"):l&&(s.value=l.tags,_())},document:le,variables:{type:d}});return{tags:s,loading:o,fetch:n}};export{pe as a,ge as u};
