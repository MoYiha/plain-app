import{m as P,c as o,o as l,a as e,e as j,u as Y,r as b,h as x,bN as ae,D as V,i as z,bO as ie,as as A,t as i,Q as C,R as E,p,v as O,l as r,j as R,Y as w,F as K,K as re,L as ue,M as de,k as S,bz as ce,bP as ve,aL as me,$ as _e,bQ as pe,bR as fe,bS as he,bT as ge,bU as be,a2 as D}from"./index-BEu6YjWH.js";const qe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ye(B,u){return l(),o("svg",qe,u[0]||(u[0]=[e("path",{fill:"currentColor",d:"M6 18H4q-.425 0-.712-.288T3 17t.288-.712T4 16h3q.425 0 .713.288T8 17v3q0 .425-.288.713T7 21t-.712-.288T6 20zm12 0v2q0 .425-.288.713T17 21t-.712-.288T16 20v-3q0-.425.288-.712T17 16h3q.425 0 .713.288T21 17t-.288.713T20 18zM6 6V4q0-.425.288-.712T7 3t.713.288T8 4v3q0 .425-.288.713T7 8H4q-.425 0-.712-.288T3 7t.288-.712T4 6zm12 0h2q.425 0 .713.288T21 7t-.288.713T20 8h-3q-.425 0-.712-.288T16 7V4q0-.425.288-.712T17 3t.713.288T18 4z"},null,-1)]))}const Te=P({name:"material-symbols-fullscreen-exit-rounded",render:ye}),$e={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ke(B,u){return l(),o("svg",$e,u[0]||(u[0]=[e("path",{fill:"currentColor",d:"M5 19h2q.425 0 .713.288T8 20t-.288.713T7 21H4q-.425 0-.712-.288T3 20v-3q0-.425.288-.712T4 16t.713.288T5 17zm14 0v-2q0-.425.288-.712T20 16t.713.288T21 17v3q0 .425-.288.713T20 21h-3q-.425 0-.712-.288T16 20t.288-.712T17 19zM5 5v2q0 .425-.288.713T4 8t-.712-.288T3 7V4q0-.425.288-.712T4 3h3q.425 0 .713.288T8 4t-.288.713T7 5zm14 0h-2q-.425 0-.712-.288T16 4t.288-.712T17 3h3q.425 0 .713.288T21 4v3q0 .425-.288.713T20 8t-.712-.288T19 7z"},null,-1)]))}const Me=P({name:"material-symbols-fullscreen-rounded",render:ke}),Se="/assets/mobile-warning-1YTLhdv_.svg",we={slot:"headline"},Ce={slot:"content"},Le={class:"form-row"},Qe=["data-value","label","selected"],Ie={class:"form-row"},De={class:"form-label"},Ve=["disabled"],ze=["value"],Re={slot:"headline"},Be={class:"form-row"},Fe={class:"form-label"},Ne=["disabled"],Ue=["value"],Ae={slot:"headline"},Ee={class:"form-row"},Ge={slot:"actions"},He=["disabled"],Oe={key:0,slot:"icon",indeterminate:""},Pe=j({__name:"ChangeScreenMirrorQualityModal",setup(B){const{t:u}=Y(),m=b(720),d=b(60),v=b("quality_sd"),_=[{id:"quality_ld",data:{resolution:480,quality:50}},{id:"quality_sd",data:{resolution:720,quality:50}},{id:"quality_hd",data:{resolution:1080,quality:50}},{id:"custom"}],f=[10,20,30,40,50,60,70,80,90,100],T=[480,720,1080];x({handle:(a,c)=>{var n;c?V(u(c),"error"):a&&(m.value=a.screenMirrorQuality.resolution,d.value=a.screenMirrorQuality.quality,v.value=((n=_.find(g=>{var $,I;return(($=g.data)==null?void 0:$.resolution)===m.value&&((I=g.data)==null?void 0:I.quality)===d.value}))==null?void 0:n.id)||"custom")},document:ae});function M(a){return a===10?`10 (${u("low_quality")})`:a===60?`60 (${u("high_quality")})`:a===100?`100 (${u("best_quality")})`:a.toString()}function L(a){const{button:c}=a.detail,n=c.dataset.value;v.value=n;const g=_.find($=>$.id===n);g&&g.data&&(m.value=g.data.resolution,d.value=g.data.quality)}const{mutate:h,loading:Q,onDone:F}=z({document:ie});F(()=>{A()});const N=()=>{h({resolution:m.value,quality:d.value})};return(a,c)=>(l(),o("md-dialog",null,[e("div",we,i(a.$t("change_quality")),1),e("div",Ce,[e("div",Le,[e("md-outlined-segmented-button-set",{onSegmentedButtonSetSelection:L},[(l(),o(C,null,E(_,n=>e("md-outlined-segmented-button",{key:n.id,"data-value":n.id,label:a.$t(n.id),selected:v.value===n.id},null,8,Qe)),64))],32)]),e("div",Ie,[e("label",De,i(a.$t("compress_quality")),1),p(e("md-outlined-select",{"onUpdate:modelValue":c[0]||(c[0]=n=>d.value=n),class:"flex-2","menu-positioning":"fixed",disabled:v.value!=="custom"},[(l(),o(C,null,E(f,n=>e("md-select-option",{key:n,value:n},[e("div",Re,i(M(n)),1)],8,ze)),64))],8,Ve),[[O,d.value,void 0,{number:!0}]])]),e("div",Be,[e("label",Fe,i(a.$t("resolution")),1),p(e("md-outlined-select",{"onUpdate:modelValue":c[1]||(c[1]=n=>m.value=n),class:"flex-2","menu-positioning":"fixed",disabled:v.value!=="custom"},[(l(),o(C,null,E(T,n=>e("md-select-option",{key:n,value:n},[e("div",Ae,i(n)+"p",1)],8,Ue)),64))],8,Ne),[[O,m.value,void 0,{number:!0}]])]),e("div",Ee,i(a.$t("screen_mirror_quality_tips")),1)]),e("div",Ge,[e("md-outlined-button",{value:"cancel",onClick:c[2]||(c[2]=(...n)=>r(A)&&r(A)(...n))},i(a.$t("cancel")),1),e("md-filled-button",{value:"save",disabled:r(Q),autofocus:"",onClick:N},[r(Q)?(l(),o("md-circular-progress",Oe)):R("",!0),w(" "+i(a.$t("save")),1)],8,He)])]))}}),je=K(Pe,[["__scopeId","data-v-dbf32d7d"]]),Ye={class:"screen-mirror"},xe={class:"top-app-bar"},Ke={class:"title"},We={class:"actions"},Je=["disabled"],Xe={class:"content"},Ze={key:0},et={key:0,class:"request-permission"},tt={class:"tap-phone"},st={class:"text"},nt={key:1,class:"request-permission-failed"},ot=j({__name:"ScreenMirrorView",setup(B){let u;const{t:m}=Y(),d=b(!1),v=b(0),_=b(!1),f=b(!1),T=b(!1),M=b(),L=async t=>{d.value=!0,g(t),_.value=!1,v.value=0,clearInterval(u)};let h=!1;const{mutate:Q}=z({document:fe}),F=()=>{f.value=!f.value,f.value||G()},N=()=>{_e(je)},a=()=>{Q(),h=!0},c=t=>{t&&h&&(h=!1,clearInterval(u),U())},n=()=>{const t=M.value;if(!t)return;const s=new Date,k="screenshot-"+[s.getFullYear(),s.getMonth()+1,s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()].join("")+".png";pe(t.toDataURL(),k)};function g(t){const s=M.value;if(!s||f.value&&!T.value)return;T.value=!1;const k=s.getContext("2d"),q=new Image;q.src=URL.createObjectURL(t),q.onload=function(){k&&(s.width=q.width,s.height=q.height,k.drawImage(q,0,0))}}re(()=>{D.on("screen_mirroring",L),D.on("app_socket_connection_changed",c)}),ue(()=>{D.off("screen_mirroring",L),D.off("app_socket_connection_changed",c)});const{mutate:$,loading:I,onDone:W,onError:J}=z({document:he}),{loading:X,refetch:G}=x({handle:(t,s)=>{s?V(m(s),"error"):t.screenMirrorState?(d.value=!0,T.value=!0):(d.value=!1,T.value=!1,U())},options:{fetchPolicy:"no-cache"},document:ge}),Z=()=>{document.getElementsByClassName("screen-mirror")[0].requestFullscreen({navigationUI:"show"})},U=()=>{_.value=!1,f.value=!1,$()},ee=()=>{document.exitFullscreen()};J(t=>{V(m(t.message)),_.value=!0}),W(()=>{v.value=30,u=setInterval(()=>{v.value--,v.value<=0&&(_.value=!0,clearInterval(u))},1e3)});const{mutate:H,loading:te,onDone:se,onError:ne}=z({document:be});return ne(t=>{V(m(t.message))}),se(()=>{_.value=!0,d.value=!1}),(t,s)=>{const k=ce,q=Me,oe=Te,y=de("tooltip");return l(),o("div",Ye,[e("div",xe,[e("div",Ke,i(t.$t("screen_mirror")),1),e("div",We,[d.value?(l(),o(C,{key:0},[p((l(),o("button",{class:"btn-icon",onClick:s[0]||(s[0]=()=>r(G)())},[s[2]||(s[2]=e("md-ripple",null,null,-1)),S(k)])),[[y,t.$t("refresh")]]),p((l(),o("md-outlined-button",{class:"btn-sm",onClick:N},[w(i(t.$t("mirror_quality")),1)])),[[y,t.$t("change_quality")]]),p((l(),o("md-outlined-button",{class:"btn-sm",onClick:n},[w(i(t.$t("screenshot")),1)])),[[y,t.$t("screenshot")]]),p((l(),o("md-outlined-button",{class:"btn-sm",onClick:F},[w(i(t.$t(f.value?"resume":"pause")),1)])),[[y,t.$t(f.value?"resume":"pause")]]),p((l(),o("md-outlined-button",{disabled:r(te),class:"btn-sm btn-stop",onClick:s[1]||(s[1]=(...le)=>r(H)&&r(H)(...le))},[w(i(t.$t("stop_mirror")),1)],8,Je)),[[y,t.$t("stop_mirror")]]),p((l(),o("button",{class:"btn-icon btn-enter-fullscreen",onClick:Z},[s[3]||(s[3]=e("md-ripple",null,null,-1)),S(q)])),[[y,t.$t("fullscreen")]]),p((l(),o("button",{class:"btn-icon btn-exit-fullscreen",onClick:ee},[s[4]||(s[4]=e("md-ripple",null,null,-1)),S(oe)])),[[y,t.$t("exit_fullscreen")]])],64)):r(h)?R("",!0):(l(),o("md-outlined-button",{key:1,class:"btn-sm",onClick:a},i(t.$t("relaunch_app")),1))])]),e("div",Xe,[r(X)||r(I)||r(h)?(l(),o("div",Ze,s[5]||(s[5]=[e("md-circular-progress",{indeterminate:""},null,-1)]))):(l(),o(C,{key:1},[v.value>0&&!r(h)?(l(),o("div",et,[e("div",tt,[S(r(ve))]),e("pre",st,i(t.$t("screen_mirror_request_permission",{seconds:v.value})),1)])):R("",!0),_.value&&!d.value&&!r(h)?(l(),o("div",nt,[S(r(Se)),e("p",null,i(t.$t("screen_mirror_request_permission_failed")),1),e("md-filled-button",{onClick:U},i(t.$t("try_again")),1)])):R("",!0),p(e("canvas",{ref_key:"canvasRef",ref:M,class:"canvas"},null,512),[[me,d.value]])],64))])])}}}),at=K(ot,[["__scopeId","data-v-e53f6dbd"]]);export{at as default};
