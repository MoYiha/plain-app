import{_ as V}from"./LeftSidebar.vuevuetypescriptsetuptruelang-BA-ZKiU0.js";import{_ as A}from"./TagFilter-BtANZhAN.js";import{e as M,f as N,s as Q,g as R,I as z,r as d,L as D,w as F,ae as U,a5 as h,af as j,S as x,o as u,p as C,a6 as k,a4 as E,ag as G,a as s,k as H,c as _,y as S,T as B,j as L,t as a,l as T,V as P,U as J,F as K,B as O,A as $,C as W}from"./index-CuU5w3Fk.js";import{u as X}from"./search-cTEMyIe9.js";import"./more-vert-B9buNtZx.js";const Y={class:"nav"},Z={class:"title"},ee={key:0,class:"count"},te=["onClick"],se={class:"title"},ae={key:0,class:"count"},pe=M({__name:"CallsSidebar",setup(oe){const m=N(),{counter:p}=Q(R()),{parseQ:w}=X(),o=z({tagIds:[]}),n=d(""),l=d(""),c=d(new Map),{fetch:f}=D({handle:e=>{e&&(p.value.calls=e.total,c.value.set("1",e.incoming),c.value.set("2",e.outgoing),c.value.set("3",e.missed))},document:G,variables:()=>({})});function v(e){return c.value.get(e)??-1}function g(){var i;const e=k.currentRoute.value,r=E(((i=e.query.q)==null?void 0:i.toString())??"");w(o,r),n.value=o.type??"",l.value=o.tagIds.length===1?o.tagIds[0]:"",n.value&&(l.value=""),f()}g(),F(()=>k.currentRoute.value,()=>{g()});function b(e){const r=O([{name:"type",op:"",value:e}]);$(m,`/calls?q=${W(r)}`)}function q(){$(m,"/calls")}const y=()=>{f()};return U(()=>{h.on("calls_deleted",y)}),j(()=>{h.off("calls_deleted",y)}),(e,r)=>{const i=A,I=V;return u(),x(I,null,{title:C(()=>[K(a(e.$t("page_title.calls")),1)]),body:C(()=>[s("ul",Y,[s("li",{class:B({active:!l.value&&!n.value}),onClick:S(q,["prevent"])},[s("span",Z,a(e.$t("all")),1),T(p).calls>=0?(u(),_("span",ee,a(T(p).calls.toLocaleString()),1)):L("",!0)],2),(u(),_(J,null,P(["1","2","3"],t=>s("li",{key:t,class:B({active:t===n.value}),onClick:S(ne=>b(t),["prevent"])},[s("span",se,a(e.$t(`call_type.${t}`)),1),v(t)>=0?(u(),_("span",ae,a(v(t).toLocaleString()),1)):L("",!0)],10,te)),64))]),H(i,{type:"CALL",selected:l.value},null,8,["selected"])]),_:1})}}});export{pe as default};
