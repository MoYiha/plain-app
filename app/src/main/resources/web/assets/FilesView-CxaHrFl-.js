import{_ as vn}from"./ListItemPhone.vuevuetypescriptsetuptruelang-CQmW3Kot.js";import{_ as yn}from"./FieldId.vuevuetypescriptsetuptruelang-slfJ4h1L.js";import{_ as _t}from"./VCheckbox-COaKMA3E.js";import{e as j,c as a,J as b,o as n,z as q,T as gt,a as g,k as c,U as L,bz as re,l as o,aK as nt,t as y,Q as T,n as H,R as de,a0 as ot,G as K,a1 as st,bA as it,q as h,I as ue,d as kn,m as ce,j as S,bB as vt,bd as bn,r as B,ah as yt,ai as kt,aj as In,bC as wn,V as Te,f as bt,K as It,w as $e,bD as $n,v as lt,y as Dn,bE as Cn,A as Tn,B as ae,bF as wt,bG as Fn,u as qn,M as Sn,s as De,g as Vn,ao as En,aU as at,bH as Pn,bI as Bn,bJ as Un,bK as Ln,aP as Mn,N as Nn,bL as An,an as rt,i as Rn,ax as zn,O as On,P as Hn,p as Kn,aq as jn,ar as Qn,br as Wn,W as Gn,a2 as le,bM as dt,bN as Jn,F as te,bO as Xn,bP as Zn,a8 as Yn,al as xn,bQ as eo,bR as ut,bS as ct,aZ as mt,bT as pt,au as Ce,bU as ft,bV as to,a4 as no,a5 as X,bW as oo}from"./index-DRp6xo3j.js";import{_ as so,u as io,c as lo}from"./key-events-cECSsEaK.js";import{_ as ao,a as ro}from"./search-rounded-DveNm3Pb.js";import{_ as uo}from"./sort-rounded-CWaGCvOj.js";import{_ as co}from"./content-paste-rounded-D8ngSFWx.js";const mo={class:"list-item-start"},po={class:"number"},fo={key:0,src:"/ficons/folder.svg",class:"svg"},ho={key:0,class:"svg",src:re},_o=["src"],go=["src"],vo={key:3,class:"svg",src:re},yo={class:"title"},ko={class:"subtitle"},bo={key:0},Io={key:1},wo={key:0,src:"/ficons/folder.svg",class:"svg"},$o={key:0,class:"svg",src:re},Do=["src"],Co=["src"],To={key:3,class:"svg",src:re},Fo={key:0},qo={key:1},So=j({__name:"FileListItem",props:{item:{},index:{},selectedIds:{},shiftEffectingIds:{},shouldSelect:{type:Boolean},isPhone:{type:Boolean},imageErrorIds:{},extensionImageErrorIds:{},canPaste:{type:Boolean},handleItemClick:{type:Function},handleMouseOver:{type:Function},toggleSelect:{type:Function},onImageError:{type:Function},onExtensionImageError:{type:Function},viewItem:{type:Function},clickItem:{type:Function}},emits:["downloadDir","downloadFile","uploadFiles","uploadDir","deleteItem","duplicateItem","cutItem","copyItem","pasteItem","copyLink","renameItem"],setup(m,{emit:u}){const l=u;function $(e){l("downloadDir",e)}function _(e){l("downloadFile",e)}function C(e){l("uploadFiles",e)}function i(e){l("uploadDir",e)}function I(e){l("deleteItem",e)}function E(e){l("duplicateItem",e)}function P(e){l("cutItem",e)}function w(e){l("copyItem",e)}function p(e){l("pasteItem",e)}function D(e){l("copyLink",e)}function R(e){l("renameItem",e)}return(e,r)=>{const d=_t,v=yn,M=vn,A=de("tooltip");return e.isPhone?(n(),b(M,{key:1,"is-selected":e.selectedIds.includes(e.item.id),"is-selecting":e.shiftEffectingIds.includes(e.item.id),"checkbox-checked":e.shiftEffectingIds.includes(e.item.id)?e.shouldSelect:e.selectedIds.includes(e.item.id),onClick:r[10]||(r[10]=f=>e.handleItemClick(f,e.item,e.index,()=>e.clickItem(e.item))),onMouseover:r[11]||(r[11]=f=>e.handleMouseOver(f,e.index)),onCheckboxClick:r[12]||(r[12]=f=>e.toggleSelect(f,e.item,e.index))},{image:h(()=>[g("div",{class:"image",onClick:r[9]||(r[9]=f=>e.viewItem(f,e.item))},[e.item.isDir?(n(),a("img",wo)):(n(),a(L,{key:1},[e.extensionImageErrorIds.includes(e.item.id)?(n(),a("img",$o)):!e.imageErrorIds.includes(e.item.id)&&e.item.fileId?(n(),a("img",{key:1,class:"image-thumb",src:o(nt)(e.item.fileId,"&w=50&h=50"),onError:r[7]||(r[7]=f=>e.onImageError(e.item.id))},null,40,Do)):e.item.extension?(n(),a("img",{key:2,src:`/ficons/${e.item.extension}.svg`,class:"svg",onError:r[8]||(r[8]=f=>e.onExtensionImageError(e.item.id))},null,40,Co)):(n(),a("img",To))],64))])]),title:h(()=>[K(y(e.item.name),1)]),subtitle:h(()=>[e.item.isDir?(n(),a("span",Fo,y(e.$t("x_items",e.item.children||0)),1)):(n(),a("span",qo,y(o(H)(e.item.size)),1)),T((n(),a("span",null,[K(y(o(st)(e.item.updatedAt)),1)])),[[A,o(ot)(e.item.updatedAt)]])]),actions:h(()=>[c(it,{item:e.item,"can-paste":e.canPaste,"is-phone":e.isPhone,onDownloadDir:$,onDownloadFile:_,onUploadFiles:C,onUploadDir:i,onDeleteItem:I,onDuplicateItem:E,onCutItem:P,onCopyItem:w,onPasteItem:p,onCopyLink:D,onRenameItem:R},null,8,["item","can-paste","is-phone"])]),_:1},8,["is-selected","is-selecting","checkbox-checked"])):(n(),a("section",{key:0,class:gt(["file-item selectable-card",{selected:e.selectedIds.includes(e.item.id),selecting:e.shiftEffectingIds.includes(e.item.id)}]),onClick:r[5]||(r[5]=q(f=>e.handleItemClick(f,e.item,e.index,()=>e.clickItem(e.item)),["stop"])),onMouseover:r[6]||(r[6]=f=>e.handleMouseOver(f,e.index))},[g("div",mo,[e.shiftEffectingIds.includes(e.item.id)?(n(),b(d,{key:0,class:"checkbox","touch-target":"wrapper",checked:e.shouldSelect,onClick:r[0]||(r[0]=q(f=>e.toggleSelect(f,e.item,e.index),["stop"]))},null,8,["checked"])):(n(),b(d,{key:1,class:"checkbox","touch-target":"wrapper",checked:e.selectedIds.includes(e.item.id),onClick:r[1]||(r[1]=q(f=>e.toggleSelect(f,e.item,e.index),["stop"]))},null,8,["checked"])),g("span",po,[c(v,{id:e.index+1,raw:e.item},null,8,["id","raw"])])]),g("div",{class:"image",onClick:r[4]||(r[4]=f=>e.viewItem(f,e.item))},[e.item.isDir?(n(),a("img",fo)):(n(),a(L,{key:1},[e.extensionImageErrorIds.includes(e.item.id)?(n(),a("img",ho)):!e.imageErrorIds.includes(e.item.id)&&e.item.fileId?(n(),a("img",{key:1,class:"image-thumb",src:o(nt)(e.item.fileId,"&w=50&h=50"),onError:r[2]||(r[2]=f=>e.onImageError(e.item.id))},null,40,_o)):e.item.extension?(n(),a("img",{key:2,src:`/ficons/${e.item.extension}.svg`,class:"svg",onError:r[3]||(r[3]=f=>e.onExtensionImageError(e.item.id))},null,40,go)):(n(),a("img",vo))],64))]),g("div",yo,y(e.item.name),1),g("div",ko,[e.item.isDir?(n(),a("span",bo,y(e.$t("x_items",e.item.children||0)),1)):(n(),a("span",Io,y(o(H)(e.item.size)),1)),T((n(),a("span",null,[K(y(o(st)(e.item.updatedAt)),1)])),[[A,o(ot)(e.item.updatedAt)]])]),c(it,{item:e.item,"can-paste":e.canPaste,"is-phone":e.isPhone,onDownloadDir:$,onDownloadFile:_,onUploadFiles:C,onUploadDir:i,onDeleteItem:I,onDuplicateItem:E,onCutItem:P,onCopyItem:w,onPasteItem:p,onCopyLink:D,onRenameItem:R},null,8,["item","can-paste","is-phone"])],34))}}}),Vo=ue(So,[["__scopeId","data-v-225104f9"]]),Eo={key:0,class:"file-item selectable-card-skeleton"},Po={class:"list-item-start"},Bo={class:"number"},Uo=j({__name:"FileSkeletonItem",props:{index:{},isPhone:{type:Boolean}},setup(m){return(u,l)=>{const $=so;return u.isPhone?(n(),b($,{key:1,"title-width":"60%",subtitles:[{width:"45%"},{width:"40%"}],"action-count":5})):(n(),a("section",Eo,[g("div",Po,[l[0]||(l[0]=g("div",{class:"skeleton-checkbox"},null,-1)),g("span",Bo,y(u.index),1)]),l[1]||(l[1]=kn('<div class="image" data-v-b7f1f9e3><div class="skeleton-image lg" data-v-b7f1f9e3></div></div><div class="title" data-v-b7f1f9e3><div class="skeleton-text lg" style="width:40%;" data-v-b7f1f9e3></div></div><div class="subtitle" data-v-b7f1f9e3><div class="skeleton-text" style="width:30%;" data-v-b7f1f9e3></div></div><div class="list-item-actions" data-v-b7f1f9e3><div class="skeleton-text lg" style="width:240px;" data-v-b7f1f9e3></div></div>',4))]))}}}),Lo=ue(Uo,[["__scopeId","data-v-b7f1f9e3"]]),Mo={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function No(m,u){return n(),a("svg",Mo,u[0]||(u[0]=[g("path",{fill:"currentColor",d:"M19.075 21.9L17.5 20.35q-1.225.8-2.613 1.225T12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12q0-1.5.425-2.887T3.65 6.5L2.075 4.925q-.3-.3-.3-.712t.3-.713t.713-.3t.712.3l17 17q.3.3.3.7t-.3.7t-.712.3t-.713-.3M12 20q1.075 0 2.088-.275t1.962-.825L5.1 7.95q-.55.95-.825 1.962T4 12q0 3.325 2.338 5.663T12 20m0-16q-.825 0-1.612.163T8.85 4.65q-.4.175-.8.05t-.6-.475t-.088-.75t.488-.575q.975-.45 2.012-.675T12 2q2.075 0 3.9.788t3.175 2.137T21.213 8.1T22 12q0 1.1-.225 2.138T21.1 16.15q-.175.375-.575.488t-.75-.088t-.475-.6t.05-.8q.325-.75.488-1.537T20 12q0-3.325-2.337-5.663T12 4m-1.425 9.425"},null,-1)]))}const Ao=ce({name:"material-symbols-hide-source-outline-rounded",render:No}),$t=j({__name:"FileSearchFilters",props:{filter:{type:Object,required:!0}},emits:["filterChange"],setup(m,{emit:u}){const l=m,$=u;function _(){const i={...l.filter};i.text="",$("filterChange",i)}function C(){const i={...l.filter};i.showHidden=!1,$("filterChange",i)}return(i,I)=>{const E=ao,P=Ao,w=vt;return m.filter.text||m.filter.showHidden?(n(),b(w,{key:0},{default:h(()=>[m.filter.text?(n(),b(E,{key:"filter-text",label:m.filter.text,"remove-only":"",onRemove:_},null,8,["label"])):S("",!0),m.filter.showHidden?(n(),b(E,{key:"filter-show-hidden",label:i.$t("show_hidden"),"remove-only":"",onRemove:C},{default:h(()=>[c(P)]),_:1},8,["label"])):S("",!0)]),_:1})):S("",!0)}}}),Ro={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function zo(m,u){return n(),a("svg",Ro,u[0]||(u[0]=[g("path",{fill:"currentColor",d:"M4 20q-.825 0-1.412-.587T2 18V6q0-.825.588-1.412T4 4h5.175q.4 0 .763.15t.637.425L12 6h8q.825 0 1.413.588T22 8v10q0 .825-.587 1.413T20 20zm0-2h16V8h-8.825l-2-2H4zm0 0V6zm10-4v1q0 .425.288.713T15 16t.713-.288T16 15v-1h1q.425 0 .713-.288T18 13t-.288-.712T17 12h-1v-1q0-.425-.288-.712T15 10t-.712.288T14 11v1h-1q-.425 0-.712.288T12 13t.288.713T13 14z"},null,-1)]))}const Oo=ce({name:"material-symbols-create-new-folder-outline-rounded",render:zo}),Ho=j({__name:"FilesKeyboardShortcuts",setup(m){const u=[{keys:["Delete"],description:"delete_selected"},{keys:["modifier","+","Backspace"],description:"delete_selected"},{keys:["modifier","+","A"],description:"select_all"},{keys:["Esc"],description:"clear_selection"},{keys:["Shift","+","Click"],description:"range_select"}];return(l,$)=>{const _=bn;return n(),b(_,{shortcuts:u})}}}),Ko=["onClick"],jo=j({__name:"FilesActionButtons",props:{currentDir:{type:String,required:!0},canPaste:{type:Boolean,required:!0},pasting:{type:Boolean,required:!0},refreshing:{type:Boolean,required:!0},sorting:{type:Boolean,required:!0},sortItems:{type:Array,required:!0},fileSortBy:{type:String,required:!0}},emits:["createDir","uploadFiles","uploadDir","pasteDir","refreshCurrentDir","sort"],setup(m,{emit:u}){const l=u,$=B(!1),_=B(!1);function C(){l("createDir")}function i(p){l("uploadFiles",p)}function I(p){l("uploadDir",p)}function E(){l("pasteDir")}function P(){l("refreshCurrentDir")}function w(p){l("sort",p)}return(p,D)=>{const R=Ho,e=Oo,r=kt,d=In,v=yt,M=co,A=wn,f=uo,N=de("tooltip");return n(),a(L,null,[c(R),T((n(),b(r,{onClick:C},{default:h(()=>[c(e)]),_:1})),[[N,p.$t("create_folder")]]),c(v,{modelValue:$.value,"onUpdate:modelValue":D[2]||(D[2]=F=>$.value=F)},{trigger:h(()=>[T((n(),b(r,null,{default:h(()=>[c(d)]),_:1})),[[N,p.$t("upload")]])]),default:h(()=>[g("div",{class:"dropdown-item",onClick:D[0]||(D[0]=q(F=>{i(m.currentDir),$.value=!1},["stop"]))},y(p.$t("upload_files")),1),g("div",{class:"dropdown-item",onClick:D[1]||(D[1]=q(F=>{I(m.currentDir),$.value=!1},["stop"]))},y(p.$t("upload_folder")),1)]),_:1},8,["modelValue"]),m.canPaste?T((n(),b(r,{key:0,loading:m.pasting,onClick:E},{default:h(()=>[c(M)]),_:1},8,["loading"])),[[N,p.$t("paste")]]):S("",!0),T((n(),b(r,{loading:m.refreshing,onClick:P},{default:h(()=>[c(A)]),_:1},8,["loading"])),[[N,p.$t("refresh")]]),c(v,{modelValue:_.value,"onUpdate:modelValue":D[3]||(D[3]=F=>_.value=F)},{trigger:h(()=>[T((n(),b(r,{loading:m.sorting},{default:h(()=>[c(f)]),_:1},8,["loading"])),[[N,p.$t("sort")]])]),default:h(()=>[(n(!0),a(L,null,Te(m.sortItems,F=>(n(),a("div",{key:F.value,class:gt(["dropdown-item",{selected:F.value===m.fileSortBy}]),onClick:ne=>{w(F.value),_.value=!1}},y(p.$t(F.label)),11,Ko))),128))]),_:1},8,["modelValue"])],64)}}}),Qo={class:"btn-icon"},Wo={class:"filters"},Go={class:"form-row"},Jo={class:"buttons"},Xo={class:"form-label"},Zo=j({__name:"FileSearchInput",props:{parent:{type:String,required:!0},filter:{type:Object,required:!0},getUrl:{type:Function,required:!0},navigateToDir:{type:Function,required:!1},showChips:{type:Boolean,default:!0},isPhone:{type:Boolean,default:!1}},setup(m,{expose:u}){const{buildQ:l}=wt(),$=bt(),_=m,C=B(!1),i=B(!1),I=It({showHidden:!1,linkName:"",text:"",parent:""});$e(_.filter,d=>{Object.assign(I,d)},{immediate:!0,deep:!0}),$e(C,d=>{d&&Object.assign(I,_.filter)}),$e(i,d=>{d&&Object.assign(I,_.filter)});function E(d){return d.startsWith("/")}function P(){var v;const d=(v=I.text)==null?void 0:v.trim();if(d&&E(d)&&_.navigateToDir){_.navigateToDir(d),C.value=!1;return}D(),C.value=!1}function w(){i.value=!0}function p(){var v;const d=(v=I.text)==null?void 0:v.trim();if(d&&E(d)&&_.navigateToDir){_.navigateToDir(d),i.value=!1;return}D(),i.value=!1}function D(){Object.assign(_.filter,I),R(_.filter)}function R(d){ae($,_.getUrl(l(d)))}function e(){I.showHidden=!I.showHidden}function r(d){Object.assign(_.filter,d),ae($,_.getUrl(l(_.filter)))}return u({dismiss:()=>{C.value=!1,i.value=!1}}),(d,v)=>{const M=ro,A=Dn,f=Cn,N=vt,F=Tn,ne=yt,oe=$n,Z=de("tooltip");return n(),a(L,null,[m.showChips?(n(),b($t,{key:0,filter:m.filter,onFilterChange:r},null,8,["filter"])):S("",!0),m.isPhone?S("",!0):(n(),b(ne,{key:1,modelValue:C.value,"onUpdate:modelValue":v[1]||(v[1]=U=>C.value=U),"max-height":400},{trigger:h(()=>[T((n(),a("button",Qo,[c(M)])),[[Z,d.$t("search")]])]),default:h(()=>[g("div",Wo,[g("div",Go,[c(A,{modelValue:I.text,"onUpdate:modelValue":v[0]||(v[0]=U=>I.text=U),label:d.$t("keywords"),onKeyup:lt(P,["enter"])},null,8,["modelValue","label"])]),c(N,null,{default:h(()=>[c(f,{key:"chip-show-hidden",label:d.$t("show_hidden"),selected:I.showHidden,onClick:e},null,8,["label","selected"])]),_:1}),g("div",Jo,[c(F,{onClick:q(P,["stop"])},{default:h(()=>[K(y(d.$t("search")),1)]),_:1})])])]),_:1},8,["modelValue"])),m.isPhone?T((n(),a("button",{key:2,class:"btn-icon mobile-search-btn",onClick:w},[c(M)])),[[Z,d.$t("search")]]):S("",!0),m.isPhone?(n(),b(oe,{key:3,modelValue:i.value,"onUpdate:modelValue":v[3]||(v[3]=U=>i.value=U),title:d.$t("search"),"show-footer":""},{footer:h(()=>[c(F,{class:"search-apply-btn",onClick:p},{default:h(()=>[K(y(d.$t("search")),1)]),_:1})]),default:h(()=>[g("label",Xo,y(d.$t("keywords")),1),c(A,{modelValue:I.text,"onUpdate:modelValue":v[2]||(v[2]=U=>I.text=U),onKeyup:lt(p,["enter"])},null,8,["modelValue"]),c(N,{style:{"margin-block-start":"16px"}},{default:h(()=>[c(f,{label:d.$t("show_hidden"),selected:I.showHidden,onClick:e},null,8,["label","selected"])]),_:1})]),_:1},8,["modelValue","title"])):S("",!0)],64)}}}),Yo=ue(Zo,[["__scopeId","data-v-dbf3b297"]]),xo={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function es(m,u){return n(),a("svg",xo,u[0]||(u[0]=[g("path",{fill:"currentColor",d:"m12 14l-2.35 2.35q.2.375.275.8T10 18q0 1.65-1.175 2.825T6 22t-2.825-1.175T2 18t1.175-2.825T6 14q.425 0 .85.075t.8.275L10 12L7.65 9.65q-.375.2-.8.275T6 10q-1.65 0-2.825-1.175T2 6t1.175-2.825T6 2t2.825 1.175T10 6q0 .425-.075.85t-.275.8L20.6 18.6q.675.675.3 1.538T19.575 21q-.275 0-.537-.112t-.463-.313zm3-3l-2-2l5.575-5.575q.2-.2.463-.312T19.574 3q.95 0 1.313.875t-.313 1.55zM6 8q.825 0 1.413-.587T8 6t-.587-1.412T6 4t-1.412.588T4 6t.588 1.413T6 8m6 4.5q.2 0 .35-.15t.15-.35t-.15-.35t-.35-.15t-.35.15t-.15.35t.15.35t.35.15M6 20q.825 0 1.413-.587T8 18t-.587-1.412T6 16t-1.412.588T4 18t.588 1.413T6 20"},null,-1)]))}const ts=ce({name:"material-symbols-content-cut-rounded",render:es}),ns={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function os(m,u){return n(),a("svg",ns,u[0]||(u[0]=[g("path",{fill:"currentColor",d:"M9 18q-.825 0-1.412-.587T7 16V4q0-.825.588-1.412T9 2h9q.825 0 1.413.588T20 4v12q0 .825-.587 1.413T18 18zm0-2h9V4H9zm-4 6q-.825 0-1.412-.587T3 20V7q0-.425.288-.712T4 6t.713.288T5 7v13h10q.425 0 .713.288T16 21t-.288.713T15 22zm4-6V4z"},null,-1)]))}const ss=ce({name:"material-symbols-content-copy-outline-rounded",render:os}),is=Fn("files",{state:()=>({selectedFiles:[],isCut:!1})}),ls={class:"top-app-bar"},as={class:"title"},rs={key:0},ds={key:1,class:"breadcrumb"},us={key:0},cs=["onClick"],ms={key:0},ps=["onClick"],fs={key:0,class:"actions"},hs={key:0,class:"secondary-actions"},_s={key:2,class:"scroller-wrapper"},gs={class:"scroller"},vs={key:1,class:"no-data-placeholder"},ht=1e4,ys=j({__name:"FilesView",setup(m){var xe;const u=Kn("isPhone"),{t:l}=qn(),$=B([]),{parseQ:_,buildQ:C}=wt(),i=It({linkName:"",showHidden:!1,text:"",parent:""}),E=Sn().query,P=B(""),w=B([]),{selectedIds:p,allChecked:D,realAllChecked:R,clearSelection:e,toggleAllChecked:r,toggleSelect:d,total:v,checked:M,shiftEffectingIds:A,handleItemClick:f,handleMouseOver:N,selectAll:F,shouldSelect:ne}=io(w),{keyDown:oe,keyUp:Z}=lo(F,e,()=>{He()}),U=B(!1),se=B(!1),Fe=B([]),qe=B([]),Dt=t=>{Fe.value.push(t)},Ct=t=>{qe.value.push(t)},Se=jn(),me=bt(),{fileSortBy:Y}=De(me),Ve=Vn(),{app:Ee,urlTokenKey:z,uploads:pe}=De(Ve),{selectedFiles:Tt,isCut:Ft}=De(is()),{dropping:qt,fileDragEnter:Pe,fileDragLeave:Be,dropFiles:St}=En(pe),x=at(()=>Pn(i.linkName,Ee.value)),{createPath:Vt,createVariables:Et,createMutation:Pt}=Bn(z,w),{renameItem:Bt,renameDone:Ut,renameMutation:Lt,renameVariables:Mt}=Un(()=>{Q()}),{internal:Ue,sdcard:Le,usb:Nt,refetch:fe}=Ln(),{downloadFile:he,downloadDir:At,downloadFiles:Rt}=zn(z),{view:Me}=to($,(t,s)=>{Ve.lightbox={sources:t,index:s,visible:!0}}),zt=B(parseInt(((xe=E.page)==null?void 0:xe.toString())??"1")),Ot=at(()=>{const t=[];let s=i.parent;for(;s&&s!==x.value;)t.unshift({path:s,name:Mn(s)}),s=s.substring(0,s.lastIndexOf("/"));return t.unshift({path:x.value,name:Zt()}),t}),Ne=B(!0),{loading:_e,fetch:Q}=Nn({handle:async(t,s)=>{if(Ne.value=!1,U.value=!1,se.value=!1,s)te(l(s),"error");else{const V=[];for(const W of t.files)V.push(Xn(W,z.value));w.value=V,v.value=V.length}},document:Jn,variables:()=>({root:x.value,offset:(zt.value-1)*ht,limit:ht,query:P.value,sortBy:Y.value}),options:{fetchPolicy:"cache-and-network"}}),{loading:Ae,canPaste:ge,copy:ve,cut:Re,paste:ye}=An(w,Ft,Tt,Q,fe),{input:Ht,upload:Kt,uploadChanged:ze}=rt(pe),{input:jt,upload:Qt,uploadChanged:Oe}=rt(pe),{loading:Wt,mutate:Gt,onDone:Jt}=Rn({document:Zn});Jt(t=>{Rt(t.data.setTempValue.key),e()});const Xt=()=>{Gt({key:eo(),value:JSON.stringify(p.value.map(t=>({path:t})))})},ke=t=>{t.forEach(s=>{oo(w.value,V=>V.id===s.id)}),v.value=w.value.length,e(),fe()},He=()=>{le(ut,{files:w.value.filter(t=>p.value.includes(t.id)),onDone:t=>{ke(t)}})};function Zt(){if(i.linkName==="sdcard")return l("sdcard");if(i.linkName==="app")return l("app_data");if(i.linkName.startsWith("usb")){const t=parseInt(i.linkName.substring(3));return`${l("usb_storage")} ${t}`}return l("internal_storage")}function Ke(){var t,s,V,W;if(i.linkName==="sdcard")return`${l("storage_free_total",{free:H(((t=Le.value)==null?void 0:t.freeBytes)??0),total:H(((s=Le.value)==null?void 0:s.totalBytes)??0)})}`;if(i.linkName==="app")return l("app_data");if(i.linkName.startsWith("usb")){const G=parseInt(i.linkName.substring(3)),O=Nt.value[G-1];return`${l("storage_free_total",{free:H((O==null?void 0:O.freeBytes)??0),total:H((O==null?void 0:O.totalBytes)??0)})}`}return`${H(((V=Ue.value)==null?void 0:V.freeBytes)??0)} / ${H(((W=Ue.value)==null?void 0:W.totalBytes)??0,!0,0)}`}function ee(t){e(),i.parent=t,i.text="";const s=C(i);ae(me,ie(s))}function ie(t){return t?`/files?q=${t}`:"/files"}function Yt(t){if(t.isDir){ee(t.path);return}if(ct(t.name)){const s=mt(z.value,t.path);window.open(`/text-file?id=${encodeURIComponent(s)}`,"_blank")}else pt(t.name)?window.open(Ce(z.value,t.path),"_blank"):ft(t.name)?Me(w.value,t):he(t.path)}function xt(t,s){if(!s.isDir)if(t.stopPropagation(),ct(s.name)){const V=mt(z.value,s.path);window.open(`/text-file?id=${encodeURIComponent(V)}`,"_blank")}else pt(s.name)?window.open(Ce(z.value,s.path),"_blank"):ft(s.name)?Me(w.value,s):he(s.path)}function je(t){Y.value!==t&&(se.value=!0,Y.value=t)}function Qe(){U.value=!0,Q()}const We=()=>{Vt.value=i.parent,le(dt,{title:l("create_folder"),placeholder:l("name"),mutation:Pt,getVariables:Et})};function be(t){Kt(t)}function Ie(t){Qt(t)}function en(){ve(p.value),e()}function tn(){Re(p.value),e()}function Ge(){ye(i.parent)}function nn(t){ve([t.id]),ye(i.parent)}function on(t){Re([t.id])}function sn(t){ve([t.id])}function ln(t){const s=Ce(z.value,t.path);navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(s).then(()=>{te(l("link_copied"),"success")}).catch(()=>{Je(s)}):Je(s)}function Je(t){try{const s=document.createElement("textarea");s.value=t,s.style.position="fixed",s.style.left="-999999px",s.style.top="-999999px",document.body.appendChild(s),s.focus(),s.select();const V=document.execCommand("copy");document.body.removeChild(s),V?te(l("link_copied"),"success"):te(l("copy_failed"),"error")}catch(s){console.error("Failed to copy text: ",s),te(l("copy_failed"),"error")}}function an(t){ye(t.path)}function rn(t){Bt.value=t,le(dt,{title:l("rename"),placeholder:l("name"),value:t.name,mutation:Lt,getVariables:Mt,done:Ut})}function dn(t){le(ut,{files:[t],onDone:ke})}function un(t){Object.assign(i,t);const s=C(i);ae(me,ie(s))}const Xe=t=>{t.status==="done"&&setTimeout(()=>{Q(),fe()},1e3)},Ze=t=>{ke([t.item])},Ye=t=>{Q()};function cn(t){St(t,i.parent,()=>!0)}return On(()=>{var t;P.value=no(((t=E.q)==null?void 0:t.toString())??""),_(i,P.value),Q(),X.on("upload_task_done",Xe),X.on("file_deleted",Ze),X.on("file_renamed",Ye),window.addEventListener("keydown",oe),window.addEventListener("keyup",Z)}),Hn(()=>{X.off("upload_task_done",Xe),X.off("file_deleted",Ze),X.off("file_renamed",Ye),window.removeEventListener("keydown",oe),window.removeEventListener("keyup",Z)}),(t,s)=>{const V=_t,W=ss,G=kt,O=ts,mn=Yn,pn=xn,et=Yo,tt=jo,fn=$t,hn=Lo,_n=Vo,J=de("tooltip");return n(),a(L,null,[g("div",ls,[c(V,{"touch-target":"wrapper",checked:o(D),indeterminate:!o(D)&&o(M),onChange:o(r)},null,8,["checked","indeterminate","onChange"]),g("div",as,[o(p).length?(n(),a("span",rs,y(t.$t("x_selected",{count:o(R)?o(v).toLocaleString():o(p).length.toLocaleString()})),1)):(n(),a("div",ds,[(n(!0),a(L,null,Te(Ot.value,(k,we)=>(n(),a(L,{key:k.path},[we===0?(n(),a(L,{key:0},[k.path===i.parent?T((n(),a("span",us,[K(y(k.name)+" ("+y(o(v))+")",1)])),[[J,Ke()]]):T((n(),a("a",{key:1,href:"#",onClick:q(gn=>ee(k.path),["stop","prevent"])},[K(y(k.name),1)],8,cs)),[[J,Ke()]])],64)):(n(),a(L,{key:1},[k.path===i.parent?(n(),a("span",ms,y(k.name)+" ("+y(o(v))+")",1)):(n(),a("a",{key:1,href:"#",onClick:q(gn=>ee(k.path),["stop","prevent"])},y(k.name),9,ps))],64))],64))),128))])),o(M)?(n(),a(L,{key:2},[T((n(),b(G,{onClick:q(en,["stop"])},{default:h(()=>[c(W)]),_:1})),[[J,t.$t("copy")]]),T((n(),b(G,{onClick:q(tn,["stop"])},{default:h(()=>[c(O)]),_:1})),[[J,t.$t("cut")]]),T((n(),b(G,{onClick:q(He,["stop"])},{default:h(()=>[c(mn)]),_:1})),[[J,t.$t("delete")]]),T((n(),b(G,{loading:o(Wt),onClick:q(Xt,["stop"])},{default:h(()=>[c(pn)]),_:1},8,["loading"])),[[J,t.$t("download")]])],64)):S("",!0)]),!o(u)&&!o(M)?(n(),a("div",fs,[c(et,{filter:i,parent:x.value,"get-url":ie,"navigate-to-dir":ee,"show-chips":!o(u),"is-phone":o(u)},null,8,["filter","parent","show-chips","is-phone"]),c(tt,{"current-dir":i.parent,"can-paste":o(ge)(),pasting:o(Ae),refreshing:U.value,sorting:se.value,"sort-items":o(Se),"file-sort-by":o(Y),onCreateDir:We,onUploadFiles:be,onUploadDir:Ie,onPasteDir:Ge,onRefreshCurrentDir:Qe,onSort:je},null,8,["current-dir","can-paste","pasting","refreshing","sorting","sort-items","file-sort-by"])])):S("",!0)]),o(u)&&!o(M)?(n(),a("div",hs,[c(et,{filter:i,parent:x.value,"get-url":ie,"navigate-to-dir":ee,"show-chips":!o(u),"is-phone":o(u)},null,8,["filter","parent","show-chips","is-phone"]),c(tt,{"current-dir":i.parent,"can-paste":o(ge)(),pasting:o(Ae),refreshing:U.value,sorting:se.value,"sort-items":o(Se),"file-sort-by":o(Y),onCreateDir:We,onUploadFiles:be,onUploadDir:Ie,onPasteDir:Ge,onRefreshCurrentDir:Qe,onSort:je},null,8,["current-dir","can-paste","pasting","refreshing","sorting","sort-items","file-sort-by"])])):S("",!0),o(u)?(n(),b(fn,{key:1,class:"mobile-search-filters",filter:i,onFilterChange:un},null,8,["filter"])):S("",!0),o(_e)&&Ne.value?(n(),a("div",_s,[g("div",gs,[(n(),a(L,null,Te(20,k=>c(hn,{key:k,index:k,"is-phone":o(u)},null,8,["index","is-phone"])),64))])])):S("",!0),g("div",{class:"scroller-wrapper",onDragover:s[3]||(s[3]=q((...k)=>o(Pe)&&o(Pe)(...k),["stop","prevent"]))},[T(g("div",{class:"drag-mask",onDrop:q(cn,["stop","prevent"]),onDragleave:s[0]||(s[0]=q((...k)=>o(Be)&&o(Be)(...k),["stop","prevent"]))},y(t.$t("release_to_send_files")),545),[[Qn,o(qt)]]),w.value.length>0?(n(),b(o(Wn),{key:0,class:"scroller","data-key":"id","data-sources":w.value,"estimate-size":80},{item:h(({index:k,item:we})=>[c(_n,{item:we,index:k,"selected-ids":o(p),"shift-effecting-ids":o(A),"should-select":o(ne),"is-phone":o(u),"image-error-ids":Fe.value,"extension-image-error-ids":qe.value,"can-paste":o(ge)(),"handle-item-click":o(f),"handle-mouse-over":o(N),"toggle-select":o(d),"on-image-error":Dt,"on-extension-image-error":Ct,"view-item":xt,"click-item":Yt,onDownloadDir:o(At),onDownloadFile:o(he),onUploadFiles:be,onUploadDir:Ie,onDeleteItem:dn,onDuplicateItem:nn,onCutItem:on,onCopyItem:sn,onPasteItem:an,onCopyLink:ln,onRenameItem:rn},null,8,["item","index","selected-ids","shift-effecting-ids","should-select","is-phone","image-error-ids","extension-image-error-ids","can-paste","handle-item-click","handle-mouse-over","toggle-select","onDownloadDir","onDownloadFile"])]),_:1},8,["data-sources"])):S("",!0),!o(_e)&&w.value.length===0?(n(),a("div",vs,y(t.$t(o(Gn)(o(_e),o(Ee).permissions,"WRITE_EXTERNAL_STORAGE"))),1)):S("",!0),g("input",{ref_key:"fileInput",ref:Ht,style:{display:"none"},type:"file",multiple:"",onChange:s[1]||(s[1]=(...k)=>o(ze)&&o(ze)(...k))},null,544),g("input",{ref_key:"dirFileInput",ref:jt,style:{display:"none"},type:"file",multiple:"",webkitdirectory:"",mozdirectory:"",directory:"",onChange:s[2]||(s[2]=(...k)=>o(Oe)&&o(Oe)(...k))},null,544)],32)],64)}}}),Fs=ue(ys,[["__scopeId","data-v-41c48006"]]);export{Fs as default};
