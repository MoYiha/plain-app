import{_ as Be}from"./more-vert-XZtlvs7x.js";import{g as _e,h as S,K as pe,C as D,cG as Ke,d as xe,u as He,s as We,i as Pe,I as je,J as Je,aF as ne,j as le,L as Oe,M as Ye,c as l,a as t,m as e,t as v,O as ce,x as A,w as m,p as r,e as E,P as Xe,v as Ze,q as ie,n as es,Q as ss,a1 as h,cH as ts,cI as os,cJ as as,cK as ns,S as ls,o as a,N as cs,U as is,V as ds,W as rs,aA as us,bf as _s,X as ps,F as vs,G as ms,Y as hs,a6 as de,cd as fs,f as re,a0 as gs,ae as ks,a2 as ys,a3 as bs,a4 as ws,H as Ss}from"./index-B-S542RM.js";import{_ as $s,a as Cs}from"./SearchInput-D0d2xIiv.js";import{_ as Ts,a as Ls}from"./add-notes-outline-rounded-DjCnlzSZ.js";import{u as Is}from"./feeds--RKt1Kst.js";import{u as Fs,b as qs,a as As}from"./key-events-D1Kh05Em.js";import{a as Es}from"./tags-x91i2rzh.js";import{u as Ds}from"./search-k8SzNgo1.js";import"./search-rounded-TCa6qTC1.js";import"./rss-feed-rounded-DzJ3TVan.js";import"./vee-validate.esm-D5u4WlYW.js";const Ms=(u,_,$)=>{const{t:C}=_e(),g=S(1),M=100,i=S(!1),{loading:T,fetch:Q}=pe({handle:(k,L)=>{if(L)D(C(L),"error");else if(k){k.items.length<M&&(i.value=!0);const I=k.items;g.value===1?u.value=I:u.value=u.value.concat(I),$.value=k.total}},document:Ke,variables:()=>({offset:(g.value-1)*M,limit:M,query:_.value}),appApi:!0});return{page:g,noMore:i,loading:T,fetch:Q,loadMore:()=>{i.value||T.value||g.value++}}},f=u=>(vs("data-v-c75d0d53"),u=u(),ms(),u),Ns={class:"top-app-bar"},Qs=["checked","indeterminate"],Us={class:"title"},Vs={key:0},Gs={key:1},Rs=f(()=>t("md-ripple",null,null,-1)),zs=f(()=>t("md-ripple",null,null,-1)),Bs={key:0,indeterminate:"",class:"spinner-sm"},Ks=f(()=>t("md-ripple",null,null,-1)),xs={class:"actions"},Hs={key:0,indeterminate:"",class:"spinner-sm"},Ws=["disabled"],Ps=f(()=>t("md-ripple",null,null,-1)),js={key:0,class:"scroller"},Js=hs('<div class="title" data-v-c75d0d53><div class="checkbox" data-v-c75d0d53><div class="skeleton-checkbox" data-v-c75d0d53></div></div><div class="text" data-v-c75d0d53><div class="skeleton-text skeleton-title" data-v-c75d0d53></div></div></div>',1),Os={class:"subtitle"},Ys={class:"number"},Xs=f(()=>t("div",{class:"info"},[t("div",{class:"skeleton-text skeleton-info"})],-1)),Zs=f(()=>t("div",{class:"image"},[t("div",{class:"skeleton-image"})],-1)),et=["href"],st=["onClick","onMouseover"],tt={class:"title"},ot=["onClick","checked"],at=["onClick","checked"],nt={class:"text"},lt={class:"subtitle"},ct={class:"number"},it={class:"info"},dt=["onClick"],rt=f(()=>t("span",null,"Â·",-1)),ut={class:"time"},_t={class:"btn-icon sm",style:{display:"none"}},pt=f(()=>t("md-ripple",null,null,-1)),vt=["src"],mt={key:0,indeterminate:"",class:"spinner-sm"},ht={key:2,class:"no-data-placeholder"},ue=100,ft=xe({__name:"FeedsSidebar2",setup(u){var oe;const _=He(),{feedsSyncing:$}=We(Pe()),{t:C}=_e(),g=je({tagIds:[]}),{parseQ:M}=Ds(),i=Je.FEED_ENTRY,T=ss(),Q=T.query,k=S(parseInt(((oe=Q.page)==null?void 0:oe.toString())??"1")),L=S([]),I=S([]),R=ne(()=>{const s={};return I.value.forEach(o=>{s[o.id]=o}),s}),y=S([]),b=S(""),{selectedIds:d,allChecked:z,realAllChecked:F,selectRealAll:ve,allCheckedAlertVisible:me,clearSelection:U,toggleAllChecked:B,toggleSelect:K,total:w,checked:x,shiftEffectingIds:H,handleItemClick:he,handleMouseOver:fe,selectAll:ge,shouldSelect:ke}=Fs(y),ye=s=>{k.value=s;const o=T.query.q;re(_,o?`/feeds?page=${s}&q=${o}`:`/feeds?page=${s}`)},{keyDown:W,keyUp:P}=As(w,ue,k,ge,U,ye,()=>{O(d.value,F.value,w.value,b.value)}),{page:j,loading:G,loadMore:be,fetch:we,noMore:J}=Ms(y,b,w),{addToTags:Se}=Es(i,L),N=()=>{j.value=1,we()},{deleteItems:O}=qs(ts,()=>{U(),N(),y.value.some(s=>s.tags.length)&&h.emit("refetch_tags",i),h.emit("feed_entries_deleted")}),$e=ne(()=>de.currentRoute.value.path!=="/feeds"),{resizeWidth:Y}=fs(300,()=>_.sidebar2Width,s=>{_.sidebar2Width=s}),{mutate:X,loading:Ce,onDone:Te}=le({document:os,appApi:!0});function Le(){if(F)X({query:b.value});else{if(d.value.length===0){D(C("select_first"),"error");return}X({query:`ids:${d.value.join(",")}`})}}Te(()=>{D(C("saved"))});function Ie(s){return s?`/feeds?q=${s}`:"/feeds"}const{fetch:Fe}=pe({handle:async(s,o)=>{o?D(C(o),"error"):s&&(L.value=s.tags,I.value=s.feeds)},document:as,variables:{type:i},appApi:!0});function Z(s){const o=de.currentRoute.value.query.q;return o?`/feeds/${s.feedId}/entries/${s.id}?q=${o}`:`/feeds/${s.feedId}/entries/${s.id}`}function qe(s){re(_,Z(s))}const{viewFeed:Ae}=Is(_),{mutate:Ee}=le({document:ns,appApi:!0});function De(){$.value=!0,Ee({id:""})}const ee=s=>{$.value=!1,N(),s.error?D(s.error,"error"):D(C("feeds_synced"))},se=s=>{s.type===i&&(U(),N())},te=s=>{s.type===i&&N()};return Oe(()=>{var o,V;const s=(o=document.getElementsByClassName("scroller"))==null?void 0:o[0];s&&(s.scrollTop=0),b.value=gs(((V=Q.q)==null?void 0:V.toString())??""),M(g,b.value),Fe(),N(),h.on("item_tags_updated",te),h.on("items_tags_updated",se),h.on("feeds_fetched",ee),window.addEventListener("keydown",W),window.addEventListener("keyup",P)}),Ye(()=>{j.value=1,J.value=!1,h.off("item_tags_updated",te),h.off("items_tags_updated",se),h.off("feeds_fetched",ee),window.removeEventListener("keydown",W),window.removeEventListener("keyup",P)}),(s,o)=>{const V=ks,Me=ys,Ne=Ts,Qe=$s,Ue=Ls,Ve=Cs,Ge=bs,Re=ws,ze=Be,q=ls("tooltip");return a(),l("aside",{class:"sidebar2",style:es({width:e(T).params.id?e(_).sidebar2Width+"px":"auto"})},[t("div",Ns,[t("md-checkbox",{"touch-target":"wrapper",onChange:o[0]||(o[0]=(...c)=>e(B)&&e(B)(...c)),checked:e(z),indeterminate:!e(z)&&e(x)},null,40,Qs),t("div",Us,[e(d).length?(a(),l("span",Vs,v(s.$t("x_selected",{count:e(F)?e(w).toLocaleString():e(d).length.toLocaleString()})),1)):(a(),l("span",Gs,v(s.$t("page_title.feeds"))+" ("+v(e(w).toLocaleString())+")",1)),e(x)?(a(),l(ce,{key:2},[A((a(),l("button",{class:"btn-icon",onClick:o[1]||(o[1]=m(c=>e(O)(e(d),e(F),e(w),b.value),["stop"]))},[Rs,r(V)])),[[q,s.$t("delete")]]),A((a(),l("button",{class:"btn-icon",onClick:o[2]||(o[2]=m(c=>e(Se)(e(d),e(F),b.value),["stop"]))},[zs,r(Me)])),[[q,s.$t("add_to_tags")]]),e(Ce)?(a(),l("md-circular-progress",Bs)):A((a(),l("button",{key:1,class:"btn-icon sm",onClick:m(Le,["prevent"])},[Ks,r(Ne)])),[[q,s.$t("save_to_notes")]])],64)):E("",!0)]),t("div",xs,[r(Qe,{filter:g,tags:L.value,feeds:I.value,"show-chips":!$e.value,"get-url":Ie,"show-today":!0},null,8,["filter","tags","feeds","show-chips"]),e($)?(a(),l("md-circular-progress",Hs)):A((a(),l("button",{key:1,class:"btn-icon",disabled:e($),onClick:m(De,["prevent"])},[Ps,r(Ue)],8,Ws)),[[q,s.$t("sync_feeds")]])])]),r(Ve,{limit:ue,total:e(w),"all-checked-alert-visible":e(me),"real-all-checked":e(F),"select-real-all":e(ve),"clear-selection":e(U)},null,8,["total","all-checked-alert-visible","real-all-checked","select-real-all","clear-selection"]),e(G)&&y.value.length===0?(a(),l("div",js,[(a(),l(ce,null,Xe(20,c=>t("section",{class:"feed-item selectable-card-skeleton",key:c},[Js,t("div",Os,[t("span",Ys,v(c),1),Xs]),Zs])),64))])):E("",!0),y.value.length>0?(a(),Ze(e(_s),{key:1,class:"scroller","data-key":"id","data-sources":y.value,"estimate-size":100,onTobottom:e(be)},{item:ie(({index:c,item:n})=>{var ae;return[t("a",{class:"item-link",href:Z(n)},[t("article",{class:cs(["feed-item selectable-card",{selected:e(d).includes(n.id)||n.id==s.$route.params.id,selecting:e(H).includes(n.id)}]),onClick:m(p=>e(he)(p,n,c,()=>{qe(n)}),["stop","prevent"]),onMouseover:p=>e(fe)(p,c)},[t("div",tt,[e(H).includes(n.id)?(a(),l("md-checkbox",{key:0,class:"checkbox","touch-target":"wrapper",onClick:m(p=>e(K)(p,n,c),["stop"]),checked:e(ke)},null,8,ot)):(a(),l("md-checkbox",{key:1,class:"checkbox","touch-target":"wrapper",onClick:m(p=>e(K)(p,n,c),["stop"]),checked:e(d).includes(n.id)},null,8,at)),t("div",nt,v(n.title||s.$t("no_content")),1)]),t("div",lt,[t("span",ct,[r(Ge,{id:c+1,raw:n},null,8,["id","raw"])]),t("div",it,[t("a",{onClick:m(p=>e(Ae)(R.value[n.feedId]),["stop","prevent"])},v((ae=R.value[n.feedId])==null?void 0:ae.name),9,dt),rt,A((a(),l("span",ut,[ds(v(e(rs)(n.publishedAt)),1)])),[[q,e(is)(n.publishedAt)]]),r(Re,{tags:n.tags,type:e(i),"only-links":!0},null,8,["tags","type"])])]),A((a(),l("button",_t,[pt,r(ze)])),[[q,s.$t("actions")]]),n.image?(a(),l("img",{key:0,class:"image",src:e(us)(n.image,"&w=200&h=200")},null,8,vt)):E("",!0)],42,st)],8,et)]}),footer:ie(()=>[e(J)?E("",!0):(a(),l("md-circular-progress",mt))]),_:1},8,["data-sources","onTobottom"])):E("",!0),!e(G)&&y.value.length===0?(a(),l("div",ht,v(s.$t(e(ps)(e(G)))),1)):E("",!0),t("div",{class:"sidebar-drag-indicator",onMousedown:o[3]||(o[3]=(...c)=>e(Y)&&e(Y)(...c))},null,32)],4)}}}),Ft=Ss(ft,[["__scopeId","data-v-c75d0d53"]]);export{Ft as default};
