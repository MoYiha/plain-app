import{m as V,c as m,o as _,a as o,e as B,at as N,r as $,au as Q,cf as z,i as q,cg as I,ch as j,t as v,p as G,k,N as R,Q as H,R as E,l as t,aj as J,aw as f,j as K,X,a1 as S,bK as Z,F as x,u as L,J as O,bb as P,D as M,Z as U}from"./index-BaWXnnLZ.js";const W={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Y(u,d){return _(),m("svg",W,d[0]||(d[0]=[o("path",{fill:"currentColor",d:"M18.925 16.075L17.5 14.65l2-2.65L15 6H8.85l-2-2H15q.475 0 .9.213t.7.587l4.5 6q.4.525.4 1.2t-.4 1.2zM4 18h11.2L4 6.8zm0 2q-.825 0-1.412-.587T2 18V6q0-.275.063-.513t.187-.437L1.4 4.2q-.275-.275-.275-.7t.275-.7t.7-.275t.7.275l18.4 18.4q.275.275.288.688t-.288.712q-.275.275-.7.275t-.7-.275l-3.275-3.275q-.25.325-.6.5T15.15 20zm10.175-9.675"},null,-1)]))}const ee=V({name:"material-symbols-label-off-outline-rounded",render:Y}),te={slot:"headline"},ae={slot:"content"},oe=["label","selected"],se=["label","selected"],ne=["label","selected","onClick"],le={slot:"actions"},de=["disabled"],ie={key:0,slot:"icon",indeterminate:""},re=B({__name:"AddToTagsModal",props:{type:{type:String,required:!0},tags:{type:Array,default:()=>[]},query:{type:String,required:!0}},setup(u){const{handleSubmit:d}=N(),n=$("add_to_tags"),a=u;function c(e){const{button:i}=e.detail,p=i.dataset.value;n.value=p}const{value:s,errorMessage:l}=Q("selectedTags",z().test("required","valid.required",e=>e.length),{initialValue:[]}),{mutate:g,loading:y,onDone:C}=q({document:I}),{mutate:w,loading:b,onDone:A}=q({document:j}),h=()=>{S.emit("items_tags_updated",{type:a.type}),S.emit("refetch_tags",a.type),f()};A(h),C(h);function D(e){s.value.includes(e)?Z(s.value,i=>i.id===e.id):s.value.push(e)}const T=d(()=>{n.value==="add_to_tags"?w({type:a.type,tagIds:s.value.map(e=>e.id),query:a.query}):g({type:a.type,tagIds:s.value.map(e=>e.id),query:a.query})});return(e,i)=>{const p=R,F=ee;return _(),m("md-dialog",null,[o("div",te,v(e.$t("tags")),1),o("div",ae,[o("md-outlined-segmented-button-set",{onSegmentedButtonSetSelection:c},[o("md-outlined-segmented-button",{"data-value":"add_to_tags",label:e.$t("add_to_tags"),selected:n.value==="add_to_tags"},[k(p,{slot:"icon"})],8,oe),o("md-outlined-segmented-button",{"data-value":"remove_from_tags",label:e.$t("remove_from_tags"),selected:n.value==="remove_from_tags"},[k(F,{slot:"icon"})],8,se)],32),o("md-chip-set",null,[(_(!0),m(H,null,E(u.tags,r=>(_(),m("md-filter-chip",{key:r.id,label:r.name,selected:t(s).includes(r),onClick:ce=>D(r)},null,8,ne))),128))]),G(o("div",{class:"invalid-feedback"},v(t(l)?e.$t(t(l)):""),513),[[J,t(l)]])]),o("div",le,[o("md-outlined-button",{value:"cancel",onClick:i[0]||(i[0]=(...r)=>t(f)&&t(f)(...r))},v(e.$t("cancel")),1),o("md-filled-button",{value:"save",disabled:t(b)||t(y),autofocus:"",onClick:i[1]||(i[1]=(...r)=>t(T)&&t(T)(...r))},[t(b)||t(y)?(_(),m("md-circular-progress",ie)):K("",!0),X(" "+v(e.$t("save")),1)],8,de)])])}}}),ue=x(re,[["__scopeId","data-v-e3ee6e76"]]),_e=(u,d)=>{const{t:n}=L();return{addToTags:(a,c,s)=>{let l=s;if(!c){if(a.length===0){M(n("select_first"),"error");return}l=`ids:${a.join(",")}`}U(ue,{type:u,tags:d.value,query:l})}}},ge=(u,d=()=>{})=>{const n=$([]),{t:a}=L(),{loading:c,fetch:s}=O({handle:async(l,g)=>{g?M(a(g),"error"):l&&(n.value=l.tags,d())},document:P,variables:{type:u}});return{tags:n,loading:c,fetch:s}};export{_e as a,ge as u};
